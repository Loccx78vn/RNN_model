<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>RNN and LSTM model – Time series model 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-3a01e2046221230fdceeea94b1ec5d67.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-a4a11d514c7d463668e07712114998e6.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-fe64a206d7279f15d3f0f0dd3f7ef5b3.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>

<script src="site_libs/proj4js-2.3.15/proj4.js"></script>

<link href="site_libs/highcharts-9.3.1/css/motion.css" rel="stylesheet">

<script src="site_libs/highcharts-9.3.1/highcharts.js"></script>

<script src="site_libs/highcharts-9.3.1/highcharts-3d.js"></script>

<script src="site_libs/highcharts-9.3.1/highcharts-more.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/stock.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/map.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/data.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/exporting.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/offline-exporting.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/drilldown.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/item-series.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/overlapping-datalabels.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/annotations.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/export-data.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/funnel.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/heatmap.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/treemap.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/sankey.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/dependency-wheel.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/organization.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/solid-gauge.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/streamgraph.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/sunburst.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/vector.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/wordcloud.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/xrange.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/tilemap.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/venn.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/gantt.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/timeline.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/parallel-coordinates.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/bullet.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/coloraxis.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/dumbbell.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/lollipop.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/series-label.js"></script>

<script src="site_libs/highcharts-9.3.1/plugins/motion.js"></script>

<script src="site_libs/highcharts-9.3.1/custom/reset.js"></script>

<script src="site_libs/highcharts-9.3.1/modules/boost.js"></script>

<script src="site_libs/highchart-binding-0.9.4/highchart.js"></script>

<link href="site_libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">

<script src="site_libs/dygraphs-1.1.1/dygraph-combined.js"></script>

<script src="site_libs/dygraphs-1.1.1/shapes.js"></script>

<script src="site_libs/moment-2.8.4/moment.js"></script>

<script src="site_libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>

<script src="site_libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>

<script src="site_libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Time series model 2</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./torch.html" aria-current="page"> 
<span class="menu-text">RNN and LSTM model</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#mô-hình-rnn" id="toc-mô-hình-rnn" class="nav-link active" data-scroll-target="#mô-hình-rnn"><span class="header-section-number">1</span> Mô hình RNN:</a>
  <ul class="collapse">
  <li><a href="#định-nghĩa" id="toc-định-nghĩa" class="nav-link" data-scroll-target="#định-nghĩa"><span class="header-section-number">1.1</span> Định nghĩa:</a></li>
  <li><a href="#nguyên-lí-hoạt-động" id="toc-nguyên-lí-hoạt-động" class="nav-link" data-scroll-target="#nguyên-lí-hoạt-động"><span class="header-section-number">1.2</span> Nguyên lí hoạt động:</a></li>
  <li><a href="#vấn-đề-lớn-của-rnn" id="toc-vấn-đề-lớn-của-rnn" class="nav-link" data-scroll-target="#vấn-đề-lớn-của-rnn"><span class="header-section-number">1.3</span> Vấn đề lớn của RNN:</a></li>
  <li><a href="#mô-hình-lstm" id="toc-mô-hình-lstm" class="nav-link" data-scroll-target="#mô-hình-lstm"><span class="header-section-number">1.4</span> Mô hình LSTM:</a></li>
  </ul></li>
  <li><a href="#xây-dựng-mô-hình" id="toc-xây-dựng-mô-hình" class="nav-link" data-scroll-target="#xây-dựng-mô-hình"><span class="header-section-number">2</span> Xây dựng mô hình:</a>
  <ul class="collapse">
  <li><a href="#load-dữ-liệu" id="toc-load-dữ-liệu" class="nav-link" data-scroll-target="#load-dữ-liệu"><span class="header-section-number">2.1</span> Load dữ liệu:</a></li>
  <li><a href="#chia-dữ-liệu" id="toc-chia-dữ-liệu" class="nav-link" data-scroll-target="#chia-dữ-liệu"><span class="header-section-number">2.2</span> Chia dữ liệu:</a></li>
  <li><a href="#mô-hình-rnn-1" id="toc-mô-hình-rnn-1" class="nav-link" data-scroll-target="#mô-hình-rnn-1"><span class="header-section-number">2.3</span> Mô hình RNN:</a></li>
  <li><a href="#mô-hình-lstm-1" id="toc-mô-hình-lstm-1" class="nav-link" data-scroll-target="#mô-hình-lstm-1"><span class="header-section-number">2.4</span> Mô hình LSTM:</a></li>
  <li><a href="#xác-định-cấu-trúc-mô-hình" id="toc-xác-định-cấu-trúc-mô-hình" class="nav-link" data-scroll-target="#xác-định-cấu-trúc-mô-hình"><span class="header-section-number">2.5</span> Xác định cấu trúc mô hình:</a></li>
  </ul></li>
  <li><a href="#kết-luận" id="toc-kết-luận" class="nav-link" data-scroll-target="#kết-luận"><span class="header-section-number">3</span> Kết luận:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">RNN and LSTM model</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Việt Nam, 2024</p>
  <div class="quarto-categories">
    <div class="quarto-category">Machine Learning</div>
    <div class="quarto-category">Forecasting</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Ở đây ta sẽ học về mô hình machine learning được ứng dụng nhiều nhất trong việc phân tích dữ liệu thời gian là <em>RNN</em> và <em>LSTM</em>.</p>
<section id="mô-hình-rnn" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="mô-hình-rnn"><span class="header-section-number">1</span> Mô hình RNN:</h2>
<section id="định-nghĩa" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="định-nghĩa"><span class="header-section-number">1.1</span> Định nghĩa:</h3>
<p>Điểm chung là cả hai mô hình đều thuộc phân lớp <em>Deep learning</em> - nghĩa là học máy sâu với đặc điểm chung là phân chia dữ liệu thành nhiều lớp và bắt đầu “học” dần qua từng lớp để đưa ra kết quả cuối cùng. Ở hình dưới đây, <span class="math inline">\(X_o\)</span> đại diện cho dữ liệu đầu vào, <span class="math inline">\(h_t\)</span> là output đầu ra của từng step và <span class="math inline">\(A\)</span> là những gì đã “học” được tại step đó và được truyền cho step tiếp theo. Trong tài liệu chuẩn thì họ thường kí hiệu là <span class="math inline">\(X_t\)</span>, <span class="math inline">\(Y_t\)</span>, <span class="math inline">\(h_{t-1}\)</span>.</p>
<div style="text-align: center; margin-bottom: 20px;">
  <img src="img/RNN.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;">
  
  <!-- Picture Name -->
  <div style="text-align: left; margin-top: 10px;">
    Hình 1: Minh họa về sự phân chia dữ liệu thành nhiều lớp
  </div>
  
  <!-- Source Link -->
  <div style="text-align: right; font-style: italic; margin-top: 5px;">
    Source: <a href="https://dominhhai.github.io/vi/2017/10/what-is-lstm/" target="_blank">Link to Image</a>
  </div>
</div>
<p>Khi nhìn hình thì bạn có thể bối rối chưa hiểu các kí tự và hình ảnh thì bạn có thể tưởng tượng <strong>học máy</strong> như 1 đứa trẻ và để nó có thể hiểu được câu: “Hôm nay con đi học” thì nó phải học từng chữ cái như: a,b,c,… trước ròi mới ghép thành từ đơn như: “Hôm”,“Nay”,… rồi ghép thành câu trên.</p>
<p>Vậy giả sử như hôm nay học được từ “Hôm” thì nó sẽ bắt đầu ghi nhớ từ đã học vào trong <span class="math inline">\(A\)</span>. Nếu sau này ta cần <strong>học máy</strong> hiểu câu “Hôm sau con đi chơi” thì tốc độ học của <strong>học máy</strong> sẽ nhanh lên vì thay vì nó phải học 5 chữ đơn như thông thường thì nó chỉ cần học 4 chữ còn lại trừ chữ “hôm”. Vậy bạn đã hiểu ý tưởng nền tảng của <em>RNN</em> rồi ha!</p>
</section>
<section id="nguyên-lí-hoạt-động" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="nguyên-lí-hoạt-động"><span class="header-section-number">1.2</span> Nguyên lí hoạt động:</h3>
<p>Đầu tiên, <em>RNN</em> sẽ tính toán <em>hidden state</em> là <span class="math inline">\(h_t\)</span> với công thức là:</p>
<p><span class="math display">\[
   \mathbf{h}_t = \text{activation}(\mathbf{W}_\text{hh} \mathbf{h}_{t-1} + \mathbf{W}_\text{xh} \mathbf{x}_t + \mathbf{b}_\text{h})
\]</span></p>
<p>Sau đó, <span class="math inline">\(h_t\)</span> sẽ được làm input cho các <em>state</em> sau và dựa vào đó để tính output với công thức là:</p>
<p><span class="math display">\[
y_t = W_y \cdot h_t + b_y
\]</span></p>
<p><strong>Ví dụ:</strong> Mình muốn dự đoán hành động trong câu nói “I am reading book” bằng mô hình <em>RNN</em> như sau:</p>
<ul>
<li><em>Bước 1</em>: Chuyển đổi thành dạng số bằng <em>embedding layer</em>:</li>
</ul>
<p>Mình sẽ gán từng từ đơn sang dạng số như:</p>
<ul>
<li><p>“I” -&gt; <span class="math inline">\(x_1\)</span></p></li>
<li><p>“am” -&gt; <span class="math inline">\(x_2\)</span></p></li>
<li><p>“reading” -&gt; <span class="math inline">\(x_3\)</span></p></li>
<li><p>“book” -&gt; <span class="math inline">\(x_4\)</span></p></li>
<li><p><em>Bước 2:</em> Thêm hidden layer và bắt đầu tính toán:</p></li>
</ul>
<p>Cho input: “I”</p>
<p><span class="math display">\[
   h_1 = \tanh(W_x \cdot x_1 + W_h \cdot h_0 + b)
\]</span></p>
<p>Cho input: “am”</p>
<p><span class="math display">\[
   h_2 = \tanh(W_x \cdot x_2 + W_h \cdot h_1 + b)
\]</span></p>
<p>Cho input: “reading”</p>
<p><span class="math display">\[
   h_3 = \tanh(W_x \cdot x_3 + W_h \cdot h_2 + b)
\]</span></p>
<p>Cho input: “book”</p>
<p><span class="math display">\[
   h_4 = \tanh(W_x \cdot x_4 + W_h \cdot h_3 + b)
\]</span></p>
<ul>
<li><em>Bước 3:</em> Tính toán output: Dùng hàm activation <strong>softmax</strong> để phân lớp theo xác suất.</li>
</ul>
<p><span class="math display">\[
\hat{y} = \text{softmax}(W_y \cdot h_4 + b_y)
\]</span></p>
<p>Nếu muốn hiểu thêm về cách hoạt động <em>RNN</em>, bạn có thể tham khảo link này: <a href="https://viblo.asia/p/recurrent-neural-network-tu-rnn-den-lstm-gGJ597z1ZX2">Recurrent Neural Network: Từ RNN đến LSTM</a>.</p>
</section>
<section id="vấn-đề-lớn-của-rnn" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="vấn-đề-lớn-của-rnn"><span class="header-section-number">1.3</span> Vấn đề lớn của RNN:</h3>
<p><em>RNN</em> có 1 vấn đề lớn là <em>Vanishing Gradient</em> nghĩa là mô hình sẽ không còn “học” thêm được nữa cho dù tăng số <code>epochs</code>. Nguyên nhân vì sao như vậy thì bạn có thể tham khảo phần chứng minh của <a href="https://nttuan8.com/bai-14-long-short-term-memory-lstm/">anh Tuấn</a>.</p>
<div style="text-align: center; margin-bottom: 20px;">
  <img src="img/vanishing.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;">
  
  <!-- Picture Name -->
  <div style="text-align: left; margin-top: 10px;">
    Hình 2: Vanishing Gradient Problem
  </div>
  
  <!-- Source Link -->
  <div style="text-align: right; font-style: italic; margin-top: 5px;">
    Source: <a href="https://www.superdatascience.com/blogs/recurrent-neural-networks-rnn-the-vanishing-gradient-problem" target="_blank">Link to Image</a>
  </div>
</div>
<p>Vấn đề này sẽ làm network khó update <em>weight</em> dẫn tới thời gian học lâu và khó để đạt được output. Bạn có thể hiểu đơn giản như việc bạn học liên tục dẫn tới quá tải và <em>RNN</em> cũng không như vậy. Do đó, <em>RNN</em> chỉ học các thông tin từ <em>state</em> gần và đó là lí do ra đời <em>LSTM - Long short term memory.</em></p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><u>Lưu ý</u>: Điều này không có nghĩa <em>LSTM</em> luôn tốt hơn <em>RNN</em> vì có những bài toán với đầu vào đơn giản thì mô hình chỉ cần học các step đầu là đã “học” đầy đủ thông tin cần thiết. Mô hình <em>LSTM</em> phổ biến với các bài toán phức tạp như tự động dịch ngôn ngữ, ghi chép lại theo giọng nói…</p>
</div>
</div>
</section>
<section id="mô-hình-lstm" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="mô-hình-lstm"><span class="header-section-number">1.4</span> Mô hình LSTM:</h3>
<p>Có thể xem mô hình <em>LSTM</em> như biến thể của <em>RNN</em>. Về cấu trúc, <em>LSTM</em> phức tạp hơn <em>RNN</em>:</p>
<div style="text-align: center; margin-bottom: 20px;">
  <img src="img/compare.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;">
  
  <!-- Picture Name -->
  <div style="text-align: left; margin-top: 10px;">
    Hình 3: So sánh mô hình RNN và LSTM
  </div>
  
  <!-- Source Link -->
  <div style="text-align: right; font-style: italic; margin-top: 5px;">
    Source: <a href="https://dominhhai.github.io/vi/2017/10/what-is-lstm/" target="_blank">Link to Image</a>
  </div>
</div>
<p>Cấu trúc cơ bản gồm:</p>
<ul>
<li><p>Cổng quên (Forget Gate): có tác dụng quyết định thông tin nào cần bị quên trong trạng thái ô nhớ.</p></li>
<li><p>Cổng nhập (Input Gate): Xác định thông tin nào cần được ghi vào trạng thái ô nhớ.</p></li>
<li><p>Cổng xuất (Output Gate): Quyết định thông tin nào sẽ được xuất ra từ trạng thái ô nhớ để ảnh hưởng đến dự đoán tiếp theo.</p></li>
</ul>
<p>Bạn có thể kham khảo thêm bài viết của <a href="https://dominhhai.github.io/vi/2017/10/what-is-lstm/">dominhhai</a> về cách hoạt động của <em>RNN</em> và <em>LSTM</em> để hiểu thêm.</p>
<p>Tiếp theo, ta sẽ bắt đầu xây dựng thử mô hình trong R.</p>
</section>
</section>
<section id="xây-dựng-mô-hình" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="xây-dựng-mô-hình"><span class="header-section-number">2</span> Xây dựng mô hình:</h2>
<section id="load-dữ-liệu" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="load-dữ-liệu"><span class="header-section-number">2.1</span> Load dữ liệu:</h3>
<p>Đầu tiên ta sẽ load dữ liệu lại như trước. Ở đây, để đơn giản, mình chỉ xây dựng mô hình cho <em>product A</em> thôi.</p>
<p>Giả sử công ty mình đang kinh doanh 3 loại mặt hàng <em>product A</em>,<em>product B</em>,<em>product C</em> và đây là biểu đồ thể hiện nhu cầu của cả 3 mặt hàng từ tháng 5 tới tháng 10.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(highcharter)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>sales_data <span class="sc">|&gt;</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Weekday) <span class="sc">|&gt;</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Product_A, Product_B, Product_C),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Product"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Sales"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hchart</span>(<span class="st">"line"</span>, <span class="fu">hcaes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Sales, <span class="at">group =</span> Product))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item" id="htmlwidget-8d885b9e97c5eb95f00a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8d885b9e97c5eb95f00a">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":null},"yAxis":{"title":{"text":"Sales"},"type":"linear"},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":true},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"name":"Product_A","data":[{"Date":"2024-05-01","Product":"Product_A","Sales":61,"x":1714521600000,"y":61},{"Date":"2024-05-02","Product":"Product_A","Sales":5,"x":1714608000000,"y":5},{"Date":"2024-05-03","Product":"Product_A","Sales":29,"x":1714694400000,"y":29},{"Date":"2024-05-04","Product":"Product_A","Sales":41,"x":1714780800000,"y":41},{"Date":"2024-05-05","Product":"Product_A","Sales":40,"x":1714867200000,"y":40},{"Date":"2024-05-06","Product":"Product_A","Sales":22,"x":1714953600000,"y":22},{"Date":"2024-05-07","Product":"Product_A","Sales":28,"x":1715040000000,"y":28},{"Date":"2024-05-08","Product":"Product_A","Sales":46,"x":1715126400000,"y":46},{"Date":"2024-05-09","Product":"Product_A","Sales":40,"x":1715212800000,"y":40},{"Date":"2024-05-10","Product":"Product_A","Sales":29,"x":1715299200000,"y":29},{"Date":"2024-05-11","Product":"Product_A","Sales":50,"x":1715385600000,"y":50},{"Date":"2024-05-12","Product":"Product_A","Sales":50,"x":1715472000000,"y":50},{"Date":"2024-05-13","Product":"Product_A","Sales":24,"x":1715558400000,"y":24},{"Date":"2024-05-14","Product":"Product_A","Sales":30,"x":1715644800000,"y":30},{"Date":"2024-05-15","Product":"Product_A","Sales":54,"x":1715731200000,"y":54},{"Date":"2024-05-16","Product":"Product_A","Sales":45,"x":1715817600000,"y":45},{"Date":"2024-05-17","Product":"Product_A","Sales":29,"x":1715904000000,"y":29},{"Date":"2024-05-18","Product":"Product_A","Sales":53,"x":1715990400000,"y":53},{"Date":"2024-05-19","Product":"Product_A","Sales":40,"x":1716076800000,"y":40},{"Date":"2024-05-20","Product":"Product_A","Sales":41,"x":1716163200000,"y":41},{"Date":"2024-05-21","Product":"Product_A","Sales":35,"x":1716249600000,"y":35},{"Date":"2024-05-22","Product":"Product_A","Sales":66,"x":1716336000000,"y":66},{"Date":"2024-05-23","Product":"Product_A","Sales":9,"x":1716422400000,"y":9},{"Date":"2024-05-24","Product":"Product_A","Sales":24,"x":1716508800000,"y":24},{"Date":"2024-05-25","Product":"Product_A","Sales":56,"x":1716595200000,"y":56},{"Date":"2024-05-26","Product":"Product_A","Sales":32,"x":1716681600000,"y":32},{"Date":"2024-05-27","Product":"Product_A","Sales":44,"x":1716768000000,"y":44},{"Date":"2024-05-28","Product":"Product_A","Sales":7,"x":1716854400000,"y":7},{"Date":"2024-05-29","Product":"Product_A","Sales":41,"x":1716940800000,"y":41},{"Date":"2024-05-30","Product":"Product_A","Sales":46,"x":1717027200000,"y":46},{"Date":"2024-05-31","Product":"Product_A","Sales":28,"x":1717113600000,"y":28},{"Date":"2024-06-01","Product":"Product_A","Sales":69,"x":1717200000000,"y":69},{"Date":"2024-06-02","Product":"Product_A","Sales":47,"x":1717286400000,"y":47},{"Date":"2024-06-03","Product":"Product_A","Sales":19,"x":1717372800000,"y":19},{"Date":"2024-06-04","Product":"Product_A","Sales":26,"x":1717459200000,"y":26},{"Date":"2024-06-05","Product":"Product_A","Sales":59,"x":1717545600000,"y":59},{"Date":"2024-06-06","Product":"Product_A","Sales":40,"x":1717632000000,"y":40},{"Date":"2024-06-07","Product":"Product_A","Sales":8,"x":1717718400000,"y":8},{"Date":"2024-06-08","Product":"Product_A","Sales":62,"x":1717804800000,"y":62},{"Date":"2024-06-09","Product":"Product_A","Sales":22,"x":1717891200000,"y":22},{"Date":"2024-06-10","Product":"Product_A","Sales":49,"x":1717977600000,"y":49},{"Date":"2024-06-11","Product":"Product_A","Sales":32,"x":1718064000000,"y":32},{"Date":"2024-06-12","Product":"Product_A","Sales":60,"x":1718150400000,"y":60},{"Date":"2024-06-13","Product":"Product_A","Sales":8,"x":1718236800000,"y":8},{"Date":"2024-06-14","Product":"Product_A","Sales":38,"x":1718323200000,"y":38},{"Date":"2024-06-15","Product":"Product_A","Sales":57,"x":1718409600000,"y":57},{"Date":"2024-06-16","Product":"Product_A","Sales":28,"x":1718496000000,"y":28},{"Date":"2024-06-17","Product":"Product_A","Sales":27,"x":1718582400000,"y":27},{"Date":"2024-06-18","Product":"Product_A","Sales":30,"x":1718668800000,"y":30},{"Date":"2024-06-19","Product":"Product_A","Sales":49,"x":1718755200000,"y":49},{"Date":"2024-06-20","Product":"Product_A","Sales":10,"x":1718841600000,"y":10},{"Date":"2024-06-21","Product":"Product_A","Sales":6,"x":1718928000000,"y":6},{"Date":"2024-06-22","Product":"Product_A","Sales":42,"x":1719014400000,"y":42},{"Date":"2024-06-23","Product":"Product_A","Sales":25,"x":1719100800000,"y":25},{"Date":"2024-06-24","Product":"Product_A","Sales":6,"x":1719187200000,"y":6},{"Date":"2024-06-25","Product":"Product_A","Sales":42,"x":1719273600000,"y":42},{"Date":"2024-06-26","Product":"Product_A","Sales":57,"x":1719360000000,"y":57},{"Date":"2024-06-27","Product":"Product_A","Sales":44,"x":1719446400000,"y":44},{"Date":"2024-06-28","Product":"Product_A","Sales":9,"x":1719532800000,"y":9},{"Date":"2024-06-29","Product":"Product_A","Sales":40,"x":1719619200000,"y":40},{"Date":"2024-06-30","Product":"Product_A","Sales":43,"x":1719705600000,"y":43},{"Date":"2024-07-01","Product":"Product_A","Sales":40,"x":1719792000000,"y":40},{"Date":"2024-07-02","Product":"Product_A","Sales":49,"x":1719878400000,"y":49},{"Date":"2024-07-03","Product":"Product_A","Sales":69,"x":1719964800000,"y":69},{"Date":"2024-07-04","Product":"Product_A","Sales":13,"x":1720051200000,"y":13},{"Date":"2024-07-05","Product":"Product_A","Sales":33,"x":1720137600000,"y":33},{"Date":"2024-07-06","Product":"Product_A","Sales":58,"x":1720224000000,"y":58},{"Date":"2024-07-07","Product":"Product_A","Sales":24,"x":1720310400000,"y":24},{"Date":"2024-07-08","Product":"Product_A","Sales":13,"x":1720396800000,"y":13},{"Date":"2024-07-09","Product":"Product_A","Sales":47,"x":1720483200000,"y":47},{"Date":"2024-07-10","Product":"Product_A","Sales":70,"x":1720569600000,"y":70},{"Date":"2024-07-11","Product":"Product_A","Sales":33,"x":1720656000000,"y":33},{"Date":"2024-07-12","Product":"Product_A","Sales":20,"x":1720742400000,"y":20},{"Date":"2024-07-13","Product":"Product_A","Sales":68,"x":1720828800000,"y":68},{"Date":"2024-07-14","Product":"Product_A","Sales":32,"x":1720915200000,"y":32},{"Date":"2024-07-15","Product":"Product_A","Sales":50,"x":1721001600000,"y":50},{"Date":"2024-07-16","Product":"Product_A","Sales":9,"x":1721088000000,"y":9},{"Date":"2024-07-17","Product":"Product_A","Sales":57,"x":1721174400000,"y":57},{"Date":"2024-07-18","Product":"Product_A","Sales":6,"x":1721260800000,"y":6},{"Date":"2024-07-19","Product":"Product_A","Sales":22,"x":1721347200000,"y":22},{"Date":"2024-07-20","Product":"Product_A","Sales":63,"x":1721433600000,"y":63},{"Date":"2024-07-21","Product":"Product_A","Sales":22,"x":1721520000000,"y":22},{"Date":"2024-07-22","Product":"Product_A","Sales":9,"x":1721606400000,"y":9},{"Date":"2024-07-23","Product":"Product_A","Sales":50,"x":1721692800000,"y":50},{"Date":"2024-07-24","Product":"Product_A","Sales":62,"x":1721779200000,"y":62},{"Date":"2024-07-25","Product":"Product_A","Sales":44,"x":1721865600000,"y":44},{"Date":"2024-07-26","Product":"Product_A","Sales":25,"x":1721952000000,"y":25},{"Date":"2024-07-27","Product":"Product_A","Sales":51,"x":1722038400000,"y":51},{"Date":"2024-07-28","Product":"Product_A","Sales":40,"x":1722124800000,"y":40},{"Date":"2024-07-29","Product":"Product_A","Sales":43,"x":1722211200000,"y":43},{"Date":"2024-07-30","Product":"Product_A","Sales":46,"x":1722297600000,"y":46},{"Date":"2024-07-31","Product":"Product_A","Sales":46,"x":1722384000000,"y":46},{"Date":"2024-08-01","Product":"Product_A","Sales":31,"x":1722470400000,"y":31},{"Date":"2024-08-02","Product":"Product_A","Sales":17,"x":1722556800000,"y":17},{"Date":"2024-08-03","Product":"Product_A","Sales":70,"x":1722643200000,"y":70},{"Date":"2024-08-04","Product":"Product_A","Sales":36,"x":1722729600000,"y":36},{"Date":"2024-08-05","Product":"Product_A","Sales":20,"x":1722816000000,"y":20},{"Date":"2024-08-06","Product":"Product_A","Sales":33,"x":1722902400000,"y":33},{"Date":"2024-08-07","Product":"Product_A","Sales":50,"x":1722988800000,"y":50},{"Date":"2024-08-08","Product":"Product_A","Sales":48,"x":1723075200000,"y":48},{"Date":"2024-08-09","Product":"Product_A","Sales":13,"x":1723161600000,"y":13},{"Date":"2024-08-10","Product":"Product_A","Sales":70,"x":1723248000000,"y":70},{"Date":"2024-08-11","Product":"Product_A","Sales":47,"x":1723334400000,"y":47},{"Date":"2024-08-12","Product":"Product_A","Sales":12,"x":1723420800000,"y":12},{"Date":"2024-08-13","Product":"Product_A","Sales":33,"x":1723507200000,"y":33},{"Date":"2024-08-14","Product":"Product_A","Sales":59,"x":1723593600000,"y":59},{"Date":"2024-08-15","Product":"Product_A","Sales":5,"x":1723680000000,"y":5},{"Date":"2024-08-16","Product":"Product_A","Sales":17,"x":1723766400000,"y":17},{"Date":"2024-08-17","Product":"Product_A","Sales":56,"x":1723852800000,"y":56},{"Date":"2024-08-18","Product":"Product_A","Sales":9,"x":1723939200000,"y":9},{"Date":"2024-08-19","Product":"Product_A","Sales":13,"x":1724025600000,"y":13},{"Date":"2024-08-20","Product":"Product_A","Sales":20,"x":1724112000000,"y":20},{"Date":"2024-08-21","Product":"Product_A","Sales":40,"x":1724198400000,"y":40},{"Date":"2024-08-22","Product":"Product_A","Sales":47,"x":1724284800000,"y":47},{"Date":"2024-08-23","Product":"Product_A","Sales":46,"x":1724371200000,"y":46},{"Date":"2024-08-24","Product":"Product_A","Sales":56,"x":1724457600000,"y":56},{"Date":"2024-08-25","Product":"Product_A","Sales":37,"x":1724544000000,"y":37},{"Date":"2024-08-26","Product":"Product_A","Sales":33,"x":1724630400000,"y":33},{"Date":"2024-08-27","Product":"Product_A","Sales":29,"x":1724716800000,"y":29},{"Date":"2024-08-28","Product":"Product_A","Sales":47,"x":1724803200000,"y":47},{"Date":"2024-08-29","Product":"Product_A","Sales":21,"x":1724889600000,"y":21},{"Date":"2024-08-30","Product":"Product_A","Sales":50,"x":1724976000000,"y":50},{"Date":"2024-08-31","Product":"Product_A","Sales":65,"x":1725062400000,"y":65},{"Date":"2024-09-01","Product":"Product_A","Sales":10,"x":1725148800000,"y":10},{"Date":"2024-09-02","Product":"Product_A","Sales":47,"x":1725235200000,"y":47},{"Date":"2024-09-03","Product":"Product_A","Sales":41,"x":1725321600000,"y":41},{"Date":"2024-09-04","Product":"Product_A","Sales":48,"x":1725408000000,"y":48},{"Date":"2024-09-05","Product":"Product_A","Sales":35,"x":1725494400000,"y":35},{"Date":"2024-09-06","Product":"Product_A","Sales":38,"x":1725580800000,"y":38},{"Date":"2024-09-07","Product":"Product_A","Sales":67,"x":1725667200000,"y":67},{"Date":"2024-09-08","Product":"Product_A","Sales":36,"x":1725753600000,"y":36},{"Date":"2024-09-09","Product":"Product_A","Sales":10,"x":1725840000000,"y":10},{"Date":"2024-09-10","Product":"Product_A","Sales":26,"x":1725926400000,"y":26},{"Date":"2024-09-11","Product":"Product_A","Sales":40,"x":1726012800000,"y":40},{"Date":"2024-09-12","Product":"Product_A","Sales":35,"x":1726099200000,"y":35},{"Date":"2024-09-13","Product":"Product_A","Sales":10,"x":1726185600000,"y":10},{"Date":"2024-09-14","Product":"Product_A","Sales":70,"x":1726272000000,"y":70},{"Date":"2024-09-15","Product":"Product_A","Sales":19,"x":1726358400000,"y":19},{"Date":"2024-09-16","Product":"Product_A","Sales":38,"x":1726444800000,"y":38},{"Date":"2024-09-17","Product":"Product_A","Sales":46,"x":1726531200000,"y":46},{"Date":"2024-09-18","Product":"Product_A","Sales":70,"x":1726617600000,"y":70},{"Date":"2024-09-19","Product":"Product_A","Sales":16,"x":1726704000000,"y":16},{"Date":"2024-09-20","Product":"Product_A","Sales":30,"x":1726790400000,"y":30},{"Date":"2024-09-21","Product":"Product_A","Sales":69,"x":1726876800000,"y":69},{"Date":"2024-09-22","Product":"Product_A","Sales":5,"x":1726963200000,"y":5},{"Date":"2024-09-23","Product":"Product_A","Sales":6,"x":1727049600000,"y":6},{"Date":"2024-09-24","Product":"Product_A","Sales":28,"x":1727136000000,"y":28},{"Date":"2024-09-25","Product":"Product_A","Sales":41,"x":1727222400000,"y":41},{"Date":"2024-09-26","Product":"Product_A","Sales":29,"x":1727308800000,"y":29},{"Date":"2024-09-27","Product":"Product_A","Sales":32,"x":1727395200000,"y":32},{"Date":"2024-09-28","Product":"Product_A","Sales":42,"x":1727481600000,"y":42},{"Date":"2024-09-29","Product":"Product_A","Sales":18,"x":1727568000000,"y":18},{"Date":"2024-09-30","Product":"Product_A","Sales":38,"x":1727654400000,"y":38},{"Date":"2024-10-01","Product":"Product_A","Sales":6,"x":1727740800000,"y":6},{"Date":"2024-10-02","Product":"Product_A","Sales":66,"x":1727827200000,"y":66},{"Date":"2024-10-03","Product":"Product_A","Sales":36,"x":1727913600000,"y":36},{"Date":"2024-10-04","Product":"Product_A","Sales":31,"x":1728000000000,"y":31},{"Date":"2024-10-05","Product":"Product_A","Sales":68,"x":1728086400000,"y":68},{"Date":"2024-10-06","Product":"Product_A","Sales":32,"x":1728172800000,"y":32},{"Date":"2024-10-07","Product":"Product_A","Sales":41,"x":1728259200000,"y":41},{"Date":"2024-10-08","Product":"Product_A","Sales":14,"x":1728345600000,"y":14},{"Date":"2024-10-09","Product":"Product_A","Sales":69,"x":1728432000000,"y":69},{"Date":"2024-10-10","Product":"Product_A","Sales":39,"x":1728518400000,"y":39},{"Date":"2024-10-11","Product":"Product_A","Sales":18,"x":1728604800000,"y":18},{"Date":"2024-10-12","Product":"Product_A","Sales":65,"x":1728691200000,"y":65},{"Date":"2024-10-13","Product":"Product_A","Sales":32,"x":1728777600000,"y":32},{"Date":"2024-10-14","Product":"Product_A","Sales":37,"x":1728864000000,"y":37},{"Date":"2024-10-15","Product":"Product_A","Sales":41,"x":1728950400000,"y":41},{"Date":"2024-10-16","Product":"Product_A","Sales":69,"x":1729036800000,"y":69},{"Date":"2024-10-17","Product":"Product_A","Sales":30,"x":1729123200000,"y":30},{"Date":"2024-10-18","Product":"Product_A","Sales":35,"x":1729209600000,"y":35},{"Date":"2024-10-19","Product":"Product_A","Sales":58,"x":1729296000000,"y":58},{"Date":"2024-10-20","Product":"Product_A","Sales":47,"x":1729382400000,"y":47},{"Date":"2024-10-21","Product":"Product_A","Sales":36,"x":1729468800000,"y":36},{"Date":"2024-10-22","Product":"Product_A","Sales":21,"x":1729555200000,"y":21},{"Date":"2024-10-23","Product":"Product_A","Sales":40,"x":1729641600000,"y":40},{"Date":"2024-10-24","Product":"Product_A","Sales":34,"x":1729728000000,"y":34},{"Date":"2024-10-25","Product":"Product_A","Sales":40,"x":1729814400000,"y":40},{"Date":"2024-10-26","Product":"Product_A","Sales":54,"x":1729900800000,"y":54},{"Date":"2024-10-27","Product":"Product_A","Sales":15,"x":1729987200000,"y":15},{"Date":"2024-10-28","Product":"Product_A","Sales":21,"x":1730073600000,"y":21},{"Date":"2024-10-29","Product":"Product_A","Sales":13,"x":1730160000000,"y":13},{"Date":"2024-10-30","Product":"Product_A","Sales":50,"x":1730246400000,"y":50},{"Date":"2024-10-31","Product":"Product_A","Sales":17,"x":1730332800000,"y":17}],"type":"line"},{"name":"Product_B","data":[{"Date":"2024-05-01","Product":"Product_B","Sales":39,"x":1714521600000,"y":39},{"Date":"2024-05-02","Product":"Product_B","Sales":3,"x":1714608000000,"y":3},{"Date":"2024-05-03","Product":"Product_B","Sales":19,"x":1714694400000,"y":19},{"Date":"2024-05-04","Product":"Product_B","Sales":37,"x":1714780800000,"y":37},{"Date":"2024-05-05","Product":"Product_B","Sales":30,"x":1714867200000,"y":30},{"Date":"2024-05-06","Product":"Product_B","Sales":4,"x":1714953600000,"y":4},{"Date":"2024-05-07","Product":"Product_B","Sales":33,"x":1715040000000,"y":33},{"Date":"2024-05-08","Product":"Product_B","Sales":40,"x":1715126400000,"y":40},{"Date":"2024-05-09","Product":"Product_B","Sales":18,"x":1715212800000,"y":18},{"Date":"2024-05-10","Product":"Product_B","Sales":5,"x":1715299200000,"y":5},{"Date":"2024-05-11","Product":"Product_B","Sales":42,"x":1715385600000,"y":42},{"Date":"2024-05-12","Product":"Product_B","Sales":15,"x":1715472000000,"y":15},{"Date":"2024-05-13","Product":"Product_B","Sales":14,"x":1715558400000,"y":14},{"Date":"2024-05-14","Product":"Product_B","Sales":3,"x":1715644800000,"y":3},{"Date":"2024-05-15","Product":"Product_B","Sales":34,"x":1715731200000,"y":34},{"Date":"2024-05-16","Product":"Product_B","Sales":33,"x":1715817600000,"y":33},{"Date":"2024-05-17","Product":"Product_B","Sales":39,"x":1715904000000,"y":39},{"Date":"2024-05-18","Product":"Product_B","Sales":34,"x":1715990400000,"y":34},{"Date":"2024-05-19","Product":"Product_B","Sales":18,"x":1716076800000,"y":18},{"Date":"2024-05-20","Product":"Product_B","Sales":12,"x":1716163200000,"y":12},{"Date":"2024-05-21","Product":"Product_B","Sales":9,"x":1716249600000,"y":9},{"Date":"2024-05-22","Product":"Product_B","Sales":51,"x":1716336000000,"y":51},{"Date":"2024-05-23","Product":"Product_B","Sales":27,"x":1716422400000,"y":27},{"Date":"2024-05-24","Product":"Product_B","Sales":5,"x":1716508800000,"y":5},{"Date":"2024-05-25","Product":"Product_B","Sales":47,"x":1716595200000,"y":47},{"Date":"2024-05-26","Product":"Product_B","Sales":30,"x":1716681600000,"y":30},{"Date":"2024-05-27","Product":"Product_B","Sales":17,"x":1716768000000,"y":17},{"Date":"2024-05-28","Product":"Product_B","Sales":31,"x":1716854400000,"y":31},{"Date":"2024-05-29","Product":"Product_B","Sales":41,"x":1716940800000,"y":41},{"Date":"2024-05-30","Product":"Product_B","Sales":27,"x":1717027200000,"y":27},{"Date":"2024-05-31","Product":"Product_B","Sales":18,"x":1717113600000,"y":18},{"Date":"2024-06-01","Product":"Product_B","Sales":32,"x":1717200000000,"y":32},{"Date":"2024-06-02","Product":"Product_B","Sales":35,"x":1717286400000,"y":35},{"Date":"2024-06-03","Product":"Product_B","Sales":40,"x":1717372800000,"y":40},{"Date":"2024-06-04","Product":"Product_B","Sales":24,"x":1717459200000,"y":24},{"Date":"2024-06-05","Product":"Product_B","Sales":57,"x":1717545600000,"y":57},{"Date":"2024-06-06","Product":"Product_B","Sales":22,"x":1717632000000,"y":22},{"Date":"2024-06-07","Product":"Product_B","Sales":39,"x":1717718400000,"y":39},{"Date":"2024-06-08","Product":"Product_B","Sales":43,"x":1717804800000,"y":43},{"Date":"2024-06-09","Product":"Product_B","Sales":23,"x":1717891200000,"y":23},{"Date":"2024-06-10","Product":"Product_B","Sales":36,"x":1717977600000,"y":36},{"Date":"2024-06-11","Product":"Product_B","Sales":27,"x":1718064000000,"y":27},{"Date":"2024-06-12","Product":"Product_B","Sales":53,"x":1718150400000,"y":53},{"Date":"2024-06-13","Product":"Product_B","Sales":3,"x":1718236800000,"y":3},{"Date":"2024-06-14","Product":"Product_B","Sales":16,"x":1718323200000,"y":16},{"Date":"2024-06-15","Product":"Product_B","Sales":53,"x":1718409600000,"y":53},{"Date":"2024-06-16","Product":"Product_B","Sales":30,"x":1718496000000,"y":30},{"Date":"2024-06-17","Product":"Product_B","Sales":20,"x":1718582400000,"y":20},{"Date":"2024-06-18","Product":"Product_B","Sales":36,"x":1718668800000,"y":36},{"Date":"2024-06-19","Product":"Product_B","Sales":41,"x":1718755200000,"y":41},{"Date":"2024-06-20","Product":"Product_B","Sales":22,"x":1718841600000,"y":22},{"Date":"2024-06-21","Product":"Product_B","Sales":17,"x":1718928000000,"y":17},{"Date":"2024-06-22","Product":"Product_B","Sales":55,"x":1719014400000,"y":55},{"Date":"2024-06-23","Product":"Product_B","Sales":29,"x":1719100800000,"y":29},{"Date":"2024-06-24","Product":"Product_B","Sales":32,"x":1719187200000,"y":32},{"Date":"2024-06-25","Product":"Product_B","Sales":7,"x":1719273600000,"y":7},{"Date":"2024-06-26","Product":"Product_B","Sales":44,"x":1719360000000,"y":44},{"Date":"2024-06-27","Product":"Product_B","Sales":22,"x":1719446400000,"y":22},{"Date":"2024-06-28","Product":"Product_B","Sales":13,"x":1719532800000,"y":13},{"Date":"2024-06-29","Product":"Product_B","Sales":37,"x":1719619200000,"y":37},{"Date":"2024-06-30","Product":"Product_B","Sales":40,"x":1719705600000,"y":40},{"Date":"2024-07-01","Product":"Product_B","Sales":11,"x":1719792000000,"y":11},{"Date":"2024-07-02","Product":"Product_B","Sales":25,"x":1719878400000,"y":25},{"Date":"2024-07-03","Product":"Product_B","Sales":49,"x":1719964800000,"y":49},{"Date":"2024-07-04","Product":"Product_B","Sales":13,"x":1720051200000,"y":13},{"Date":"2024-07-05","Product":"Product_B","Sales":21,"x":1720137600000,"y":21},{"Date":"2024-07-06","Product":"Product_B","Sales":31,"x":1720224000000,"y":31},{"Date":"2024-07-07","Product":"Product_B","Sales":23,"x":1720310400000,"y":23},{"Date":"2024-07-08","Product":"Product_B","Sales":38,"x":1720396800000,"y":38},{"Date":"2024-07-09","Product":"Product_B","Sales":24,"x":1720483200000,"y":24},{"Date":"2024-07-10","Product":"Product_B","Sales":48,"x":1720569600000,"y":48},{"Date":"2024-07-11","Product":"Product_B","Sales":32,"x":1720656000000,"y":32},{"Date":"2024-07-12","Product":"Product_B","Sales":23,"x":1720742400000,"y":23},{"Date":"2024-07-13","Product":"Product_B","Sales":55,"x":1720828800000,"y":55},{"Date":"2024-07-14","Product":"Product_B","Sales":8,"x":1720915200000,"y":8},{"Date":"2024-07-15","Product":"Product_B","Sales":12,"x":1721001600000,"y":12},{"Date":"2024-07-16","Product":"Product_B","Sales":26,"x":1721088000000,"y":26},{"Date":"2024-07-17","Product":"Product_B","Sales":37,"x":1721174400000,"y":37},{"Date":"2024-07-18","Product":"Product_B","Sales":16,"x":1721260800000,"y":16},{"Date":"2024-07-19","Product":"Product_B","Sales":14,"x":1721347200000,"y":14},{"Date":"2024-07-20","Product":"Product_B","Sales":39,"x":1721433600000,"y":39},{"Date":"2024-07-21","Product":"Product_B","Sales":27,"x":1721520000000,"y":27},{"Date":"2024-07-22","Product":"Product_B","Sales":39,"x":1721606400000,"y":39},{"Date":"2024-07-23","Product":"Product_B","Sales":4,"x":1721692800000,"y":4},{"Date":"2024-07-24","Product":"Product_B","Sales":46,"x":1721779200000,"y":46},{"Date":"2024-07-25","Product":"Product_B","Sales":36,"x":1721865600000,"y":36},{"Date":"2024-07-26","Product":"Product_B","Sales":29,"x":1721952000000,"y":29},{"Date":"2024-07-27","Product":"Product_B","Sales":52,"x":1722038400000,"y":52},{"Date":"2024-07-28","Product":"Product_B","Sales":29,"x":1722124800000,"y":29},{"Date":"2024-07-29","Product":"Product_B","Sales":18,"x":1722211200000,"y":18},{"Date":"2024-07-30","Product":"Product_B","Sales":38,"x":1722297600000,"y":38},{"Date":"2024-07-31","Product":"Product_B","Sales":38,"x":1722384000000,"y":38},{"Date":"2024-08-01","Product":"Product_B","Sales":40,"x":1722470400000,"y":40},{"Date":"2024-08-02","Product":"Product_B","Sales":23,"x":1722556800000,"y":23},{"Date":"2024-08-03","Product":"Product_B","Sales":59,"x":1722643200000,"y":59},{"Date":"2024-08-04","Product":"Product_B","Sales":13,"x":1722729600000,"y":13},{"Date":"2024-08-05","Product":"Product_B","Sales":35,"x":1722816000000,"y":35},{"Date":"2024-08-06","Product":"Product_B","Sales":16,"x":1722902400000,"y":16},{"Date":"2024-08-07","Product":"Product_B","Sales":40,"x":1722988800000,"y":40},{"Date":"2024-08-08","Product":"Product_B","Sales":35,"x":1723075200000,"y":35},{"Date":"2024-08-09","Product":"Product_B","Sales":31,"x":1723161600000,"y":31},{"Date":"2024-08-10","Product":"Product_B","Sales":41,"x":1723248000000,"y":41},{"Date":"2024-08-11","Product":"Product_B","Sales":34,"x":1723334400000,"y":34},{"Date":"2024-08-12","Product":"Product_B","Sales":40,"x":1723420800000,"y":40},{"Date":"2024-08-13","Product":"Product_B","Sales":24,"x":1723507200000,"y":24},{"Date":"2024-08-14","Product":"Product_B","Sales":36,"x":1723593600000,"y":36},{"Date":"2024-08-15","Product":"Product_B","Sales":7,"x":1723680000000,"y":7},{"Date":"2024-08-16","Product":"Product_B","Sales":33,"x":1723766400000,"y":33},{"Date":"2024-08-17","Product":"Product_B","Sales":33,"x":1723852800000,"y":33},{"Date":"2024-08-18","Product":"Product_B","Sales":20,"x":1723939200000,"y":20},{"Date":"2024-08-19","Product":"Product_B","Sales":15,"x":1724025600000,"y":15},{"Date":"2024-08-20","Product":"Product_B","Sales":32,"x":1724112000000,"y":32},{"Date":"2024-08-21","Product":"Product_B","Sales":57,"x":1724198400000,"y":57},{"Date":"2024-08-22","Product":"Product_B","Sales":30,"x":1724284800000,"y":30},{"Date":"2024-08-23","Product":"Product_B","Sales":5,"x":1724371200000,"y":5},{"Date":"2024-08-24","Product":"Product_B","Sales":33,"x":1724457600000,"y":33},{"Date":"2024-08-25","Product":"Product_B","Sales":31,"x":1724544000000,"y":31},{"Date":"2024-08-26","Product":"Product_B","Sales":22,"x":1724630400000,"y":22},{"Date":"2024-08-27","Product":"Product_B","Sales":11,"x":1724716800000,"y":11},{"Date":"2024-08-28","Product":"Product_B","Sales":32,"x":1724803200000,"y":32},{"Date":"2024-08-29","Product":"Product_B","Sales":9,"x":1724889600000,"y":9},{"Date":"2024-08-30","Product":"Product_B","Sales":30,"x":1724976000000,"y":30},{"Date":"2024-08-31","Product":"Product_B","Sales":42,"x":1725062400000,"y":42},{"Date":"2024-09-01","Product":"Product_B","Sales":27,"x":1725148800000,"y":27},{"Date":"2024-09-02","Product":"Product_B","Sales":12,"x":1725235200000,"y":12},{"Date":"2024-09-03","Product":"Product_B","Sales":11,"x":1725321600000,"y":11},{"Date":"2024-09-04","Product":"Product_B","Sales":40,"x":1725408000000,"y":40},{"Date":"2024-09-05","Product":"Product_B","Sales":17,"x":1725494400000,"y":17},{"Date":"2024-09-06","Product":"Product_B","Sales":5,"x":1725580800000,"y":5},{"Date":"2024-09-07","Product":"Product_B","Sales":39,"x":1725667200000,"y":39},{"Date":"2024-09-08","Product":"Product_B","Sales":22,"x":1725753600000,"y":22},{"Date":"2024-09-09","Product":"Product_B","Sales":36,"x":1725840000000,"y":36},{"Date":"2024-09-10","Product":"Product_B","Sales":25,"x":1725926400000,"y":25},{"Date":"2024-09-11","Product":"Product_B","Sales":43,"x":1726012800000,"y":43},{"Date":"2024-09-12","Product":"Product_B","Sales":20,"x":1726099200000,"y":20},{"Date":"2024-09-13","Product":"Product_B","Sales":21,"x":1726185600000,"y":21},{"Date":"2024-09-14","Product":"Product_B","Sales":49,"x":1726272000000,"y":49},{"Date":"2024-09-15","Product":"Product_B","Sales":32,"x":1726358400000,"y":32},{"Date":"2024-09-16","Product":"Product_B","Sales":12,"x":1726444800000,"y":12},{"Date":"2024-09-17","Product":"Product_B","Sales":39,"x":1726531200000,"y":39},{"Date":"2024-09-18","Product":"Product_B","Sales":38,"x":1726617600000,"y":38},{"Date":"2024-09-19","Product":"Product_B","Sales":36,"x":1726704000000,"y":36},{"Date":"2024-09-20","Product":"Product_B","Sales":6,"x":1726790400000,"y":6},{"Date":"2024-09-21","Product":"Product_B","Sales":48,"x":1726876800000,"y":48},{"Date":"2024-09-22","Product":"Product_B","Sales":28,"x":1726963200000,"y":28},{"Date":"2024-09-23","Product":"Product_B","Sales":35,"x":1727049600000,"y":35},{"Date":"2024-09-24","Product":"Product_B","Sales":24,"x":1727136000000,"y":24},{"Date":"2024-09-25","Product":"Product_B","Sales":38,"x":1727222400000,"y":38},{"Date":"2024-09-26","Product":"Product_B","Sales":8,"x":1727308800000,"y":8},{"Date":"2024-09-27","Product":"Product_B","Sales":27,"x":1727395200000,"y":27},{"Date":"2024-09-28","Product":"Product_B","Sales":53,"x":1727481600000,"y":53},{"Date":"2024-09-29","Product":"Product_B","Sales":27,"x":1727568000000,"y":27},{"Date":"2024-09-30","Product":"Product_B","Sales":4,"x":1727654400000,"y":4},{"Date":"2024-10-01","Product":"Product_B","Sales":40,"x":1727740800000,"y":40},{"Date":"2024-10-02","Product":"Product_B","Sales":53,"x":1727827200000,"y":53},{"Date":"2024-10-03","Product":"Product_B","Sales":13,"x":1727913600000,"y":13},{"Date":"2024-10-04","Product":"Product_B","Sales":8,"x":1728000000000,"y":8},{"Date":"2024-10-05","Product":"Product_B","Sales":57,"x":1728086400000,"y":57},{"Date":"2024-10-06","Product":"Product_B","Sales":7,"x":1728172800000,"y":7},{"Date":"2024-10-07","Product":"Product_B","Sales":16,"x":1728259200000,"y":16},{"Date":"2024-10-08","Product":"Product_B","Sales":3,"x":1728345600000,"y":3},{"Date":"2024-10-09","Product":"Product_B","Sales":51,"x":1728432000000,"y":51},{"Date":"2024-10-10","Product":"Product_B","Sales":14,"x":1728518400000,"y":14},{"Date":"2024-10-11","Product":"Product_B","Sales":24,"x":1728604800000,"y":24},{"Date":"2024-10-12","Product":"Product_B","Sales":46,"x":1728691200000,"y":46},{"Date":"2024-10-13","Product":"Product_B","Sales":6,"x":1728777600000,"y":6},{"Date":"2024-10-14","Product":"Product_B","Sales":5,"x":1728864000000,"y":5},{"Date":"2024-10-15","Product":"Product_B","Sales":40,"x":1728950400000,"y":40},{"Date":"2024-10-16","Product":"Product_B","Sales":37,"x":1729036800000,"y":37},{"Date":"2024-10-17","Product":"Product_B","Sales":22,"x":1729123200000,"y":22},{"Date":"2024-10-18","Product":"Product_B","Sales":36,"x":1729209600000,"y":36},{"Date":"2024-10-19","Product":"Product_B","Sales":44,"x":1729296000000,"y":44},{"Date":"2024-10-20","Product":"Product_B","Sales":38,"x":1729382400000,"y":38},{"Date":"2024-10-21","Product":"Product_B","Sales":22,"x":1729468800000,"y":22},{"Date":"2024-10-22","Product":"Product_B","Sales":11,"x":1729555200000,"y":11},{"Date":"2024-10-23","Product":"Product_B","Sales":59,"x":1729641600000,"y":59},{"Date":"2024-10-24","Product":"Product_B","Sales":5,"x":1729728000000,"y":5},{"Date":"2024-10-25","Product":"Product_B","Sales":33,"x":1729814400000,"y":33},{"Date":"2024-10-26","Product":"Product_B","Sales":33,"x":1729900800000,"y":33},{"Date":"2024-10-27","Product":"Product_B","Sales":12,"x":1729987200000,"y":12},{"Date":"2024-10-28","Product":"Product_B","Sales":35,"x":1730073600000,"y":35},{"Date":"2024-10-29","Product":"Product_B","Sales":22,"x":1730160000000,"y":22},{"Date":"2024-10-30","Product":"Product_B","Sales":35,"x":1730246400000,"y":35},{"Date":"2024-10-31","Product":"Product_B","Sales":8,"x":1730332800000,"y":8}],"type":"line"},{"name":"Product_C","data":[{"Date":"2024-05-01","Product":"Product_C","Sales":30,"x":1714521600000,"y":30},{"Date":"2024-05-02","Product":"Product_C","Sales":15,"x":1714608000000,"y":15},{"Date":"2024-05-03","Product":"Product_C","Sales":5,"x":1714694400000,"y":5},{"Date":"2024-05-04","Product":"Product_C","Sales":28,"x":1714780800000,"y":28},{"Date":"2024-05-05","Product":"Product_C","Sales":10,"x":1714867200000,"y":10},{"Date":"2024-05-06","Product":"Product_C","Sales":20,"x":1714953600000,"y":20},{"Date":"2024-05-07","Product":"Product_C","Sales":32,"x":1715040000000,"y":32},{"Date":"2024-05-08","Product":"Product_C","Sales":17,"x":1715126400000,"y":17},{"Date":"2024-05-09","Product":"Product_C","Sales":27,"x":1715212800000,"y":27},{"Date":"2024-05-10","Product":"Product_C","Sales":13,"x":1715299200000,"y":13},{"Date":"2024-05-11","Product":"Product_C","Sales":11,"x":1715385600000,"y":11},{"Date":"2024-05-12","Product":"Product_C","Sales":15,"x":1715472000000,"y":15},{"Date":"2024-05-13","Product":"Product_C","Sales":24,"x":1715558400000,"y":24},{"Date":"2024-05-14","Product":"Product_C","Sales":21,"x":1715644800000,"y":21},{"Date":"2024-05-15","Product":"Product_C","Sales":24,"x":1715731200000,"y":24},{"Date":"2024-05-16","Product":"Product_C","Sales":23,"x":1715817600000,"y":23},{"Date":"2024-05-17","Product":"Product_C","Sales":26,"x":1715904000000,"y":26},{"Date":"2024-05-18","Product":"Product_C","Sales":28,"x":1715990400000,"y":28},{"Date":"2024-05-19","Product":"Product_C","Sales":3,"x":1716076800000,"y":3},{"Date":"2024-05-20","Product":"Product_C","Sales":36,"x":1716163200000,"y":36},{"Date":"2024-05-21","Product":"Product_C","Sales":37,"x":1716249600000,"y":37},{"Date":"2024-05-22","Product":"Product_C","Sales":26,"x":1716336000000,"y":26},{"Date":"2024-05-23","Product":"Product_C","Sales":29,"x":1716422400000,"y":29},{"Date":"2024-05-24","Product":"Product_C","Sales":16,"x":1716508800000,"y":16},{"Date":"2024-05-25","Product":"Product_C","Sales":18,"x":1716595200000,"y":18},{"Date":"2024-05-26","Product":"Product_C","Sales":7,"x":1716681600000,"y":7},{"Date":"2024-05-27","Product":"Product_C","Sales":26,"x":1716768000000,"y":26},{"Date":"2024-05-28","Product":"Product_C","Sales":32,"x":1716854400000,"y":32},{"Date":"2024-05-29","Product":"Product_C","Sales":20,"x":1716940800000,"y":20},{"Date":"2024-05-30","Product":"Product_C","Sales":11,"x":1717027200000,"y":11},{"Date":"2024-05-31","Product":"Product_C","Sales":14,"x":1717113600000,"y":14},{"Date":"2024-06-01","Product":"Product_C","Sales":7,"x":1717200000000,"y":7},{"Date":"2024-06-02","Product":"Product_C","Sales":2,"x":1717286400000,"y":2},{"Date":"2024-06-03","Product":"Product_C","Sales":39,"x":1717372800000,"y":39},{"Date":"2024-06-04","Product":"Product_C","Sales":27,"x":1717459200000,"y":27},{"Date":"2024-06-05","Product":"Product_C","Sales":27,"x":1717545600000,"y":27},{"Date":"2024-06-06","Product":"Product_C","Sales":27,"x":1717632000000,"y":27},{"Date":"2024-06-07","Product":"Product_C","Sales":11,"x":1717718400000,"y":11},{"Date":"2024-06-08","Product":"Product_C","Sales":28,"x":1717804800000,"y":28},{"Date":"2024-06-09","Product":"Product_C","Sales":14,"x":1717891200000,"y":14},{"Date":"2024-06-10","Product":"Product_C","Sales":20,"x":1717977600000,"y":20},{"Date":"2024-06-11","Product":"Product_C","Sales":33,"x":1718064000000,"y":33},{"Date":"2024-06-12","Product":"Product_C","Sales":16,"x":1718150400000,"y":16},{"Date":"2024-06-13","Product":"Product_C","Sales":9,"x":1718236800000,"y":9},{"Date":"2024-06-14","Product":"Product_C","Sales":5,"x":1718323200000,"y":5},{"Date":"2024-06-15","Product":"Product_C","Sales":7,"x":1718409600000,"y":7},{"Date":"2024-06-16","Product":"Product_C","Sales":11,"x":1718496000000,"y":11},{"Date":"2024-06-17","Product":"Product_C","Sales":21,"x":1718582400000,"y":21},{"Date":"2024-06-18","Product":"Product_C","Sales":24,"x":1718668800000,"y":24},{"Date":"2024-06-19","Product":"Product_C","Sales":21,"x":1718755200000,"y":21},{"Date":"2024-06-20","Product":"Product_C","Sales":25,"x":1718841600000,"y":25},{"Date":"2024-06-21","Product":"Product_C","Sales":26,"x":1718928000000,"y":26},{"Date":"2024-06-22","Product":"Product_C","Sales":25,"x":1719014400000,"y":25},{"Date":"2024-06-23","Product":"Product_C","Sales":17,"x":1719100800000,"y":17},{"Date":"2024-06-24","Product":"Product_C","Sales":37,"x":1719187200000,"y":37},{"Date":"2024-06-25","Product":"Product_C","Sales":37,"x":1719273600000,"y":37},{"Date":"2024-06-26","Product":"Product_C","Sales":20,"x":1719360000000,"y":20},{"Date":"2024-06-27","Product":"Product_C","Sales":4,"x":1719446400000,"y":4},{"Date":"2024-06-28","Product":"Product_C","Sales":25,"x":1719532800000,"y":25},{"Date":"2024-06-29","Product":"Product_C","Sales":22,"x":1719619200000,"y":22},{"Date":"2024-06-30","Product":"Product_C","Sales":8,"x":1719705600000,"y":8},{"Date":"2024-07-01","Product":"Product_C","Sales":38,"x":1719792000000,"y":38},{"Date":"2024-07-02","Product":"Product_C","Sales":27,"x":1719878400000,"y":27},{"Date":"2024-07-03","Product":"Product_C","Sales":22,"x":1719964800000,"y":22},{"Date":"2024-07-04","Product":"Product_C","Sales":11,"x":1720051200000,"y":11},{"Date":"2024-07-05","Product":"Product_C","Sales":8,"x":1720137600000,"y":8},{"Date":"2024-07-06","Product":"Product_C","Sales":20,"x":1720224000000,"y":20},{"Date":"2024-07-07","Product":"Product_C","Sales":30,"x":1720310400000,"y":30},{"Date":"2024-07-08","Product":"Product_C","Sales":40,"x":1720396800000,"y":40},{"Date":"2024-07-09","Product":"Product_C","Sales":39,"x":1720483200000,"y":39},{"Date":"2024-07-10","Product":"Product_C","Sales":24,"x":1720569600000,"y":24},{"Date":"2024-07-11","Product":"Product_C","Sales":15,"x":1720656000000,"y":15},{"Date":"2024-07-12","Product":"Product_C","Sales":25,"x":1720742400000,"y":25},{"Date":"2024-07-13","Product":"Product_C","Sales":30,"x":1720828800000,"y":30},{"Date":"2024-07-14","Product":"Product_C","Sales":25,"x":1720915200000,"y":25},{"Date":"2024-07-15","Product":"Product_C","Sales":30,"x":1721001600000,"y":30},{"Date":"2024-07-16","Product":"Product_C","Sales":34,"x":1721088000000,"y":34},{"Date":"2024-07-17","Product":"Product_C","Sales":4,"x":1721174400000,"y":4},{"Date":"2024-07-18","Product":"Product_C","Sales":11,"x":1721260800000,"y":11},{"Date":"2024-07-19","Product":"Product_C","Sales":20,"x":1721347200000,"y":20},{"Date":"2024-07-20","Product":"Product_C","Sales":3,"x":1721433600000,"y":3},{"Date":"2024-07-21","Product":"Product_C","Sales":8,"x":1721520000000,"y":8},{"Date":"2024-07-22","Product":"Product_C","Sales":21,"x":1721606400000,"y":21},{"Date":"2024-07-23","Product":"Product_C","Sales":23,"x":1721692800000,"y":23},{"Date":"2024-07-24","Product":"Product_C","Sales":22,"x":1721779200000,"y":22},{"Date":"2024-07-25","Product":"Product_C","Sales":12,"x":1721865600000,"y":12},{"Date":"2024-07-26","Product":"Product_C","Sales":27,"x":1721952000000,"y":27},{"Date":"2024-07-27","Product":"Product_C","Sales":12,"x":1722038400000,"y":12},{"Date":"2024-07-28","Product":"Product_C","Sales":27,"x":1722124800000,"y":27},{"Date":"2024-07-29","Product":"Product_C","Sales":39,"x":1722211200000,"y":39},{"Date":"2024-07-30","Product":"Product_C","Sales":38,"x":1722297600000,"y":38},{"Date":"2024-07-31","Product":"Product_C","Sales":7,"x":1722384000000,"y":7},{"Date":"2024-08-01","Product":"Product_C","Sales":27,"x":1722470400000,"y":27},{"Date":"2024-08-02","Product":"Product_C","Sales":24,"x":1722556800000,"y":24},{"Date":"2024-08-03","Product":"Product_C","Sales":11,"x":1722643200000,"y":11},{"Date":"2024-08-04","Product":"Product_C","Sales":10,"x":1722729600000,"y":10},{"Date":"2024-08-05","Product":"Product_C","Sales":38,"x":1722816000000,"y":38},{"Date":"2024-08-06","Product":"Product_C","Sales":40,"x":1722902400000,"y":40},{"Date":"2024-08-07","Product":"Product_C","Sales":29,"x":1722988800000,"y":29},{"Date":"2024-08-08","Product":"Product_C","Sales":14,"x":1723075200000,"y":14},{"Date":"2024-08-09","Product":"Product_C","Sales":19,"x":1723161600000,"y":19},{"Date":"2024-08-10","Product":"Product_C","Sales":16,"x":1723248000000,"y":16},{"Date":"2024-08-11","Product":"Product_C","Sales":22,"x":1723334400000,"y":22},{"Date":"2024-08-12","Product":"Product_C","Sales":36,"x":1723420800000,"y":36},{"Date":"2024-08-13","Product":"Product_C","Sales":21,"x":1723507200000,"y":21},{"Date":"2024-08-14","Product":"Product_C","Sales":9,"x":1723593600000,"y":9},{"Date":"2024-08-15","Product":"Product_C","Sales":14,"x":1723680000000,"y":14},{"Date":"2024-08-16","Product":"Product_C","Sales":15,"x":1723766400000,"y":15},{"Date":"2024-08-17","Product":"Product_C","Sales":3,"x":1723852800000,"y":3},{"Date":"2024-08-18","Product":"Product_C","Sales":7,"x":1723939200000,"y":7},{"Date":"2024-08-19","Product":"Product_C","Sales":32,"x":1724025600000,"y":32},{"Date":"2024-08-20","Product":"Product_C","Sales":38,"x":1724112000000,"y":38},{"Date":"2024-08-21","Product":"Product_C","Sales":29,"x":1724198400000,"y":29},{"Date":"2024-08-22","Product":"Product_C","Sales":14,"x":1724284800000,"y":14},{"Date":"2024-08-23","Product":"Product_C","Sales":17,"x":1724371200000,"y":17},{"Date":"2024-08-24","Product":"Product_C","Sales":20,"x":1724457600000,"y":20},{"Date":"2024-08-25","Product":"Product_C","Sales":17,"x":1724544000000,"y":17},{"Date":"2024-08-26","Product":"Product_C","Sales":21,"x":1724630400000,"y":21},{"Date":"2024-08-27","Product":"Product_C","Sales":40,"x":1724716800000,"y":40},{"Date":"2024-08-28","Product":"Product_C","Sales":9,"x":1724803200000,"y":9},{"Date":"2024-08-29","Product":"Product_C","Sales":26,"x":1724889600000,"y":26},{"Date":"2024-08-30","Product":"Product_C","Sales":30,"x":1724976000000,"y":30},{"Date":"2024-08-31","Product":"Product_C","Sales":24,"x":1725062400000,"y":24},{"Date":"2024-09-01","Product":"Product_C","Sales":14,"x":1725148800000,"y":14},{"Date":"2024-09-02","Product":"Product_C","Sales":21,"x":1725235200000,"y":21},{"Date":"2024-09-03","Product":"Product_C","Sales":23,"x":1725321600000,"y":23},{"Date":"2024-09-04","Product":"Product_C","Sales":9,"x":1725408000000,"y":9},{"Date":"2024-09-05","Product":"Product_C","Sales":27,"x":1725494400000,"y":27},{"Date":"2024-09-06","Product":"Product_C","Sales":6,"x":1725580800000,"y":6},{"Date":"2024-09-07","Product":"Product_C","Sales":24,"x":1725667200000,"y":24},{"Date":"2024-09-08","Product":"Product_C","Sales":10,"x":1725753600000,"y":10},{"Date":"2024-09-09","Product":"Product_C","Sales":33,"x":1725840000000,"y":33},{"Date":"2024-09-10","Product":"Product_C","Sales":20,"x":1725926400000,"y":20},{"Date":"2024-09-11","Product":"Product_C","Sales":29,"x":1726012800000,"y":29},{"Date":"2024-09-12","Product":"Product_C","Sales":27,"x":1726099200000,"y":27},{"Date":"2024-09-13","Product":"Product_C","Sales":12,"x":1726185600000,"y":12},{"Date":"2024-09-14","Product":"Product_C","Sales":28,"x":1726272000000,"y":28},{"Date":"2024-09-15","Product":"Product_C","Sales":24,"x":1726358400000,"y":24},{"Date":"2024-09-16","Product":"Product_C","Sales":40,"x":1726444800000,"y":40},{"Date":"2024-09-17","Product":"Product_C","Sales":30,"x":1726531200000,"y":30},{"Date":"2024-09-18","Product":"Product_C","Sales":16,"x":1726617600000,"y":16},{"Date":"2024-09-19","Product":"Product_C","Sales":5,"x":1726704000000,"y":5},{"Date":"2024-09-20","Product":"Product_C","Sales":29,"x":1726790400000,"y":29},{"Date":"2024-09-21","Product":"Product_C","Sales":8,"x":1726876800000,"y":8},{"Date":"2024-09-22","Product":"Product_C","Sales":12,"x":1726963200000,"y":12},{"Date":"2024-09-23","Product":"Product_C","Sales":24,"x":1727049600000,"y":24},{"Date":"2024-09-24","Product":"Product_C","Sales":40,"x":1727136000000,"y":40},{"Date":"2024-09-25","Product":"Product_C","Sales":29,"x":1727222400000,"y":29},{"Date":"2024-09-26","Product":"Product_C","Sales":4,"x":1727308800000,"y":4},{"Date":"2024-09-27","Product":"Product_C","Sales":14,"x":1727395200000,"y":14},{"Date":"2024-09-28","Product":"Product_C","Sales":21,"x":1727481600000,"y":21},{"Date":"2024-09-29","Product":"Product_C","Sales":24,"x":1727568000000,"y":24},{"Date":"2024-09-30","Product":"Product_C","Sales":31,"x":1727654400000,"y":31},{"Date":"2024-10-01","Product":"Product_C","Sales":21,"x":1727740800000,"y":21},{"Date":"2024-10-02","Product":"Product_C","Sales":9,"x":1727827200000,"y":9},{"Date":"2024-10-03","Product":"Product_C","Sales":4,"x":1727913600000,"y":4},{"Date":"2024-10-04","Product":"Product_C","Sales":10,"x":1728000000000,"y":10},{"Date":"2024-10-05","Product":"Product_C","Sales":17,"x":1728086400000,"y":17},{"Date":"2024-10-06","Product":"Product_C","Sales":12,"x":1728172800000,"y":12},{"Date":"2024-10-07","Product":"Product_C","Sales":35,"x":1728259200000,"y":35},{"Date":"2024-10-08","Product":"Product_C","Sales":37,"x":1728345600000,"y":37},{"Date":"2024-10-09","Product":"Product_C","Sales":19,"x":1728432000000,"y":19},{"Date":"2024-10-10","Product":"Product_C","Sales":8,"x":1728518400000,"y":8},{"Date":"2024-10-11","Product":"Product_C","Sales":22,"x":1728604800000,"y":22},{"Date":"2024-10-12","Product":"Product_C","Sales":6,"x":1728691200000,"y":6},{"Date":"2024-10-13","Product":"Product_C","Sales":25,"x":1728777600000,"y":25},{"Date":"2024-10-14","Product":"Product_C","Sales":39,"x":1728864000000,"y":39},{"Date":"2024-10-15","Product":"Product_C","Sales":27,"x":1728950400000,"y":27},{"Date":"2024-10-16","Product":"Product_C","Sales":8,"x":1729036800000,"y":8},{"Date":"2024-10-17","Product":"Product_C","Sales":18,"x":1729123200000,"y":18},{"Date":"2024-10-18","Product":"Product_C","Sales":27,"x":1729209600000,"y":27},{"Date":"2024-10-19","Product":"Product_C","Sales":4,"x":1729296000000,"y":4},{"Date":"2024-10-20","Product":"Product_C","Sales":17,"x":1729382400000,"y":17},{"Date":"2024-10-21","Product":"Product_C","Sales":25,"x":1729468800000,"y":25},{"Date":"2024-10-22","Product":"Product_C","Sales":22,"x":1729555200000,"y":22},{"Date":"2024-10-23","Product":"Product_C","Sales":19,"x":1729641600000,"y":19},{"Date":"2024-10-24","Product":"Product_C","Sales":11,"x":1729728000000,"y":11},{"Date":"2024-10-25","Product":"Product_C","Sales":16,"x":1729814400000,"y":16},{"Date":"2024-10-26","Product":"Product_C","Sales":30,"x":1729900800000,"y":30},{"Date":"2024-10-27","Product":"Product_C","Sales":13,"x":1729987200000,"y":13},{"Date":"2024-10-28","Product":"Product_C","Sales":28,"x":1730073600000,"y":28},{"Date":"2024-10-29","Product":"Product_C","Sales":20,"x":1730160000000,"y":20},{"Date":"2024-10-30","Product":"Product_C","Sales":17,"x":1730246400000,"y":17},{"Date":"2024-10-31","Product":"Product_C","Sales":30,"x":1730332800000,"y":30}],"type":"line"}],"xAxis":{"type":"datetime","title":{"text":"Date"},"categories":null}},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Nếu ta phân tich sâu về nhu cầu của từng mặt hàng theo thứ trong tuần, ta sẽ thấy rằng mặt hàng A, B thì bán chạy vào thứ 4 và thứ 7, còn mặt hàng C thì bán chạy vào thứ 2 và thứ 3.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Product A:</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Product B:</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Product C:</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item" id="htmlwidget-bac8d16a92a06a70f027" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-bac8d16a92a06a70f027">{"x":{"hc_opts":{"chart":{"reflow":true,"type":"column"},"title":{"text":"Comparing sales data between weekday"},"yAxis":{"title":{"text":"No.product"}},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"marker":{"symbol":"circle"},"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"}},"xAxis":{"type":"category","categories":""},"series":[{"g2":null,"data":[{"name":"Sunday","low":5,"q1":22,"median":32,"q3":40,"high":50},{"name":"Monday","low":6,"q1":13,"median":30,"q3":41,"high":50},{"name":"Tuesday","low":6,"q1":21,"median":30,"q3":41,"high":50},{"name":"Wednesday","low":40,"q1":46.5,"median":57,"q3":64,"high":70},{"name":"Thursday","low":5,"q1":14.5,"median":33,"q3":40,"high":48},{"name":"Friday","low":6,"q1":17,"median":28.5,"q3":33,"high":50},{"name":"Saturday","low":40,"q1":53,"median":58,"q3":68,"high":70}],"type":"boxplot","id":null,"name":"Weekday sales"}]},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item" id="htmlwidget-caf1e036a521ede4005d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-caf1e036a521ede4005d">{"x":{"hc_opts":{"chart":{"reflow":true,"type":"column"},"title":{"text":"Comparing sales data between weekday"},"yAxis":{"title":{"text":"No.product"}},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"marker":{"symbol":"circle"},"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"}},"xAxis":{"type":"category","categories":""},"series":[{"g2":null,"data":[{"name":"Friday","low":5,"q1":13,"median":21,"q3":30,"high":39},{"name":"Monday","low":4,"q1":12,"median":19,"q3":35,"high":40},{"name":"Saturday","low":31,"q1":37,"median":42.5,"q3":52,"high":59},{"name":"Sunday","low":6,"q1":18,"median":27,"q3":30,"high":40},{"name":"Thursday","low":3,"q1":11,"median":20,"q3":28.5,"high":40},{"name":"Tuesday","low":3,"q1":11,"median":24,"q3":32,"high":40},{"name":"Wednesday","low":32,"q1":38,"median":41,"q3":50,"high":59}],"type":"boxplot","id":null,"name":"Weekday sales"}]},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item" id="htmlwidget-3836913bc3ce468d09e2" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-3836913bc3ce468d09e2">{"x":{"hc_opts":{"chart":{"reflow":true,"type":"column"},"title":{"text":"Comparing sales data between weekday"},"yAxis":{"title":{"text":"No.product"}},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"marker":{"symbol":"circle"},"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"}},"xAxis":{"type":"category","categories":""},"series":[{"g2":null,"data":[{"name":"Friday","low":5,"q1":12,"median":16.5,"q3":25,"high":30},{"name":"Monday","low":20,"q1":24,"median":31.5,"q3":38,"high":40},{"name":"Saturday","low":3,"q1":8,"median":19,"q3":25,"high":30},{"name":"Sunday","low":2,"q1":10,"median":13.5,"q3":22,"high":30},{"name":"Thursday","low":4,"q1":11,"median":14,"q3":26.5,"high":30},{"name":"Tuesday","low":20,"q1":23,"median":31,"q3":37,"high":40},{"name":"Wednesday","low":4,"q1":12.5,"median":20,"q3":25,"high":30}],"type":"boxplot","id":null,"name":"Weekday sales"}]},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
<p>Thông thường dữ liệu để <em>train model</em> trong <em>machine learning</em> thường cần trải qua bước <em>normalize data</em> nghĩa là đưa tất cả dữ liệu về chung 1 thước đo và phạm vi. Nguyên do vì điều này giúp nhiều thuật toán học máy dễ dàng hội tụ hơn. Ví dụ, các thuật toán như <em>k-Nearest Neighbors (KNN)</em> và <em>Support Vector Machines (SVM)</em> rất nhạy cảm với khoảng cách giữa các điểm dữ liệu nên nếu dữ liệu không được chuẩn hóa, thuật toán có thể ưu tiên các đặc trưng có phạm vi lớn hơn và bỏ qua các đặc trưng có phạm vi nhỏ hơn, dẫn đến hiệu suất kém. Và công thức phổ biến nhất cho chuẩn hóa là:</p>
<p><span class="math display">\[
\text{Normalized Value} = \frac{x - \min(x)}{\max(x) - \min(x)}
\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with the adjusted sales data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>sales_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> dates,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Weekday =</span> weekdays,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_A =</span> product_a_sales,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_B =</span> product_b_sales,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_C =</span> product_c_sales</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the sales data to a time series (ts) object for Product A</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>product_a_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(sales_data<span class="sc">$</span>Product_A, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2024</span>, <span class="dv">5</span>), </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">frequency =</span> <span class="dv">365</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalzie data:</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>time_series_data<span class="ot">&lt;-</span><span class="fu">scale</span>(product_a_ts)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(highcharter)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">highchart</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_add_series</span>(<span class="at">data =</span> <span class="fu">as.numeric</span>(time_series_data), <span class="at">type =</span> <span class="st">"line"</span>, <span class="at">name =</span> <span class="st">"Sales of Product A"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Normalized Time Series of Product A"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_xAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Date"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Normalized Sales"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_tooltip</span>(<span class="at">shared =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_plotOptions</span>(<span class="at">line =</span> <span class="fu">list</span>(<span class="at">marker =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">FALSE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item" id="htmlwidget-c64457a584143ef1e822" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c64457a584143ef1e822">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":"Normalized Time Series of Product A"},"yAxis":{"title":{"text":"Normalized Sales"}},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0},"treemap":{"layoutAlgorithm":"squarified"},"line":{"marker":{"enabled":false}}},"series":[{"data":[1.362140423320018,-1.780603625468488,-0.4337133188448424,0.2397318344669803,0.1836114050243284,-0.8265563249434057,-0.4898337482874943,0.5203339816802398,0.1836114050243284,-0.4337133188448424,0.7448156994508474,0.7448156994508474,-0.7143154660581019,-0.3775928894021905,0.969297417221455,0.4642135522375879,-0.4337133188448424,0.9131769877788031,0.1836114050243284,0.2397318344669803,-0.09699074218893107,1.642742570533278,-1.55612190769788,-0.7143154660581019,1.081538276106759,-0.2653520305168868,0.408093122794936,-1.668362766583184,0.2397318344669803,0.5203339816802398,-0.4898337482874943,1.811103858861233,0.5764544111228918,-0.9949176132713614,-0.6020746071727981,1.249899564434714,0.1836114050243284,-1.612242337140532,1.41826085276267,-0.8265563249434057,0.6886952700081955,-0.2653520305168868,1.306019993877366,-1.612242337140532,0.07137054613902463,1.137658705549411,-0.4898337482874943,-0.5459541777301462,-0.3775928894021905,0.6886952700081955,-1.500001478255228,-1.724483196025836,0.2958522639096322,-0.65819503661545,-1.724483196025836,0.2958522639096322,1.137658705549411,0.408093122794936,-1.55612190769788,0.1836114050243284,0.3519726933522841,0.1836114050243284,0.6886952700081955,1.811103858861233,-1.331640189927273,-0.2092316010742349,1.193779134992063,-0.7143154660581019,-1.331640189927273,0.5764544111228918,1.867224288303885,-0.2092316010742349,-0.9387971838287095,1.754983429418582,-0.2653520305168868,0.7448156994508474,-1.55612190769788,1.137658705549411,-1.724483196025836,-0.8265563249434057,1.474381282205322,-0.8265563249434057,-1.55612190769788,0.7448156994508474,1.41826085276267,0.408093122794936,-0.65819503661545,0.8009361288934993,0.1836114050243284,0.3519726933522841,0.5203339816802398,0.5203339816802398,-0.3214724599595387,-1.107158472156665,1.867224288303885,-0.04087031274627917,-0.9387971838287095,-0.2092316010742349,0.7448156994508474,0.6325748405655436,-1.331640189927273,1.867224288303885,0.5764544111228918,-1.387760619369925,-0.2092316010742349,1.249899564434714,-1.780603625468488,-1.107158472156665,1.081538276106759,-1.55612190769788,-1.331640189927273,-0.9387971838287095,0.1836114050243284,0.5764544111228918,0.5203339816802398,1.081538276106759,0.01525011669637273,-0.2092316010742349,-0.4337133188448424,0.5764544111228918,-0.8826767543860576,0.7448156994508474,1.586622141090626,-1.500001478255228,0.5764544111228918,0.2397318344669803,0.6325748405655436,-0.09699074218893107,0.07137054613902463,1.69886299997593,-0.04087031274627917,-1.500001478255228,-0.6020746071727981,0.1836114050243284,-0.09699074218893107,-1.500001478255228,1.867224288303885,-0.9949176132713614,0.07137054613902463,0.5203339816802398,1.867224288303885,-1.163278901599317,-0.3775928894021905,1.811103858861233,-1.780603625468488,-1.724483196025836,-0.4898337482874943,0.2397318344669803,-0.4337133188448424,-0.2653520305168868,0.2958522639096322,-1.051038042714013,0.07137054613902463,-1.724483196025836,1.642742570533278,-0.04087031274627917,-0.3214724599595387,1.754983429418582,-0.2653520305168868,0.2397318344669803,-1.275519760484621,1.811103858861233,0.1274909755816765,-1.051038042714013,1.586622141090626,-0.2653520305168868,0.01525011669637273,0.2397318344669803,1.811103858861233,-0.3775928894021905,-0.09699074218893107,1.193779134992063,0.5764544111228918,-0.04087031274627917,-0.8826767543860576,0.1836114050243284,-0.153111171631583,0.1836114050243284,0.969297417221455,-1.219399331041969,-0.8826767543860576,-1.331640189927273,0.7448156994508474,-1.107158472156665],"type":"line","name":"Sales of Product A"}],"xAxis":{"title":{"text":"Date"}},"tooltip":{"shared":true}},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="chia-dữ-liệu" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="chia-dữ-liệu"><span class="header-section-number">2.2</span> Chia dữ liệu:</h3>
<p>Vậy để <em>train data</em>, mình sẽ chia bộ dữ liệu thành 3 phần:</p>
<ul>
<li><p><em>Training data</em>: dùng để huấn luyện và xây dựng mô hình.</p></li>
<li><p><em>Evaluating data</em>: đánh giá mô hình vừa huấn luyện.</p></li>
<li><p><em>Testing data</em>: dùng để đánh giá lại nếu muốn mô hình học lại dữ liệu</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sales_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> dates,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Weekday =</span> weekdays,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_A =</span> product_a_sales,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_B =</span> product_b_sales,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_C =</span> product_c_sales</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the sales data to a time series (ts) object for Product A</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>time_series_data <span class="ot">&lt;-</span> <span class="fu">scale</span>(<span class="fu">ts</span>(sales_data<span class="sc">$</span>Product_A, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2024</span>, <span class="dv">5</span>), </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">frequency =</span> <span class="dv">365</span>))</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>create_supervised_data <span class="ot">&lt;-</span> <span class="cf">function</span>(series, n) {</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  series <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(series)  <span class="co"># Convert time series object to vector</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(series)    <span class="co"># Initialize data frame with the original series</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create lag columns</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    lagged_column <span class="ot">&lt;-</span> <span class="fu">lag</span>(series, i)  <span class="co"># Get lagged values</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data, lagged_column)  <span class="co"># Add lagged column to the data</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Name the columns properly</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">'t-'</span>, n<span class="sc">:</span><span class="dv">1</span>), <span class="st">'t+1'</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove rows with NA values (those at the start of the series due to lagging)</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data with 12 input lags and 1 output (next time step)</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>supervised_data <span class="ot">&lt;-</span> <span class="fu">create_supervised_data</span>(time_series_data,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">n =</span> <span class="dv">50</span>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Split data into training and test sets</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>train_size <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(supervised_data))   <span class="co"># 70% for training</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>val_size <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">nrow</span>(supervised_data))     <span class="co"># 10% for validation</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>test_size <span class="ot">&lt;-</span> <span class="fu">nrow</span>(supervised_data) <span class="sc">-</span> train_size <span class="sc">-</span> val_size  <span class="co"># 20% for testing</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> supervised_data[<span class="dv">1</span><span class="sc">:</span>train_size, ]</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>val_data <span class="ot">&lt;-</span> supervised_data[(train_size <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(train_size <span class="sc">+</span> val_size), ]</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> supervised_data[(train_size <span class="sc">+</span> val_size <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(supervised_data), ]</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct column selection</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>x_train <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(train_data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>])  <span class="co"># Input features (12 lags)</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(train_data[, <span class="st">'t+1'</span>])  <span class="co"># Target output (next time step)</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>x_val <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(val_data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>])  <span class="co"># Input features for validation</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>y_val <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(val_data[, <span class="st">'t+1'</span>])  <span class="co"># Actual output for validation</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(test_data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>])  <span class="co"># Input features for testing</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(test_data[, <span class="st">'t+1'</span>])  <span class="co"># Actual output for testing</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot the result:</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">quantile</span>(sales_data<span class="sc">$</span>Date, </span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>,<span class="dv">1</span>), </span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span>sales_data <span class="sc">|&gt;</span> </span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&lt;=</span> n[[<span class="dv">2</span>]])</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>m2<span class="ot">&lt;-</span>sales_data <span class="sc">|&gt;</span> </span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&lt;=</span> n[[<span class="dv">3</span>]] <span class="sc">&amp;</span> Date <span class="sc">&gt;</span> n[[<span class="dv">2</span>]])</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>m3<span class="ot">&lt;-</span>sales_data <span class="sc">|&gt;</span> </span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&lt;=</span> n[[<span class="dv">4</span>]] <span class="sc">&amp;</span> Date <span class="sc">&gt;</span> n[[<span class="dv">3</span>]])</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>demand_training<span class="ot">&lt;-</span><span class="fu">xts</span>(<span class="at">x=</span>m1<span class="sc">$</span>Product_A,</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>                     <span class="at">order.by=</span>m1<span class="sc">$</span>Date)</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>demand_testing<span class="ot">&lt;-</span><span class="fu">xts</span>(<span class="at">x=</span>m2<span class="sc">$</span>Product_A,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>                     <span class="at">order.by=</span>m2<span class="sc">$</span>Date)</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>demand_forecasting<span class="ot">&lt;-</span><span class="fu">xts</span>(<span class="at">x=</span>m3<span class="sc">$</span>Product_A,</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>                     <span class="at">order.by=</span>m3<span class="sc">$</span>Date)</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dygraphs)</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>lines<span class="ot">&lt;-</span><span class="fu">cbind</span>(demand_training,</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>             demand_testing,</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>             demand_forecasting)</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a><span class="fu">dygraph</span>(lines,</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Training and testing data"</span>, </span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Quantity order (Unit: Millions)"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"demand_training"</span>, <span class="at">label =</span> <span class="st">"Training data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"demand_testing"</span>, <span class="at">label =</span> <span class="st">"Testing data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"demand_forecasting"</span>, <span class="at">label =</span> <span class="st">"Forecasting data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyOptions</span>(<span class="at">fillGraph =</span> <span class="cn">TRUE</span>, <span class="at">fillAlpha =</span> <span class="fl">0.4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyRangeSelector</span>(<span class="at">height =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="dygraphs html-widget html-fill-item" id="htmlwidget-02c8bffe2c5a1cdae629" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-02c8bffe2c5a1cdae629">{"x":{"attrs":{"title":"Training and testing data","ylabel":"Quantity order (Unit: Millions)","labels":["day","Training data","Testing data","Forecasting data"],"legend":"auto","retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60,"drawAxis":true},"y":{"drawAxis":true}},"series":{"Training data":{"axis":"y"},"Testing data":{"axis":"y"},"Forecasting data":{"axis":"y"}},"stackedGraph":false,"fillGraph":true,"fillAlpha":0.4,"stepPlot":false,"drawPoints":false,"pointSize":1,"drawGapEdgePoints":false,"connectSeparatedPoints":false,"strokeWidth":1,"strokeBorderColor":"white","colorValue":0.5,"colorSaturation":1,"includeZero":false,"drawAxesAtZero":false,"logscale":false,"axisTickSize":3,"axisLineColor":"black","axisLineWidth":0.3,"axisLabelColor":"black","axisLabelFontSize":14,"axisLabelWidth":60,"drawGrid":true,"gridLineWidth":0.3,"rightGap":5,"digitsAfterDecimal":2,"labelsKMB":false,"labelsKMG2":false,"labelsUTC":false,"maxNumberWidth":6,"animatedZooms":false,"mobileDisableYTouch":true,"disableZoom":false,"showRangeSelector":true,"rangeSelectorHeight":20,"rangeSelectorPlotFillColor":" #A7B1C4","rangeSelectorPlotStrokeColor":"#808FAB","interactionModel":"Dygraph.Interaction.defaultModel"},"scale":"daily","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2024-05-01T00:00:00.000Z","2024-05-02T00:00:00.000Z","2024-05-03T00:00:00.000Z","2024-05-04T00:00:00.000Z","2024-05-05T00:00:00.000Z","2024-05-06T00:00:00.000Z","2024-05-07T00:00:00.000Z","2024-05-08T00:00:00.000Z","2024-05-09T00:00:00.000Z","2024-05-10T00:00:00.000Z","2024-05-11T00:00:00.000Z","2024-05-12T00:00:00.000Z","2024-05-13T00:00:00.000Z","2024-05-14T00:00:00.000Z","2024-05-15T00:00:00.000Z","2024-05-16T00:00:00.000Z","2024-05-17T00:00:00.000Z","2024-05-18T00:00:00.000Z","2024-05-19T00:00:00.000Z","2024-05-20T00:00:00.000Z","2024-05-21T00:00:00.000Z","2024-05-22T00:00:00.000Z","2024-05-23T00:00:00.000Z","2024-05-24T00:00:00.000Z","2024-05-25T00:00:00.000Z","2024-05-26T00:00:00.000Z","2024-05-27T00:00:00.000Z","2024-05-28T00:00:00.000Z","2024-05-29T00:00:00.000Z","2024-05-30T00:00:00.000Z","2024-05-31T00:00:00.000Z","2024-06-01T00:00:00.000Z","2024-06-02T00:00:00.000Z","2024-06-03T00:00:00.000Z","2024-06-04T00:00:00.000Z","2024-06-05T00:00:00.000Z","2024-06-06T00:00:00.000Z","2024-06-07T00:00:00.000Z","2024-06-08T00:00:00.000Z","2024-06-09T00:00:00.000Z","2024-06-10T00:00:00.000Z","2024-06-11T00:00:00.000Z","2024-06-12T00:00:00.000Z","2024-06-13T00:00:00.000Z","2024-06-14T00:00:00.000Z","2024-06-15T00:00:00.000Z","2024-06-16T00:00:00.000Z","2024-06-17T00:00:00.000Z","2024-06-18T00:00:00.000Z","2024-06-19T00:00:00.000Z","2024-06-20T00:00:00.000Z","2024-06-21T00:00:00.000Z","2024-06-22T00:00:00.000Z","2024-06-23T00:00:00.000Z","2024-06-24T00:00:00.000Z","2024-06-25T00:00:00.000Z","2024-06-26T00:00:00.000Z","2024-06-27T00:00:00.000Z","2024-06-28T00:00:00.000Z","2024-06-29T00:00:00.000Z","2024-06-30T00:00:00.000Z","2024-07-01T00:00:00.000Z","2024-07-02T00:00:00.000Z","2024-07-03T00:00:00.000Z","2024-07-04T00:00:00.000Z","2024-07-05T00:00:00.000Z","2024-07-06T00:00:00.000Z","2024-07-07T00:00:00.000Z","2024-07-08T00:00:00.000Z","2024-07-09T00:00:00.000Z","2024-07-10T00:00:00.000Z","2024-07-11T00:00:00.000Z","2024-07-12T00:00:00.000Z","2024-07-13T00:00:00.000Z","2024-07-14T00:00:00.000Z","2024-07-15T00:00:00.000Z","2024-07-16T00:00:00.000Z","2024-07-17T00:00:00.000Z","2024-07-18T00:00:00.000Z","2024-07-19T00:00:00.000Z","2024-07-20T00:00:00.000Z","2024-07-21T00:00:00.000Z","2024-07-22T00:00:00.000Z","2024-07-23T00:00:00.000Z","2024-07-24T00:00:00.000Z","2024-07-25T00:00:00.000Z","2024-07-26T00:00:00.000Z","2024-07-27T00:00:00.000Z","2024-07-28T00:00:00.000Z","2024-07-29T00:00:00.000Z","2024-07-30T00:00:00.000Z","2024-07-31T00:00:00.000Z","2024-08-01T00:00:00.000Z","2024-08-02T00:00:00.000Z","2024-08-03T00:00:00.000Z","2024-08-04T00:00:00.000Z","2024-08-05T00:00:00.000Z","2024-08-06T00:00:00.000Z","2024-08-07T00:00:00.000Z","2024-08-08T00:00:00.000Z","2024-08-09T00:00:00.000Z","2024-08-10T00:00:00.000Z","2024-08-11T00:00:00.000Z","2024-08-12T00:00:00.000Z","2024-08-13T00:00:00.000Z","2024-08-14T00:00:00.000Z","2024-08-15T00:00:00.000Z","2024-08-16T00:00:00.000Z","2024-08-17T00:00:00.000Z","2024-08-18T00:00:00.000Z","2024-08-19T00:00:00.000Z","2024-08-20T00:00:00.000Z","2024-08-21T00:00:00.000Z","2024-08-22T00:00:00.000Z","2024-08-23T00:00:00.000Z","2024-08-24T00:00:00.000Z","2024-08-25T00:00:00.000Z","2024-08-26T00:00:00.000Z","2024-08-27T00:00:00.000Z","2024-08-28T00:00:00.000Z","2024-08-29T00:00:00.000Z","2024-08-30T00:00:00.000Z","2024-08-31T00:00:00.000Z","2024-09-01T00:00:00.000Z","2024-09-02T00:00:00.000Z","2024-09-03T00:00:00.000Z","2024-09-04T00:00:00.000Z","2024-09-05T00:00:00.000Z","2024-09-06T00:00:00.000Z","2024-09-07T00:00:00.000Z","2024-09-08T00:00:00.000Z","2024-09-09T00:00:00.000Z","2024-09-10T00:00:00.000Z","2024-09-11T00:00:00.000Z","2024-09-12T00:00:00.000Z","2024-09-13T00:00:00.000Z","2024-09-14T00:00:00.000Z","2024-09-15T00:00:00.000Z","2024-09-16T00:00:00.000Z","2024-09-17T00:00:00.000Z","2024-09-18T00:00:00.000Z","2024-09-19T00:00:00.000Z","2024-09-20T00:00:00.000Z","2024-09-21T00:00:00.000Z","2024-09-22T00:00:00.000Z","2024-09-23T00:00:00.000Z","2024-09-24T00:00:00.000Z","2024-09-25T00:00:00.000Z","2024-09-26T00:00:00.000Z","2024-09-27T00:00:00.000Z","2024-09-28T00:00:00.000Z","2024-09-29T00:00:00.000Z","2024-09-30T00:00:00.000Z","2024-10-01T00:00:00.000Z","2024-10-02T00:00:00.000Z","2024-10-03T00:00:00.000Z","2024-10-04T00:00:00.000Z","2024-10-05T00:00:00.000Z","2024-10-06T00:00:00.000Z","2024-10-07T00:00:00.000Z","2024-10-08T00:00:00.000Z","2024-10-09T00:00:00.000Z","2024-10-10T00:00:00.000Z","2024-10-11T00:00:00.000Z","2024-10-12T00:00:00.000Z","2024-10-13T00:00:00.000Z","2024-10-14T00:00:00.000Z","2024-10-15T00:00:00.000Z","2024-10-16T00:00:00.000Z","2024-10-17T00:00:00.000Z","2024-10-18T00:00:00.000Z","2024-10-19T00:00:00.000Z","2024-10-20T00:00:00.000Z","2024-10-21T00:00:00.000Z","2024-10-22T00:00:00.000Z","2024-10-23T00:00:00.000Z","2024-10-24T00:00:00.000Z","2024-10-25T00:00:00.000Z","2024-10-26T00:00:00.000Z","2024-10-27T00:00:00.000Z","2024-10-28T00:00:00.000Z","2024-10-29T00:00:00.000Z","2024-10-30T00:00:00.000Z","2024-10-31T00:00:00.000Z"],[61,5,29,41,40,22,28,46,40,29,50,50,24,30,54,45,29,53,40,41,35,66,9,24,56,32,44,7,41,46,28,69,47,19,26,59,40,8,62,22,49,32,60,8,38,57,28,27,30,49,10,6,42,25,6,42,57,44,9,40,43,40,49,69,13,33,58,24,13,47,70,33,20,68,32,50,9,57,6,22,63,22,9,50,62,44,25,51,40,43,46,46,31,17,70,36,20,33,50,48,13,70,47,12,33,59,5,17,56,9,13,20,40,47,46,56,37,33,29,47,21,50,65,10,47,41,48,35,38,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,67,36,10,26,40,35,10,70,19,38,46,70,16,30,69,5,6,28,41,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,29,32,42,18,38,6,66,36,31,68,32,41,14,69,39,18,65,32,37,41,69,30,35,58,47,36,21,40,34,40,54,15,21,13,50,17]],"fixedtz":false,"tzone":"UTC"},"evals":["attrs.interactionModel"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="mô-hình-rnn-1" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="mô-hình-rnn-1"><span class="header-section-number">2.3</span> Mô hình RNN:</h3>
<p>Sau đó, ta sẽ bắt đầu <em>train model</em> bằng cách tạo thêm 12 cột giá trị là giá trị quá khứ của <em>demand</em>. Bạn sẽ bắt đầu định nghĩa mô hình gồm:</p>
<ul>
<li><p><em>Input</em>: dùng hàm <code>layer_input(shape = input_shape)</code> với <code>input_shape</code> là số lượng <em>predictor</em>.</p></li>
<li><p><em>Layer</em>: là các hidden layer trong mô hình thêm vào bằng hàm <code>layer_dense(x, units = 64, activation = 'relu')</code> với đối số <code>units</code> thường là bội số của 32 như 32,64,256,…</p></li>
<li><p><em>Output</em>: dùng hàm <code>layer_dense(x, units = 1)</code> để định nghĩa là đầu ra chỉ có 1 giá trị.</p></li>
</ul>
<p>Đối với các mô hình truyền thống như <em>linear regression</em> thì bạn đã quen với thông số <span class="math inline">\(R^2\)</span> để đánh giá mô hình, còn với mô hình <em>Machine learning</em> thì dùng khái niệm <em>loss function - hàm mất mát</em>. Về khái niệm, <em>loss function</em> sẽ đo lường chênh lệch giữa <em>predicted</em> và <em>actual</em> trong bộ <em>training data</em> nên khi càng tăng <code>epochs</code> nghĩa là tăng số lần học lại dữ liệu thì <em>loss function</em> sẽ tính ra giá trị càng thấp. Như mô hình trên thì mình đặt đối số <code>loss = mse</code> nghĩa là sử dụng <em>Mean Squared Error</em> để tối ưu quy trình học của học máy. Công thức như sau:</p>
<p><span class="math display">\[
MSE = \frac{1}{n} \sum_{i=1}^{n} (y_{\text{pred}}(i) - y_{\text{true}}(i))^2
\]</span></p>
<p>Còn đối số <code>metrics = c('mae')</code> nghĩa là tiêu chí khác để theo dõi và đánh giá mô hình. Vậy tại sao cần có 2 tham số đánh giá song song như vậy là vì như đã nói, nếu bạn càng tăng <code>epochs</code> thì giá trị <em>loss</em> càng thấp trong khi dùng <code>metrics</code> sẽ đưa ra đánh giá khách quan hơn về mô hình mà không phụ thuộc vào số lần <code>epochs</code>. Công thức như sau:</p>
<p><span class="math display">\[
\text{MAE} = \frac{1}{n} \sum_{i=1}^{n} |y_{\text{pred}}(i) - y_{\text{true}}(i)|
\]</span></p>
<p>Vậy khi chạy code, R sẽ return output như biểu đồ dưới đây là so sánh tham số của <em>mse</em> và <em>mae</em> giữa <em>training data</em> và <em>evaluating data</em>. Ý tưởng là đánh giá thử mô hình có dự đoán tốt không khi có dữ liệu mới vào.</p>
<p>Tiếp theo, ta sẽ dùng <em>test data</em> để đánh giá mô hình vừa xây dựng. Kết quả có vẻ khá ổn vì mô hình gần như theo sát được dữ liệu của <em>test data</em>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Make predictions</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>RNN_forecast <span class="ot">&lt;-</span> RNN_model <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 - 0s - 261ms/step</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Combine predicted and observed</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">actual =</span> y_test,  <span class="co"># Actual values from the test set</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">forecast =</span> RNN_forecast  <span class="co"># Forecasted values</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 8: Plot using Highcharts</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">highchart</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Time Series Forecasting with Highcharts"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_xAxis</span>(</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">categories =</span> plot_data<span class="sc">$</span>time,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Time"</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Value"</span>),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plotLines =</span> <span class="fu">list</span>(<span class="fu">list</span>(</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="dv">0</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">1</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"gray"</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_add_series</span>(</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Actual Data"</span>,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> plot_data<span class="sc">$</span>actual,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"line"</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#1f77b4"</span>  <span class="co"># Blue color for actual data</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_add_series</span>(</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Forecast"</span>,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> plot_data<span class="sc">$</span>forecast,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"line"</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#ff7f0e"</span>  <span class="co"># Orange color for forecast data</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_tooltip</span>(</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">shared =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">crosshairs =</span> <span class="cn">TRUE</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_legend</span>(</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">enabled =</span> <span class="cn">TRUE</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item" id="htmlwidget-10e113bfb0d94b57d7e5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-10e113bfb0d94b57d7e5">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":"Time Series Forecasting with Highcharts"},"yAxis":{"title":{"text":"Value"},"plotLines":[{"value":0,"width":1,"color":"gray"}]},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0},"treemap":{"layoutAlgorithm":"squarified"}},"xAxis":{"categories":null,"title":{"text":"Time"}},"series":[{"data":[-1.107158472156665,1.081538276106759,-1.55612190769788,-1.331640189927273,-0.9387971838287095,0.1836114050243284,0.5764544111228918,0.5203339816802398,1.081538276106759,0.01525011669637273,-0.2092316010742349,-0.4337133188448424,0.5764544111228918,-0.8826767543860576,0.7448156994508474,1.586622141090626,-1.500001478255228,0.5764544111228918,0.2397318344669803,0.6325748405655436,-0.09699074218893107,0.07137054613902463,1.69886299997593,-0.04087031274627917,-1.500001478255228,-0.6020746071727981,0.1836114050243284],"name":"Actual Data","type":"line","color":"#1f77b4"},{"data":[-0.9324171543121338,0.2872019708156586,-0.3612872362136841,-0.3541276156902313,0.03798284754157066,0.4330086410045624,-0.5392088294029236,-0.7345243692398071,1.13161027431488,-0.121529147028923,-0.8126715421676636,0.3862707912921906,1.017809629440308,-0.7785512208938599,-1.042561650276184,0.9883020520210266,0.155557855963707,0.2579160332679749,0.3654913604259491,0.3244177401065826,-0.6048127412796021,-0.6656824350357056,0.8845527172088623,-0.4110614061355591,-0.870338499546051,0.1895084232091904,1.051501870155334],"name":"Forecast","type":"line","color":"#ff7f0e"}],"tooltip":{"shared":true,"crosshairs":true},"legend":{"enabled":true}},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="mô-hình-lstm-1" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="mô-hình-lstm-1"><span class="header-section-number">2.4</span> Mô hình LSTM:</h3>
<p>Tiếp theo, ta sẽ xây dựng thử mô hình <em>LSTM</em>. Mô hình LSTM thường bao gồm các lớp sau:</p>
<ul>
<li><p>Lớp LSTM: Đây là lớp chính, có thể có một hoặc nhiều lớp LSTM chồng lên nhau. Mỗi lớp LSTM có thể trả về toàn bộ chuỗi bằng <code>return_sequences = TRUE</code> hoặc chỉ trả về giá trị cuối cùng bằng <code>return_sequences = FALSE</code>.</p></li>
<li><p>Lớp Dense: Sau khi thông tin được xử lý qua các lớp LSTM, nó sẽ được đưa qua các lớp Dense (lớp fully connected) để đưa ra dự đoán cuối cùng.</p></li>
<li><p>Lớp Dropout (tùy chọn): Để tránh overfitting, có thể thêm lớp dropout để tắt ngẫu nhiên một số nơ-ron trong quá trình huấn luyện.</p></li>
</ul>
<p>Vậy giờ ta sẽ so sánh với mô hình <em>RNN</em> trước với mô hình <em>LSTM</em> qua 2 thông số đã chọn <em>mse</em> và <em>mae</em>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract metrics into a data frame</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"RNN"</span>, <span class="st">"LSTM"</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE =</span> <span class="fu">c</span>(RNN_result[[<span class="dv">1</span>]],RNN_result[[<span class="dv">2</span>]]),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE =</span> <span class="fu">c</span>(LSTM_result[[<span class="dv">1</span>]], LSTM_result[[<span class="dv">2</span>]])</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a gt table</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>results_df <span class="sc">|&gt;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Performance Metrics"</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Comparison of MSE and MAE for RNN and LSTM"</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">vars</span>(MSE, MAE),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">6</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model =</span> <span class="st">"Model Type"</span>,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">MSE =</span> <span class="st">"Mean Squared Error"</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">MAE =</span> <span class="st">"Mean Absolute Error"</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="dv">14</span>,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="dv">16</span>,</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="dv">14</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tnixflvqki" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tnixflvqki table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tnixflvqki thead, #tnixflvqki tbody, #tnixflvqki tfoot, #tnixflvqki tr, #tnixflvqki td, #tnixflvqki th {
  border-style: none;
}

#tnixflvqki p {
  margin: 0;
  padding: 0;
}

#tnixflvqki .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 14px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tnixflvqki .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tnixflvqki .gt_title {
  color: #333333;
  font-size: 16px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tnixflvqki .gt_subtitle {
  color: #333333;
  font-size: 14px;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tnixflvqki .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tnixflvqki .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tnixflvqki .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tnixflvqki .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tnixflvqki .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tnixflvqki .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tnixflvqki .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tnixflvqki .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tnixflvqki .gt_spanner_row {
  border-bottom-style: hidden;
}

#tnixflvqki .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tnixflvqki .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tnixflvqki .gt_from_md > :first-child {
  margin-top: 0;
}

#tnixflvqki .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tnixflvqki .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tnixflvqki .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tnixflvqki .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tnixflvqki .gt_row_group_first td {
  border-top-width: 2px;
}

#tnixflvqki .gt_row_group_first th {
  border-top-width: 2px;
}

#tnixflvqki .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tnixflvqki .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tnixflvqki .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tnixflvqki .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tnixflvqki .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tnixflvqki .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tnixflvqki .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tnixflvqki .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tnixflvqki .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tnixflvqki .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tnixflvqki .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tnixflvqki .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tnixflvqki .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tnixflvqki .gt_left {
  text-align: left;
}

#tnixflvqki .gt_center {
  text-align: center;
}

#tnixflvqki .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tnixflvqki .gt_font_normal {
  font-weight: normal;
}

#tnixflvqki .gt_font_bold {
  font-weight: bold;
}

#tnixflvqki .gt_font_italic {
  font-style: italic;
}

#tnixflvqki .gt_super {
  font-size: 65%;
}

#tnixflvqki .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tnixflvqki .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tnixflvqki .gt_indent_1 {
  text-indent: 5px;
}

#tnixflvqki .gt_indent_2 {
  text-indent: 10px;
}

#tnixflvqki .gt_indent_3 {
  text-indent: 15px;
}

#tnixflvqki .gt_indent_4 {
  text-indent: 20px;
}

#tnixflvqki .gt_indent_5 {
  text-indent: 25px;
}

#tnixflvqki .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tnixflvqki div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="3" class="gt_heading gt_title gt_font_normal">Model Performance Metrics</th>
</tr>
<tr class="gt_heading even">
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Comparison of MSE and MAE for RNN and LSTM</th>
</tr>
<tr class="gt_col_headings header">
<th id="Model Type" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Model Type</th>
<th id="Mean Squared Error" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean Squared Error</th>
<th id="Mean Absolute Error" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mean Absolute Error</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Model">RNN</td>
<td class="gt_row gt_right" headers="MSE">0.667671</td>
<td class="gt_row gt_right" headers="MAE">0.791753</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Model">LSTM</td>
<td class="gt_row gt_right" headers="MSE">0.681708</td>
<td class="gt_row gt_right" headers="MAE">0.736382</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Kết quả cho thấy mô hình <em>LSTM</em> đưa ra kết quả tốt hơn <em>RNN</em> với độ sai số thấp hơn nhưng nếu bạn để ý thì thấy trong biểu đồ mình vẫn để % âm để dễ phân biệt giữa việc <em>outstock</em> và <em>high inventory</em> (bởi vì bạn đang dự báo cho nhu cầu của khách hàng). Bạn có thể so sánh thêm 1 bước nữa về tổng chi phí giữa 2 mô hình về <em>outstock</em> và <em>holding cost</em> để có cái nhìn tổng quan nhất.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>LSTM_forecast <span class="ot">&lt;-</span> LSTM_model <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 - 0s - 314ms/step</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>compare<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Date =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y_test),</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">LSTM =</span> <span class="fu">round</span>((LSTM_forecast <span class="sc">-</span> y_test)<span class="sc">/</span>y_test,<span class="dv">3</span>),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">RNN =</span> <span class="fu">round</span>((RNN_forecast <span class="sc">-</span> y_test)<span class="sc">/</span>y_test,<span class="dv">3</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the highchart plot with percentage formatting for y-axis</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">highchart</span>() <span class="sc">|&gt;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_chart</span>(<span class="at">type =</span> <span class="st">"line"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Residual Comparison: LSTM vs RNN"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_xAxis</span>(</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">categories =</span> compare<span class="sc">$</span>Date,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Date"</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Residuals"</span>),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">list</span>(</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">formatter =</span> <span class="fu">JS</span>(<span class="st">"function() { return (this.value).toFixed(0) + '%'; }"</span>)  <span class="co"># Format labels as percentages</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plotLines =</span> <span class="fu">list</span>(</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">value =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">dashStyle =</span> <span class="st">"Dash"</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_add_series</span>(</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"LSTM Residuals"</span>,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> compare<span class="sc">$</span>LSTM,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#1f77b4"</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_add_series</span>(</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"RNN Residuals"</span>,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> compare<span class="sc">$</span>RNN,</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#ff7f0e"</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_tooltip</span>(<span class="at">shared =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_legend</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item" id="htmlwidget-9dd5ddb2c96fa0698618" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9dd5ddb2c96fa0698618">{"x":{"hc_opts":{"chart":{"reflow":true,"type":"line"},"title":{"text":"Residual Comparison: LSTM vs RNN"},"yAxis":{"title":{"text":"Residuals"},"labels":{"formatter":"function() { return (this.value).toFixed(0) + '%'; }"},"plotLines":[{"value":0,"color":"gray","width":1,"dashStyle":"Dash"}]},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0},"treemap":{"layoutAlgorithm":"squarified"}},"xAxis":{"categories":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],"title":{"text":"Date"}},"series":[{"data":[-1.079,-0.921,-0.983,-0.912,-0.827,-1.774,-1.174,-1.112,-1.014,-2.883,-0.746,-0.829,-1.108,-0.905,-1.037,-0.987,-0.978,-0.989,-0.852,-0.881,-1.966,0.919,-0.876,-5.411,-1.071,-1.132,-0.578],"name":"LSTM Residuals","color":"#1f77b4"},{"data":[-0.158,-0.734,-0.768,-0.734,-1.04,1.358,-1.935,-2.412,0.046,-8.968999999999999,2.884,-1.891,0.766,-0.118,-2.4,-0.377,-1.104,-0.553,0.525,-0.487,5.236,-10.327,-0.479,9.058,-0.42,-1.315,4.727],"name":"RNN Residuals","color":"#ff7f0e"}],"tooltip":{"shared":true},"legend":{"enabled":true}},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":["hc_opts.yAxis.labels.formatter"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="xác-định-cấu-trúc-mô-hình" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="xác-định-cấu-trúc-mô-hình"><span class="header-section-number">2.5</span> Xác định cấu trúc mô hình:</h3>
<p>Nếu bạn để ý, thực chất code cho mô hình cho như mình đã trình bày thì khá đơn giản và điều khó nhất trong mô hình là xác định số lớp <em>layer</em> trong mô hình. Như bài toán <em>time series forecasting</em> thì mình chỉ cần 2,3 lớp layer đơn giản là đã đạt kết quả tốt với sai số rất thấp (&lt; 0.03), còn với các bài toán phức tạp hơn thì số <em>layer</em> sẽ nhiều hơn.</p>
<p>Vậy quy tắc xác định mô hình là như thế nào ? Câu trả lời là <strong>không có quy tắc nào cả</strong> và chỉ có các tips mà mình lụm nhặt trên mạng như sau:</p>
<section id="number-of-layer" class="level4" data-number="2.5.1">
<h4 data-number="2.5.1" class="anchored" data-anchor-id="number-of-layer"><span class="header-section-number">2.5.1</span> Number of layer:</h4>
<p>Số <em>layer</em> nên nằm giữa số input và số output. Như bài thực hành trên thì số <em>layer</em> nên nằm trong khoảng (1,12). Hoặc bạn có thể sử dụng hàm dưới đây để xác định.</p>
<p><span class="math display">\[
N_h = \frac{N_s}{\alpha \cdot (N_i + N_o)}
\]</span></p>
<p>Với các tham số gồm:</p>
<ol type="1">
<li><p><span class="math inline">\(N_h\)</span> là số lượng <em>hidden neurons</em>.</p></li>
<li><p><span class="math inline">\(N_s\)</span> là số lượng mẫu trong <em>training data</em>.</p></li>
<li><p><span class="math inline">\(\alpha\)</span> là yếu tố tỷ lệ tùy ý (thường từ 2-10).</p></li>
<li><p><span class="math inline">\(N_i\)</span> là số lượng nơ-ron input</p></li>
<li><p><span class="math inline">\(N_o\)</span> là số lượng nơ-ron output.</p></li>
</ol>
<p>Ví dụ như ở mô hình trên thì số <em>hidden layer</em> sẽ khoảng 1-4 layer là ổn (Như trên thì mình dùng 1 layer cho mô hình RNN, 2 layer cho mô hình LSTM)</p>
</section>
<section id="choose-acvtivation-function" class="level4" data-number="2.5.2">
<h4 data-number="2.5.2" class="anchored" data-anchor-id="choose-acvtivation-function"><span class="header-section-number">2.5.2</span> Choose acvtivation function:</h4>
<p>Các hàm <em>activation</em> dùng để tính <em>weighted sum</em> và mỗi <em>layer</em> sẽ cần có 1 hoặc nhiều hàm để tính. Việc lựa chọn hàm ảnh hưởng lớn đến <em>performance</em> của mô hình, thường sẽ được chia thành 3 phần là:</p>
<ol type="1">
<li><p><em>Activation for input layer</em>: thường ko dùng hàm gì cả. Bạn chỉ thực hiện <em>processing</em> dữ liệu để training.</p></li>
<li><p><em>Activation for Hidden Layers</em>:</p></li>
</ol>
<p>Thông thường, hàm <strong>Tanh</strong> thì phù hợp cho dự báo giá trị liên tục từ dữ liệu chuỗi, <strong>ReLU</strong> giúp cho quá trình training nhanh hơn và không gây ra <em>vanishing problem</em> do không bị chặn, <strong>Softmax</strong> thường dùng ở <em>output layer</em> cho bài toán classification, <strong>Sigmoid</strong> thường dùng cho hồi quy logic. Ngoài ra, cách đơn giản hơn là tùy vào loại mô hình bạn đang xây dựng để lựa chọn, ví dụ như tips dưới đây mình tìm hiểu được:</p>
<div style="text-align: center; margin-bottom: 20px;">
  <img src="img/choose.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;">
  
  <!-- Picture Name -->
  <div style="text-align: left; margin-top: 10px;">
    Hình 4: Tips chọn hàm activation cho hidden layer 
  </div>
  
  <!-- Source Link -->
  <div style="text-align: right; font-style: italic; margin-top: 5px;">
    Source: <a href="https://machinelearningmastery.com/choose-an-activation-function-for-deep-learning/" target="_blank">Link to Image</a>
  </div>
</div>
<ol start="3" type="1">
<li><em>Activation for Output Layers</em>:</li>
</ol>
<p>Đối với <em>output layer</em>, bạn sẽ lựa chọn hàm dựa trên <em>class</em> của output mà bạn đang hướng đến. Các hàm thông thường sẽ gồm:</p>
<ul>
<li><p><strong>Linear</strong>: hay còn gọi là “identity” (nhân với 1.0) hoặc “no activation” bởi vì hàm <em>linear</em> tuyến tính không thay đổi <em>weighted sum</em> của input theo bất kỳ cách nào và thay vào đó trả về giá trị trực tiếp. Hàm này thường dùng cho output dạng liên tục.</p></li>
<li><p><strong>Logistic (Sigmoid)</strong>: áp dụng cho output dạng [0,1] hay còn gọi là <em>binary classification</em> (ví dụ mô hình nhằm đưa ra quyết định có/không trong việc đầu tư vào cổ phiểu này chẳng hạn).</p></li>
<li><p><strong>Softmax</strong>: Hàm này sẽ chuyển đổi một vector thành các giá trị xác suất có tổng bằng 1 (Nó giống như tìm hàm mật độ (PDF) cho một biến). Ứng dụng để dán nhãn cho <em>multiclass</em> thay vì 2 class như hàm <em>sigmoid</em> bên trên. Mỗi nhãn sẽ có 1 giá trị xác suất và dựa vào đó dự đoán khả năng xảy ra của từng class.</p></li>
</ul>
</section>
<section id="number-of-neurons" class="level4" data-number="2.5.3">
<h4 data-number="2.5.3" class="anchored" data-anchor-id="number-of-neurons"><span class="header-section-number">2.5.3</span> Number of neurons:</h4>
<p>Số lượng nơ-ron trong một lớp quyết định lượng thông tin mà mạng có thể lưu trữ. Nhiều nơ-ron giúp mạng học được các mẫu phức tạp hơn, nhưng cũng làm tăng nguy cơ overfitting (quá khớp) và yêu cầu nhiều tài nguyên tính toán hơn. Bạn có thể bắt đầu với một số lượng nơ-ron tương đối nhỏ, như 128 hoặc 256…</p>
</section>
</section>
</section>
<section id="kết-luận" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="kết-luận"><span class="header-section-number">3</span> Kết luận:</h2>
<p>Như vậy, chúng ta đã được học về mô hình <em>RNN</em> và <em>LSTM</em> và cách xây dựng chúng trong R. Tiếp theo, ta sẽ học tiếp về mô hình <em>Transformer</em></p>



    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Go to Next Page</title>
    <style>
        /* Global Styles */
        body {
            font-family: 'Tahoma', sans-serif;
            display: flex;
            flex-direction: column;  /* Stack content and footnote vertically */
            justify-content: center;  /* Center content vertically */
            align-items: center;      /* Center content horizontally */
            margin: 0;
            background-color: $secondary-color;
            box-sizing: border-box;
            min-height: 80vh; /* Adjusted to 80vh to ensure it's not too high */
        }

        /* Container Styling (Main Content) */
        .container {
            text-align: center;
            padding: 20px 40px; /* Adjust padding for more compactness */
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            width: auto;  /* Auto width to fit content */
            max-width: 380px;  /* Adjusted max-width for a smaller container */
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            margin-top: 20px;  /* Space from the top of the page */
        }

        /* Link Styling */
        .link {
            font-size: 20px;  /* Adjusted font size for readability */
            color: #007bff;
            text-decoration: none;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            cursor: pointer;
            padding: 12px 30px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .link:hover {
            color: #0056b3;
            text-decoration: none;
            background-color: #e6f0ff;
        }

        /* Arrow Styling */
        .arrow {
            margin-left: 12px;
            font-size: 24px;
            transition: transform 0.3s ease, font-size 0.3s ease;
        }

        .link:hover .arrow {
            transform: translateX(8px);
            font-size: 26px;
        }

        /* Focus State for Accessibility */
        .link:focus {
            outline: 2px solid #0056b3;
        }

        /* Footer Styling (Footnote) */
        .footer {
            font-size: 14px;
            color: #777;
            margin-top: 20px;  /* Space between content and footnote */
            text-align: center;
            width: 100%;
        }

        /* Mobile-Friendly Adjustments */
        @media (max-width: 600px) {
            .link {
                font-size: 18px;
                padding: 8px 15px;  /* Smaller padding for mobile devices */
            }

            .arrow {
                font-size: 18px;
                margin-left: 8px;
            }

            .container {
                padding: 15px 30px;  /* Smaller padding on mobile */
                max-width: 90%;  /* Ensure container fits better on small screens */
            }
        }
    </style>


    <div class="container">
        <a href="https://loccx78vn.github.io/RNN_model/transfer.html" class="link" tabindex="0">
            Go to Next Page
            <span class="arrow">➔</span>
        </a>
    </div>




<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb11" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "RNN and LSTM model"</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Việt Nam, 2024"</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> ["Machine Learning", "Forecasting"]</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>Ở đây ta sẽ học về mô hình machine learning được ứng dụng nhiều nhất trong việc phân tích dữ liệu thời gian là *RNN* và *LSTM*.</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mô hình RNN:</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="fu">### Định nghĩa:</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>Điểm chung là cả hai mô hình đều thuộc phân lớp *Deep learning* - nghĩa là học máy sâu với đặc điểm chung là phân chia dữ liệu thành nhiều lớp và bắt đầu "học" dần qua từng lớp để đưa ra kết quả cuối cùng. Ở hình dưới đây, $X_o$ đại diện cho dữ liệu đầu vào, $h_t$ là output đầu ra của từng step và $A$ là những gì đã "học" được tại step đó và được truyền cho step tiếp theo. Trong tài liệu chuẩn thì họ thường kí hiệu là $X_t$, $Y_t$, $h_{t-1}$.</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;div style="text-align: center; margin-bottom: 20px;"&gt;</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;img src="img/RNN.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;"&gt;</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Picture Name --&gt;</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: left; margin-top: 10px;"&gt;</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="in">    Hình 1: Minh họa về sự phân chia dữ liệu thành nhiều lớp</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Source Link --&gt;</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: right; font-style: italic; margin-top: 5px;"&gt;</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="in">    Source: &lt;a href="https://dominhhai.github.io/vi/2017/10/what-is-lstm/" target="_blank"&gt;Link to Image&lt;/a&gt;</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/div&gt;</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>Khi nhìn hình thì bạn có thể bối rối chưa hiểu các kí tự và hình ảnh thì bạn có thể tưởng tượng **học máy** như 1 đứa trẻ và để nó có thể hiểu được câu: "Hôm nay con đi học" thì nó phải học từng chữ cái như: a,b,c,... trước ròi mới ghép thành từ đơn như: "Hôm","Nay",... rồi ghép thành câu trên.</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>Vậy giả sử như hôm nay học được từ "Hôm" thì nó sẽ bắt đầu ghi nhớ từ đã học vào trong $A$. Nếu sau này ta cần **học máy** hiểu câu "Hôm sau con đi chơi" thì tốc độ học của **học máy** sẽ nhanh lên vì thay vì nó phải học 5 chữ đơn như thông thường thì nó chỉ cần học 4 chữ còn lại trừ chữ "hôm". Vậy bạn đã hiểu ý tưởng nền tảng của *RNN* rồi ha!</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="fu">### Nguyên lí hoạt động:</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>Đầu tiên, *RNN* sẽ tính toán *hidden state* là $h_t$ với công thức là:</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>   \mathbf{h}_t = \text{activation}(\mathbf{W}_\text{hh} \mathbf{h}_{t-1} + \mathbf{W}_\text{xh} \mathbf{x}_t + \mathbf{b}_\text{h})</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>Sau đó, $h_t$ sẽ được làm input cho các *state* sau và dựa vào đó để tính output với công thức là:</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>y_t = W_y \cdot h_t + b_y</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>**Ví dụ:** Mình muốn dự đoán hành động trong câu nói "I am reading book" bằng mô hình *RNN* như sau:</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Bước 1*: Chuyển đổi thành dạng số bằng *embedding layer*:</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>Mình sẽ gán từng từ đơn sang dạng số như:</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>"I" -<span class="sc">\&gt;</span> $x_1$</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>"am" -<span class="sc">\&gt;</span> $x_2$</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>"reading" -<span class="sc">\&gt;</span> $x_3$</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>"book" -<span class="sc">\&gt;</span> $x_4$</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Bước 2:* Thêm hidden layer và bắt đầu tính toán:</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>Cho input: "I"</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>   h_1 = \tanh(W_x \cdot x_1 + W_h \cdot h_0 + b)</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>Cho input: "am"</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>   h_2 = \tanh(W_x \cdot x_2 + W_h \cdot h_1 + b)</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>Cho input: "reading"</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>   h_3 = \tanh(W_x \cdot x_3 + W_h \cdot h_2 + b)</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>Cho input: "book"</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>   h_4 = \tanh(W_x \cdot x_4 + W_h \cdot h_3 + b)</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Bước 3:* Tính toán output: Dùng hàm activation **softmax** để phân lớp theo xác suất.</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>\hat{y} = \text{softmax}(W_y \cdot h_4 + b_y)</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>Nếu muốn hiểu thêm về cách hoạt động *RNN*, bạn có thể tham khảo link này: <span class="co">[</span><span class="ot">Recurrent Neural Network: Từ RNN đến LSTM</span><span class="co">](https://viblo.asia/p/recurrent-neural-network-tu-rnn-den-lstm-gGJ597z1ZX2)</span>.</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a><span class="fu">### Vấn đề lớn của RNN:</span></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>*RNN* có 1 vấn đề lớn là *Vanishing Gradient* nghĩa là mô hình sẽ không còn "học" thêm được nữa cho dù tăng số <span class="in">`epochs`</span>. Nguyên nhân vì sao như vậy thì bạn có thể tham khảo phần chứng minh của <span class="co">[</span><span class="ot">anh Tuấn</span><span class="co">](https://nttuan8.com/bai-14-long-short-term-memory-lstm/)</span>.</span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;div style="text-align: center; margin-bottom: 20px;"&gt;</span></span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;img src="img/vanishing.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;"&gt;</span></span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Picture Name --&gt;</span></span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: left; margin-top: 10px;"&gt;</span></span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a><span class="in">    Hình 2: Vanishing Gradient Problem</span></span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Source Link --&gt;</span></span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: right; font-style: italic; margin-top: 5px;"&gt;</span></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a><span class="in">    Source: &lt;a href="https://www.superdatascience.com/blogs/recurrent-neural-networks-rnn-the-vanishing-gradient-problem" target="_blank"&gt;Link to Image&lt;/a&gt;</span></span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/div&gt;</span></span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>Vấn đề này sẽ làm network khó update *weight* dẫn tới thời gian học lâu và khó để đạt được output. Bạn có thể hiểu đơn giản như việc bạn học liên tục dẫn tới quá tải và *RNN* cũng không như vậy. Do đó, *RNN* chỉ học các thông tin từ *state* gần và đó là lí do ra đời *LSTM - Long short term memory.*</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>&lt;u&gt;Lưu ý&lt;/u&gt;: Điều này không có nghĩa *LSTM* luôn tốt hơn *RNN* vì có những bài toán với đầu vào đơn giản thì mô hình chỉ cần học các step đầu là đã "học" đầy đủ thông tin cần thiết. Mô hình *LSTM* phổ biến với các bài toán phức tạp như tự động dịch ngôn ngữ, ghi chép lại theo giọng nói...</span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mô hình LSTM:</span></span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>Có thể xem mô hình *LSTM* như biến thể của *RNN*. Về cấu trúc, *LSTM* phức tạp hơn *RNN*:</span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;div style="text-align: center; margin-bottom: 20px;"&gt;</span></span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;img src="img/compare.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;"&gt;</span></span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Picture Name --&gt;</span></span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: left; margin-top: 10px;"&gt;</span></span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a><span class="in">    Hình 3: So sánh mô hình RNN và LSTM</span></span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Source Link --&gt;</span></span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: right; font-style: italic; margin-top: 5px;"&gt;</span></span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a><span class="in">    Source: &lt;a href="https://dominhhai.github.io/vi/2017/10/what-is-lstm/" target="_blank"&gt;Link to Image&lt;/a&gt;</span></span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/div&gt;</span></span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>Cấu trúc cơ bản gồm:</span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cổng quên (Forget Gate): có tác dụng quyết định thông tin nào cần bị quên trong trạng thái ô nhớ.</span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cổng nhập (Input Gate): Xác định thông tin nào cần được ghi vào trạng thái ô nhớ.</span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cổng xuất (Output Gate): Quyết định thông tin nào sẽ được xuất ra từ trạng thái ô nhớ để ảnh hưởng đến dự đoán tiếp theo.</span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a>Bạn có thể kham khảo thêm bài viết của <span class="co">[</span><span class="ot">dominhhai</span><span class="co">](https://dominhhai.github.io/vi/2017/10/what-is-lstm/)</span> về cách hoạt động của *RNN* và *LSTM* để hiểu thêm.</span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a>Tiếp theo, ta sẽ bắt đầu xây dựng thử mô hình trong R.</span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a><span class="fu">## Xây dựng mô hình:</span></span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a><span class="fu">### Load dữ liệu:</span></span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>Đầu tiên ta sẽ load dữ liệu lại như trước. Ở đây, để đơn giản, mình chỉ xây dựng mô hình cho *product A* thôi.</span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a>janitor,</span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a>tidyverse,</span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a>dplyr,</span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a>tidyr,</span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a>magrittr,</span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a>ggplot2,</span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a>keras3,</span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a>tensorflow,</span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a>reticulate)</span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the start and end date for the 6-month period</span></span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2024-05-01"</span>)</span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2024-10-31"</span>)</span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate date range</span></span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(start_date, </span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a>                  end_date, </span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a>                  <span class="at">by =</span> <span class="st">"day"</span>)</span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a random seed for reproducibility</span></span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector of weekdays for each date</span></span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a>weekdays <span class="ot">&lt;-</span> <span class="fu">weekdays</span>(dates)</span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-200"><a href="#cb11-200" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate sales data for Product A, B, and C based on weekday patterns</span></span>
<span id="cb11-201"><a href="#cb11-201" aria-hidden="true" tabindex="-1"></a>product_a_sales <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">50</span>, <span class="fu">length</span>(dates), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a>product_b_sales <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">40</span>, <span class="fu">length</span>(dates), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-203"><a href="#cb11-203" aria-hidden="true" tabindex="-1"></a>product_c_sales <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">30</span>, <span class="fu">length</span>(dates), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-204"><a href="#cb11-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-205"><a href="#cb11-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust sales based on the weekday</span></span>
<span id="cb11-206"><a href="#cb11-206" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dates)) {</span>
<span id="cb11-207"><a href="#cb11-207" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (weekdays[i] <span class="sc">==</span> <span class="st">"Wednesday"</span> <span class="sc">|</span> weekdays[i] <span class="sc">==</span> <span class="st">"Saturday"</span>) {</span>
<span id="cb11-208"><a href="#cb11-208" aria-hidden="true" tabindex="-1"></a>    <span class="co"># High demand for Product A and B on Wednesday and Saturday</span></span>
<span id="cb11-209"><a href="#cb11-209" aria-hidden="true" tabindex="-1"></a>    product_a_sales[i] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">40</span><span class="sc">:</span><span class="dv">70</span>, <span class="dv">1</span>)</span>
<span id="cb11-210"><a href="#cb11-210" aria-hidden="true" tabindex="-1"></a>    product_b_sales[i] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">30</span><span class="sc">:</span><span class="dv">60</span>, <span class="dv">1</span>)</span>
<span id="cb11-211"><a href="#cb11-211" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (weekdays[i] <span class="sc">==</span> <span class="st">"Monday"</span> <span class="sc">|</span> weekdays[i] <span class="sc">==</span> <span class="st">"Tuesday"</span>) {</span>
<span id="cb11-212"><a href="#cb11-212" aria-hidden="true" tabindex="-1"></a>    <span class="co"># High demand for Product C on Monday and Tuesday</span></span>
<span id="cb11-213"><a href="#cb11-213" aria-hidden="true" tabindex="-1"></a>    product_c_sales[i] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">20</span><span class="sc">:</span><span class="dv">40</span>, <span class="dv">1</span>)</span>
<span id="cb11-214"><a href="#cb11-214" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-215"><a href="#cb11-215" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-216"><a href="#cb11-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-217"><a href="#cb11-217" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with the adjusted sales data</span></span>
<span id="cb11-218"><a href="#cb11-218" aria-hidden="true" tabindex="-1"></a>sales_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-219"><a href="#cb11-219" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> dates,</span>
<span id="cb11-220"><a href="#cb11-220" aria-hidden="true" tabindex="-1"></a>  <span class="at">Weekday =</span> weekdays,</span>
<span id="cb11-221"><a href="#cb11-221" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_A =</span> product_a_sales,</span>
<span id="cb11-222"><a href="#cb11-222" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_B =</span> product_b_sales,</span>
<span id="cb11-223"><a href="#cb11-223" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_C =</span> product_c_sales</span>
<span id="cb11-224"><a href="#cb11-224" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-225"><a href="#cb11-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-226"><a href="#cb11-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-227"><a href="#cb11-227" aria-hidden="true" tabindex="-1"></a>Giả sử công ty mình đang kinh doanh 3 loại mặt hàng *product A*,*product B*,*product C* và đây là biểu đồ thể hiện nhu cầu của cả 3 mặt hàng từ tháng 5 tới tháng 10.</span>
<span id="cb11-228"><a href="#cb11-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-231"><a href="#cb11-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-232"><a href="#cb11-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-233"><a href="#cb11-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb11-234"><a href="#cb11-234" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(highcharter)</span>
<span id="cb11-235"><a href="#cb11-235" aria-hidden="true" tabindex="-1"></a>sales_data <span class="sc">|&gt;</span> </span>
<span id="cb11-236"><a href="#cb11-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Weekday) <span class="sc">|&gt;</span> </span>
<span id="cb11-237"><a href="#cb11-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Product_A, Product_B, Product_C),</span>
<span id="cb11-238"><a href="#cb11-238" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Product"</span>,</span>
<span id="cb11-239"><a href="#cb11-239" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Sales"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-240"><a href="#cb11-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hchart</span>(<span class="st">"line"</span>, <span class="fu">hcaes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Sales, <span class="at">group =</span> Product))</span>
<span id="cb11-241"><a href="#cb11-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-242"><a href="#cb11-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-243"><a href="#cb11-243" aria-hidden="true" tabindex="-1"></a>Nếu ta phân tich sâu về nhu cầu của từng mặt hàng theo thứ trong tuần, ta sẽ thấy rằng mặt hàng A, B thì bán chạy vào thứ 4 và thứ 7, còn mặt hàng C thì bán chạy vào thứ 2 và thứ 3.</span>
<span id="cb11-244"><a href="#cb11-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-245"><a href="#cb11-245" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb11-246"><a href="#cb11-246" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Product A:</span></span>
<span id="cb11-247"><a href="#cb11-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-250"><a href="#cb11-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-251"><a href="#cb11-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-252"><a href="#cb11-252" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb11-253"><a href="#cb11-253" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb11-254"><a href="#cb11-254" aria-hidden="true" tabindex="-1"></a>mA<span class="ot">&lt;-</span>sales_data <span class="sc">|&gt;</span> </span>
<span id="cb11-255"><a href="#cb11-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, </span>
<span id="cb11-256"><a href="#cb11-256" aria-hidden="true" tabindex="-1"></a>         Weekday,</span>
<span id="cb11-257"><a href="#cb11-257" aria-hidden="true" tabindex="-1"></a>         Product_A)  </span>
<span id="cb11-258"><a href="#cb11-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-259"><a href="#cb11-259" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure 'Weekday' is a factor with the correct order</span></span>
<span id="cb11-260"><a href="#cb11-260" aria-hidden="true" tabindex="-1"></a>mA<span class="sc">$</span>Weekday <span class="ot">&lt;-</span> <span class="fu">factor</span>(mA<span class="sc">$</span>Weekday, </span>
<span id="cb11-261"><a href="#cb11-261" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sunday"</span>, <span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>, <span class="st">"Saturday"</span>))</span>
<span id="cb11-262"><a href="#cb11-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-263"><a href="#cb11-263" aria-hidden="true" tabindex="-1"></a><span class="fu">hcboxplot</span>(</span>
<span id="cb11-264"><a href="#cb11-264" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> mA<span class="sc">$</span>Product_A,</span>
<span id="cb11-265"><a href="#cb11-265" aria-hidden="true" tabindex="-1"></a>    <span class="at">var =</span> mA<span class="sc">$</span>Weekday,</span>
<span id="cb11-266"><a href="#cb11-266" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Weekday sales"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-267"><a href="#cb11-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Comparing sales data between weekday"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-268"><a href="#cb11-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"No.product"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-269"><a href="#cb11-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_chart</span>(<span class="at">type =</span> <span class="st">"column"</span>)</span>
<span id="cb11-270"><a href="#cb11-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-271"><a href="#cb11-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-272"><a href="#cb11-272" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Product B:</span></span>
<span id="cb11-273"><a href="#cb11-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-276"><a href="#cb11-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-277"><a href="#cb11-277" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-278"><a href="#cb11-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb11-279"><a href="#cb11-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb11-280"><a href="#cb11-280" aria-hidden="true" tabindex="-1"></a>mB<span class="ot">&lt;-</span>sales_data <span class="sc">|&gt;</span> </span>
<span id="cb11-281"><a href="#cb11-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, </span>
<span id="cb11-282"><a href="#cb11-282" aria-hidden="true" tabindex="-1"></a>         Weekday,</span>
<span id="cb11-283"><a href="#cb11-283" aria-hidden="true" tabindex="-1"></a>         Product_B)  </span>
<span id="cb11-284"><a href="#cb11-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-285"><a href="#cb11-285" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure 'Weekday' is a factor with the correct order</span></span>
<span id="cb11-286"><a href="#cb11-286" aria-hidden="true" tabindex="-1"></a>mA<span class="sc">$</span>Weekday <span class="ot">&lt;-</span> <span class="fu">factor</span>(mB<span class="sc">$</span>Weekday, </span>
<span id="cb11-287"><a href="#cb11-287" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sunday"</span>, <span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>, <span class="st">"Saturday"</span>))</span>
<span id="cb11-288"><a href="#cb11-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-289"><a href="#cb11-289" aria-hidden="true" tabindex="-1"></a><span class="fu">hcboxplot</span>(</span>
<span id="cb11-290"><a href="#cb11-290" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> mB<span class="sc">$</span>Product_B,</span>
<span id="cb11-291"><a href="#cb11-291" aria-hidden="true" tabindex="-1"></a>    <span class="at">var =</span> mB<span class="sc">$</span>Weekday,</span>
<span id="cb11-292"><a href="#cb11-292" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Weekday sales"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-293"><a href="#cb11-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Comparing sales data between weekday"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-294"><a href="#cb11-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"No.product"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-295"><a href="#cb11-295" aria-hidden="true" tabindex="-1"></a>   <span class="fu">hc_chart</span>(<span class="at">type =</span> <span class="st">"column"</span>)</span>
<span id="cb11-296"><a href="#cb11-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-297"><a href="#cb11-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-298"><a href="#cb11-298" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Product C:</span></span>
<span id="cb11-299"><a href="#cb11-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-302"><a href="#cb11-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-303"><a href="#cb11-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-304"><a href="#cb11-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb11-305"><a href="#cb11-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb11-306"><a href="#cb11-306" aria-hidden="true" tabindex="-1"></a>mC<span class="ot">&lt;-</span>sales_data <span class="sc">|&gt;</span> </span>
<span id="cb11-307"><a href="#cb11-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, </span>
<span id="cb11-308"><a href="#cb11-308" aria-hidden="true" tabindex="-1"></a>         Weekday,</span>
<span id="cb11-309"><a href="#cb11-309" aria-hidden="true" tabindex="-1"></a>         Product_C)  </span>
<span id="cb11-310"><a href="#cb11-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-311"><a href="#cb11-311" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure 'Weekday' is a factor with the correct order</span></span>
<span id="cb11-312"><a href="#cb11-312" aria-hidden="true" tabindex="-1"></a>mA<span class="sc">$</span>Weekday <span class="ot">&lt;-</span> <span class="fu">factor</span>(mC<span class="sc">$</span>Weekday, </span>
<span id="cb11-313"><a href="#cb11-313" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Sunday"</span>, <span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>, <span class="st">"Saturday"</span>))</span>
<span id="cb11-314"><a href="#cb11-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-315"><a href="#cb11-315" aria-hidden="true" tabindex="-1"></a><span class="fu">hcboxplot</span>(</span>
<span id="cb11-316"><a href="#cb11-316" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> mC<span class="sc">$</span>Product_C,</span>
<span id="cb11-317"><a href="#cb11-317" aria-hidden="true" tabindex="-1"></a>    <span class="at">var =</span> mC<span class="sc">$</span>Weekday,</span>
<span id="cb11-318"><a href="#cb11-318" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Weekday sales"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-319"><a href="#cb11-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Comparing sales data between weekday"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-320"><a href="#cb11-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"No.product"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-321"><a href="#cb11-321" aria-hidden="true" tabindex="-1"></a>   <span class="fu">hc_chart</span>(<span class="at">type =</span> <span class="st">"column"</span>)</span>
<span id="cb11-322"><a href="#cb11-322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-323"><a href="#cb11-323" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb11-324"><a href="#cb11-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-327"><a href="#cb11-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-328"><a href="#cb11-328" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-329"><a href="#cb11-329" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb11-330"><a href="#cb11-330" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb11-331"><a href="#cb11-331" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb11-332"><a href="#cb11-332" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the start and end date for the 6-month period</span></span>
<span id="cb11-333"><a href="#cb11-333" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2024-05-01"</span>)</span>
<span id="cb11-334"><a href="#cb11-334" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2024-10-31"</span>)</span>
<span id="cb11-335"><a href="#cb11-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-336"><a href="#cb11-336" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate date range</span></span>
<span id="cb11-337"><a href="#cb11-337" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(start_date, </span>
<span id="cb11-338"><a href="#cb11-338" aria-hidden="true" tabindex="-1"></a>                  end_date, </span>
<span id="cb11-339"><a href="#cb11-339" aria-hidden="true" tabindex="-1"></a>                  <span class="at">by =</span> <span class="st">"day"</span>)</span>
<span id="cb11-340"><a href="#cb11-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-341"><a href="#cb11-341" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a random seed for reproducibility</span></span>
<span id="cb11-342"><a href="#cb11-342" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb11-343"><a href="#cb11-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-344"><a href="#cb11-344" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector of weekdays for each date</span></span>
<span id="cb11-345"><a href="#cb11-345" aria-hidden="true" tabindex="-1"></a>weekdays <span class="ot">&lt;-</span> <span class="fu">weekdays</span>(dates)</span>
<span id="cb11-346"><a href="#cb11-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-347"><a href="#cb11-347" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate sales data for Product A, B, and C based on weekday patterns</span></span>
<span id="cb11-348"><a href="#cb11-348" aria-hidden="true" tabindex="-1"></a>product_a_sales <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">50</span>, <span class="fu">length</span>(dates), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-349"><a href="#cb11-349" aria-hidden="true" tabindex="-1"></a>product_b_sales <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">40</span>, <span class="fu">length</span>(dates), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-350"><a href="#cb11-350" aria-hidden="true" tabindex="-1"></a>product_c_sales <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">30</span>, <span class="fu">length</span>(dates), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-351"><a href="#cb11-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-352"><a href="#cb11-352" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust sales based on the weekday</span></span>
<span id="cb11-353"><a href="#cb11-353" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dates)) {</span>
<span id="cb11-354"><a href="#cb11-354" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (weekdays[i] <span class="sc">==</span> <span class="st">"Wednesday"</span> <span class="sc">|</span> weekdays[i] <span class="sc">==</span> <span class="st">"Saturday"</span>) {</span>
<span id="cb11-355"><a href="#cb11-355" aria-hidden="true" tabindex="-1"></a>    <span class="co"># High demand for Product A and B on Wednesday and Saturday</span></span>
<span id="cb11-356"><a href="#cb11-356" aria-hidden="true" tabindex="-1"></a>    product_a_sales[i] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">40</span><span class="sc">:</span><span class="dv">70</span>, <span class="dv">1</span>)</span>
<span id="cb11-357"><a href="#cb11-357" aria-hidden="true" tabindex="-1"></a>    product_b_sales[i] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">30</span><span class="sc">:</span><span class="dv">60</span>, <span class="dv">1</span>)</span>
<span id="cb11-358"><a href="#cb11-358" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (weekdays[i] <span class="sc">==</span> <span class="st">"Monday"</span> <span class="sc">|</span> weekdays[i] <span class="sc">==</span> <span class="st">"Tuesday"</span>) {</span>
<span id="cb11-359"><a href="#cb11-359" aria-hidden="true" tabindex="-1"></a>    <span class="co"># High demand for Product C on Monday and Tuesday</span></span>
<span id="cb11-360"><a href="#cb11-360" aria-hidden="true" tabindex="-1"></a>    product_c_sales[i] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">20</span><span class="sc">:</span><span class="dv">40</span>, <span class="dv">1</span>)</span>
<span id="cb11-361"><a href="#cb11-361" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-362"><a href="#cb11-362" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-363"><a href="#cb11-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-364"><a href="#cb11-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-365"><a href="#cb11-365" aria-hidden="true" tabindex="-1"></a>Thông thường dữ liệu để *train model* trong *machine learning* thường cần trải qua bước *normalize data* nghĩa là đưa tất cả dữ liệu về chung 1 thước đo và phạm vi. Nguyên do vì điều này giúp nhiều thuật toán học máy dễ dàng hội tụ hơn. Ví dụ, các thuật toán như *k-Nearest Neighbors (KNN)* và *Support Vector Machines (SVM)* rất nhạy cảm với khoảng cách giữa các điểm dữ liệu nên nếu dữ liệu không được chuẩn hóa, thuật toán có thể ưu tiên các đặc trưng có phạm vi lớn hơn và bỏ qua các đặc trưng có phạm vi nhỏ hơn, dẫn đến hiệu suất kém. Và công thức phổ biến nhất cho chuẩn hóa là:</span>
<span id="cb11-366"><a href="#cb11-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-367"><a href="#cb11-367" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-368"><a href="#cb11-368" aria-hidden="true" tabindex="-1"></a>\text{Normalized Value} = \frac{x - \min(x)}{\max(x) - \min(x)}</span>
<span id="cb11-369"><a href="#cb11-369" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-370"><a href="#cb11-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-373"><a href="#cb11-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-374"><a href="#cb11-374" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-375"><a href="#cb11-375" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb11-376"><a href="#cb11-376" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with the adjusted sales data</span></span>
<span id="cb11-377"><a href="#cb11-377" aria-hidden="true" tabindex="-1"></a>sales_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-378"><a href="#cb11-378" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> dates,</span>
<span id="cb11-379"><a href="#cb11-379" aria-hidden="true" tabindex="-1"></a>  <span class="at">Weekday =</span> weekdays,</span>
<span id="cb11-380"><a href="#cb11-380" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_A =</span> product_a_sales,</span>
<span id="cb11-381"><a href="#cb11-381" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_B =</span> product_b_sales,</span>
<span id="cb11-382"><a href="#cb11-382" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_C =</span> product_c_sales</span>
<span id="cb11-383"><a href="#cb11-383" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-384"><a href="#cb11-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-385"><a href="#cb11-385" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the sales data to a time series (ts) object for Product A</span></span>
<span id="cb11-386"><a href="#cb11-386" aria-hidden="true" tabindex="-1"></a>product_a_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(sales_data<span class="sc">$</span>Product_A, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2024</span>, <span class="dv">5</span>), </span>
<span id="cb11-387"><a href="#cb11-387" aria-hidden="true" tabindex="-1"></a>                   <span class="at">frequency =</span> <span class="dv">365</span>)</span>
<span id="cb11-388"><a href="#cb11-388" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb11-389"><a href="#cb11-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-390"><a href="#cb11-390" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalzie data:</span></span>
<span id="cb11-391"><a href="#cb11-391" aria-hidden="true" tabindex="-1"></a>time_series_data<span class="ot">&lt;-</span><span class="fu">scale</span>(product_a_ts)</span>
<span id="cb11-392"><a href="#cb11-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-393"><a href="#cb11-393" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(highcharter)</span>
<span id="cb11-394"><a href="#cb11-394" aria-hidden="true" tabindex="-1"></a><span class="fu">highchart</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-395"><a href="#cb11-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_add_series</span>(<span class="at">data =</span> <span class="fu">as.numeric</span>(time_series_data), <span class="at">type =</span> <span class="st">"line"</span>, <span class="at">name =</span> <span class="st">"Sales of Product A"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-396"><a href="#cb11-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Normalized Time Series of Product A"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-397"><a href="#cb11-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_xAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Date"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-398"><a href="#cb11-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Normalized Sales"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-399"><a href="#cb11-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_tooltip</span>(<span class="at">shared =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-400"><a href="#cb11-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_plotOptions</span>(<span class="at">line =</span> <span class="fu">list</span>(<span class="at">marker =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">FALSE</span>)))</span>
<span id="cb11-401"><a href="#cb11-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-402"><a href="#cb11-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-403"><a href="#cb11-403" aria-hidden="true" tabindex="-1"></a><span class="fu">### Chia dữ liệu:</span></span>
<span id="cb11-404"><a href="#cb11-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-405"><a href="#cb11-405" aria-hidden="true" tabindex="-1"></a>Vậy để *train data*, mình sẽ chia bộ dữ liệu thành 3 phần:</span>
<span id="cb11-406"><a href="#cb11-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-407"><a href="#cb11-407" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Training data*: dùng để huấn luyện và xây dựng mô hình.</span>
<span id="cb11-408"><a href="#cb11-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-409"><a href="#cb11-409" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Evaluating data*: đánh giá mô hình vừa huấn luyện.</span>
<span id="cb11-410"><a href="#cb11-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-411"><a href="#cb11-411" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Testing data*: dùng để đánh giá lại nếu muốn mô hình học lại dữ liệu</span>
<span id="cb11-412"><a href="#cb11-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-415"><a href="#cb11-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-416"><a href="#cb11-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-417"><a href="#cb11-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb11-418"><a href="#cb11-418" aria-hidden="true" tabindex="-1"></a>sales_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-419"><a href="#cb11-419" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> dates,</span>
<span id="cb11-420"><a href="#cb11-420" aria-hidden="true" tabindex="-1"></a>  <span class="at">Weekday =</span> weekdays,</span>
<span id="cb11-421"><a href="#cb11-421" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_A =</span> product_a_sales,</span>
<span id="cb11-422"><a href="#cb11-422" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_B =</span> product_b_sales,</span>
<span id="cb11-423"><a href="#cb11-423" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product_C =</span> product_c_sales</span>
<span id="cb11-424"><a href="#cb11-424" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-425"><a href="#cb11-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-426"><a href="#cb11-426" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the sales data to a time series (ts) object for Product A</span></span>
<span id="cb11-427"><a href="#cb11-427" aria-hidden="true" tabindex="-1"></a>time_series_data <span class="ot">&lt;-</span> <span class="fu">scale</span>(<span class="fu">ts</span>(sales_data<span class="sc">$</span>Product_A, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2024</span>, <span class="dv">5</span>), </span>
<span id="cb11-428"><a href="#cb11-428" aria-hidden="true" tabindex="-1"></a>                   <span class="at">frequency =</span> <span class="dv">365</span>))</span>
<span id="cb11-429"><a href="#cb11-429" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb11-430"><a href="#cb11-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-431"><a href="#cb11-431" aria-hidden="true" tabindex="-1"></a>create_supervised_data <span class="ot">&lt;-</span> <span class="cf">function</span>(series, n) {</span>
<span id="cb11-432"><a href="#cb11-432" aria-hidden="true" tabindex="-1"></a>  series <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(series)  <span class="co"># Convert time series object to vector</span></span>
<span id="cb11-433"><a href="#cb11-433" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(series)    <span class="co"># Initialize data frame with the original series</span></span>
<span id="cb11-434"><a href="#cb11-434" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-435"><a href="#cb11-435" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create lag columns</span></span>
<span id="cb11-436"><a href="#cb11-436" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb11-437"><a href="#cb11-437" aria-hidden="true" tabindex="-1"></a>    lagged_column <span class="ot">&lt;-</span> <span class="fu">lag</span>(series, i)  <span class="co"># Get lagged values</span></span>
<span id="cb11-438"><a href="#cb11-438" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data, lagged_column)  <span class="co"># Add lagged column to the data</span></span>
<span id="cb11-439"><a href="#cb11-439" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-440"><a href="#cb11-440" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-441"><a href="#cb11-441" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Name the columns properly</span></span>
<span id="cb11-442"><a href="#cb11-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">'t-'</span>, n<span class="sc">:</span><span class="dv">1</span>), <span class="st">'t+1'</span>)</span>
<span id="cb11-443"><a href="#cb11-443" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-444"><a href="#cb11-444" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove rows with NA values (those at the start of the series due to lagging)</span></span>
<span id="cb11-445"><a href="#cb11-445" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data)</span>
<span id="cb11-446"><a href="#cb11-446" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-447"><a href="#cb11-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb11-448"><a href="#cb11-448" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-449"><a href="#cb11-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-450"><a href="#cb11-450" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data with 12 input lags and 1 output (next time step)</span></span>
<span id="cb11-451"><a href="#cb11-451" aria-hidden="true" tabindex="-1"></a>supervised_data <span class="ot">&lt;-</span> <span class="fu">create_supervised_data</span>(time_series_data,</span>
<span id="cb11-452"><a href="#cb11-452" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">n =</span> <span class="dv">50</span>)</span>
<span id="cb11-453"><a href="#cb11-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-454"><a href="#cb11-454" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Split data into training and test sets</span></span>
<span id="cb11-455"><a href="#cb11-455" aria-hidden="true" tabindex="-1"></a>train_size <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(supervised_data))   <span class="co"># 70% for training</span></span>
<span id="cb11-456"><a href="#cb11-456" aria-hidden="true" tabindex="-1"></a>val_size <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">nrow</span>(supervised_data))     <span class="co"># 10% for validation</span></span>
<span id="cb11-457"><a href="#cb11-457" aria-hidden="true" tabindex="-1"></a>test_size <span class="ot">&lt;-</span> <span class="fu">nrow</span>(supervised_data) <span class="sc">-</span> train_size <span class="sc">-</span> val_size  <span class="co"># 20% for testing</span></span>
<span id="cb11-458"><a href="#cb11-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-459"><a href="#cb11-459" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> supervised_data[<span class="dv">1</span><span class="sc">:</span>train_size, ]</span>
<span id="cb11-460"><a href="#cb11-460" aria-hidden="true" tabindex="-1"></a>val_data <span class="ot">&lt;-</span> supervised_data[(train_size <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(train_size <span class="sc">+</span> val_size), ]</span>
<span id="cb11-461"><a href="#cb11-461" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> supervised_data[(train_size <span class="sc">+</span> val_size <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(supervised_data), ]</span>
<span id="cb11-462"><a href="#cb11-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-463"><a href="#cb11-463" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct column selection</span></span>
<span id="cb11-464"><a href="#cb11-464" aria-hidden="true" tabindex="-1"></a>x_train <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(train_data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>])  <span class="co"># Input features (12 lags)</span></span>
<span id="cb11-465"><a href="#cb11-465" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(train_data[, <span class="st">'t+1'</span>])  <span class="co"># Target output (next time step)</span></span>
<span id="cb11-466"><a href="#cb11-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-467"><a href="#cb11-467" aria-hidden="true" tabindex="-1"></a>x_val <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(val_data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>])  <span class="co"># Input features for validation</span></span>
<span id="cb11-468"><a href="#cb11-468" aria-hidden="true" tabindex="-1"></a>y_val <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(val_data[, <span class="st">'t+1'</span>])  <span class="co"># Actual output for validation</span></span>
<span id="cb11-469"><a href="#cb11-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-470"><a href="#cb11-470" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(test_data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>])  <span class="co"># Input features for testing</span></span>
<span id="cb11-471"><a href="#cb11-471" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(test_data[, <span class="st">'t+1'</span>])  <span class="co"># Actual output for testing</span></span>
<span id="cb11-472"><a href="#cb11-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-473"><a href="#cb11-473" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot the result:</span></span>
<span id="cb11-474"><a href="#cb11-474" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb11-475"><a href="#cb11-475" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">quantile</span>(sales_data<span class="sc">$</span>Date, </span>
<span id="cb11-476"><a href="#cb11-476" aria-hidden="true" tabindex="-1"></a>            <span class="at">probs =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>,<span class="dv">1</span>), </span>
<span id="cb11-477"><a href="#cb11-477" aria-hidden="true" tabindex="-1"></a>            <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb11-478"><a href="#cb11-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-479"><a href="#cb11-479" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span>sales_data <span class="sc">|&gt;</span> </span>
<span id="cb11-480"><a href="#cb11-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&lt;=</span> n[[<span class="dv">2</span>]])</span>
<span id="cb11-481"><a href="#cb11-481" aria-hidden="true" tabindex="-1"></a>m2<span class="ot">&lt;-</span>sales_data <span class="sc">|&gt;</span> </span>
<span id="cb11-482"><a href="#cb11-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&lt;=</span> n[[<span class="dv">3</span>]] <span class="sc">&amp;</span> Date <span class="sc">&gt;</span> n[[<span class="dv">2</span>]])</span>
<span id="cb11-483"><a href="#cb11-483" aria-hidden="true" tabindex="-1"></a>m3<span class="ot">&lt;-</span>sales_data <span class="sc">|&gt;</span> </span>
<span id="cb11-484"><a href="#cb11-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&lt;=</span> n[[<span class="dv">4</span>]] <span class="sc">&amp;</span> Date <span class="sc">&gt;</span> n[[<span class="dv">3</span>]])</span>
<span id="cb11-485"><a href="#cb11-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-486"><a href="#cb11-486" aria-hidden="true" tabindex="-1"></a>demand_training<span class="ot">&lt;-</span><span class="fu">xts</span>(<span class="at">x=</span>m1<span class="sc">$</span>Product_A,</span>
<span id="cb11-487"><a href="#cb11-487" aria-hidden="true" tabindex="-1"></a>                     <span class="at">order.by=</span>m1<span class="sc">$</span>Date)</span>
<span id="cb11-488"><a href="#cb11-488" aria-hidden="true" tabindex="-1"></a>demand_testing<span class="ot">&lt;-</span><span class="fu">xts</span>(<span class="at">x=</span>m2<span class="sc">$</span>Product_A,</span>
<span id="cb11-489"><a href="#cb11-489" aria-hidden="true" tabindex="-1"></a>                     <span class="at">order.by=</span>m2<span class="sc">$</span>Date)</span>
<span id="cb11-490"><a href="#cb11-490" aria-hidden="true" tabindex="-1"></a>demand_forecasting<span class="ot">&lt;-</span><span class="fu">xts</span>(<span class="at">x=</span>m3<span class="sc">$</span>Product_A,</span>
<span id="cb11-491"><a href="#cb11-491" aria-hidden="true" tabindex="-1"></a>                     <span class="at">order.by=</span>m3<span class="sc">$</span>Date)</span>
<span id="cb11-492"><a href="#cb11-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-493"><a href="#cb11-493" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dygraphs)</span>
<span id="cb11-494"><a href="#cb11-494" aria-hidden="true" tabindex="-1"></a>lines<span class="ot">&lt;-</span><span class="fu">cbind</span>(demand_training,</span>
<span id="cb11-495"><a href="#cb11-495" aria-hidden="true" tabindex="-1"></a>             demand_testing,</span>
<span id="cb11-496"><a href="#cb11-496" aria-hidden="true" tabindex="-1"></a>             demand_forecasting)</span>
<span id="cb11-497"><a href="#cb11-497" aria-hidden="true" tabindex="-1"></a><span class="fu">dygraph</span>(lines,</span>
<span id="cb11-498"><a href="#cb11-498" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Training and testing data"</span>, </span>
<span id="cb11-499"><a href="#cb11-499" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Quantity order (Unit: Millions)"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-500"><a href="#cb11-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"demand_training"</span>, <span class="at">label =</span> <span class="st">"Training data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-501"><a href="#cb11-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"demand_testing"</span>, <span class="at">label =</span> <span class="st">"Testing data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-502"><a href="#cb11-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"demand_forecasting"</span>, <span class="at">label =</span> <span class="st">"Forecasting data"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-503"><a href="#cb11-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyOptions</span>(<span class="at">fillGraph =</span> <span class="cn">TRUE</span>, <span class="at">fillAlpha =</span> <span class="fl">0.4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-504"><a href="#cb11-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyRangeSelector</span>(<span class="at">height =</span> <span class="dv">20</span>)</span>
<span id="cb11-505"><a href="#cb11-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-506"><a href="#cb11-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-507"><a href="#cb11-507" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mô hình RNN:</span></span>
<span id="cb11-508"><a href="#cb11-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-509"><a href="#cb11-509" aria-hidden="true" tabindex="-1"></a>Sau đó, ta sẽ bắt đầu *train model* bằng cách tạo thêm 12 cột giá trị là giá trị quá khứ của *demand*. Bạn sẽ bắt đầu định nghĩa mô hình gồm:</span>
<span id="cb11-510"><a href="#cb11-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-511"><a href="#cb11-511" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Input*: dùng hàm `layer_input(shape = input_shape)` với `input_shape` là số lượng *predictor*.</span>
<span id="cb11-512"><a href="#cb11-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-513"><a href="#cb11-513" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Layer*: là các hidden layer trong mô hình thêm vào bằng hàm <span class="in">`layer_dense(x, units = 64, activation = 'relu')`</span> với đối số <span class="in">`units`</span> thường là bội số của 32 như 32,64,256,...</span>
<span id="cb11-514"><a href="#cb11-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-515"><a href="#cb11-515" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Output*: dùng hàm <span class="in">`layer_dense(x, units = 1)`</span> để định nghĩa là đầu ra chỉ có 1 giá trị.</span>
<span id="cb11-516"><a href="#cb11-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-519"><a href="#cb11-519" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-520"><a href="#cb11-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-521"><a href="#cb11-521" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb11-522"><a href="#cb11-522" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb11-523"><a href="#cb11-523" aria-hidden="true" tabindex="-1"></a><span class="fu">use_python</span>(<span class="st">"C:/Users/locca/AppData/Local/Programs/Python/Python310/python.exe"</span>, <span class="at">required =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-524"><a href="#cb11-524" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to build the RNN model with Simple RNN</span></span>
<span id="cb11-525"><a href="#cb11-525" aria-hidden="true" tabindex="-1"></a>RNN_model <span class="ot">&lt;-</span> <span class="cf">function</span>(input_shape) {</span>
<span id="cb11-526"><a href="#cb11-526" aria-hidden="true" tabindex="-1"></a>  inputs <span class="ot">&lt;-</span> <span class="fu">layer_input</span>(<span class="at">shape =</span> input_shape)</span>
<span id="cb11-527"><a href="#cb11-527" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-528"><a href="#cb11-528" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simple RNN layer</span></span>
<span id="cb11-529"><a href="#cb11-529" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> inputs</span>
<span id="cb11-530"><a href="#cb11-530" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">layer_simple_rnn</span>(x, <span class="at">units =</span> <span class="dv">64</span>, <span class="at">activation =</span> <span class="st">'tanh'</span>, <span class="at">return_sequences =</span> <span class="cn">TRUE</span>)  <span class="co"># First RNN layer</span></span>
<span id="cb11-531"><a href="#cb11-531" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">layer_simple_rnn</span>(x, <span class="at">units =</span> <span class="dv">128</span>, <span class="at">activation =</span> <span class="st">'tanh'</span>)  <span class="co"># Second RNN layer</span></span>
<span id="cb11-532"><a href="#cb11-532" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-533"><a href="#cb11-533" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dense layers after RNN layers</span></span>
<span id="cb11-534"><a href="#cb11-534" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">layer_dense</span>(x, <span class="at">units =</span> <span class="dv">128</span>, <span class="at">activation =</span> <span class="st">'relu'</span>)  <span class="co"># Dense layer</span></span>
<span id="cb11-535"><a href="#cb11-535" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">layer_dense</span>(x, <span class="at">units =</span> <span class="dv">64</span>, <span class="at">activation =</span> <span class="st">'relu'</span>)   <span class="co"># Another dense layer</span></span>
<span id="cb11-536"><a href="#cb11-536" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-537"><a href="#cb11-537" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Output layer (for regression)</span></span>
<span id="cb11-538"><a href="#cb11-538" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">layer_dense</span>(x, <span class="at">units =</span> <span class="dv">1</span>)  <span class="co"># Single output (next time step value)</span></span>
<span id="cb11-539"><a href="#cb11-539" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-540"><a href="#cb11-540" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">keras_model</span>(inputs, x)</span>
<span id="cb11-541"><a href="#cb11-541" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-542"><a href="#cb11-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(model)</span>
<span id="cb11-543"><a href="#cb11-543" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-544"><a href="#cb11-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-545"><a href="#cb11-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-546"><a href="#cb11-546" aria-hidden="true" tabindex="-1"></a><span class="co"># Example input shape (12 time steps input per sample)</span></span>
<span id="cb11-547"><a href="#cb11-547" aria-hidden="true" tabindex="-1"></a>input_shape <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">1</span>)</span>
<span id="cb11-548"><a href="#cb11-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-549"><a href="#cb11-549" aria-hidden="true" tabindex="-1"></a>RNN_model <span class="ot">&lt;-</span> <span class="fu">RNN_model</span>(input_shape)</span>
<span id="cb11-550"><a href="#cb11-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-551"><a href="#cb11-551" aria-hidden="true" tabindex="-1"></a>RNN_model <span class="sc">|&gt;</span> <span class="fu">compile</span>(</span>
<span id="cb11-552"><a href="#cb11-552" aria-hidden="true" tabindex="-1"></a>  <span class="at">loss =</span> <span class="st">'mse'</span>,</span>
<span id="cb11-553"><a href="#cb11-553" aria-hidden="true" tabindex="-1"></a>  <span class="at">optimizer =</span> <span class="fu">optimizer_adam</span>(),</span>
<span id="cb11-554"><a href="#cb11-554" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">c</span>(<span class="st">'mae'</span>)</span>
<span id="cb11-555"><a href="#cb11-555" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-556"><a href="#cb11-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-557"><a href="#cb11-557" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Train the model</span></span>
<span id="cb11-558"><a href="#cb11-558" aria-hidden="true" tabindex="-1"></a>RNN_history <span class="ot">&lt;-</span> RNN_model <span class="sc">|&gt;</span> <span class="fu">fit</span>(</span>
<span id="cb11-559"><a href="#cb11-559" aria-hidden="true" tabindex="-1"></a>  x_train, </span>
<span id="cb11-560"><a href="#cb11-560" aria-hidden="true" tabindex="-1"></a>  y_train,</span>
<span id="cb11-561"><a href="#cb11-561" aria-hidden="true" tabindex="-1"></a>  <span class="at">epochs =</span> <span class="dv">50</span>, </span>
<span id="cb11-562"><a href="#cb11-562" aria-hidden="true" tabindex="-1"></a>  <span class="at">batch_size =</span> <span class="dv">32</span>,</span>
<span id="cb11-563"><a href="#cb11-563" aria-hidden="true" tabindex="-1"></a>  <span class="at">validation_data =</span> <span class="fu">list</span>(x_val, y_val)</span>
<span id="cb11-564"><a href="#cb11-564" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-565"><a href="#cb11-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-566"><a href="#cb11-566" aria-hidden="true" tabindex="-1"></a>RNN_result <span class="ot">&lt;-</span> RNN_model <span class="sc">|&gt;</span> </span>
<span id="cb11-567"><a href="#cb11-567" aria-hidden="true" tabindex="-1"></a>    <span class="fu">evaluate</span>(x_test, y_test)</span>
<span id="cb11-568"><a href="#cb11-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-569"><a href="#cb11-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-570"><a href="#cb11-570" aria-hidden="true" tabindex="-1"></a>Đối với các mô hình truyền thống như *linear regression* thì bạn đã quen với thông số $R^2$ để đánh giá mô hình, còn với mô hình *Machine learning* thì dùng khái niệm *loss function - hàm mất mát*. Về khái niệm, *loss function* sẽ đo lường chênh lệch giữa *predicted* và *actual* trong bộ *training data* nên khi càng tăng `epochs` nghĩa là tăng số lần học lại dữ liệu thì *loss function* sẽ tính ra giá trị càng thấp. Như mô hình trên thì mình đặt đối số `loss = mse` nghĩa là sử dụng *Mean Squared Error* để tối ưu quy trình học của học máy. Công thức như sau:</span>
<span id="cb11-571"><a href="#cb11-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-572"><a href="#cb11-572" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-573"><a href="#cb11-573" aria-hidden="true" tabindex="-1"></a>MSE = \frac{1}{n} \sum_{i=1}^{n} (y_{\text{pred}}(i) - y_{\text{true}}(i))^2</span>
<span id="cb11-574"><a href="#cb11-574" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-575"><a href="#cb11-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-576"><a href="#cb11-576" aria-hidden="true" tabindex="-1"></a>Còn đối số <span class="in">`metrics = c('mae')`</span> nghĩa là tiêu chí khác để theo dõi và đánh giá mô hình. Vậy tại sao cần có 2 tham số đánh giá song song như vậy là vì như đã nói, nếu bạn càng tăng <span class="in">`epochs`</span> thì giá trị *loss* càng thấp trong khi dùng <span class="in">`metrics`</span> sẽ đưa ra đánh giá khách quan hơn về mô hình mà không phụ thuộc vào số lần <span class="in">`epochs`</span>. Công thức như sau:</span>
<span id="cb11-577"><a href="#cb11-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-578"><a href="#cb11-578" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-579"><a href="#cb11-579" aria-hidden="true" tabindex="-1"></a>\text{MAE} = \frac{1}{n} \sum_{i=1}^{n} |y_{\text{pred}}(i) - y_{\text{true}}(i)|</span>
<span id="cb11-580"><a href="#cb11-580" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-581"><a href="#cb11-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-582"><a href="#cb11-582" aria-hidden="true" tabindex="-1"></a>Vậy khi chạy code, R sẽ return output như biểu đồ dưới đây là so sánh tham số của *mse* và *mae* giữa *training data* và *evaluating data*. Ý tưởng là đánh giá thử mô hình có dự đoán tốt không khi có dữ liệu mới vào.</span>
<span id="cb11-583"><a href="#cb11-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-584"><a href="#cb11-584" aria-hidden="true" tabindex="-1"></a>Tiếp theo, ta sẽ dùng *test data* để đánh giá mô hình vừa xây dựng. Kết quả có vẻ khá ổn vì mô hình gần như theo sát được dữ liệu của *test data*.</span>
<span id="cb11-585"><a href="#cb11-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-588"><a href="#cb11-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-589"><a href="#cb11-589" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Make predictions</span></span>
<span id="cb11-590"><a href="#cb11-590" aria-hidden="true" tabindex="-1"></a>RNN_forecast <span class="ot">&lt;-</span> RNN_model <span class="sc">|&gt;</span> </span>
<span id="cb11-591"><a href="#cb11-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(x_test)</span>
<span id="cb11-592"><a href="#cb11-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-593"><a href="#cb11-593" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Combine predicted and observed</span></span>
<span id="cb11-594"><a href="#cb11-594" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-595"><a href="#cb11-595" aria-hidden="true" tabindex="-1"></a>  <span class="at">actual =</span> y_test,  <span class="co"># Actual values from the test set</span></span>
<span id="cb11-596"><a href="#cb11-596" aria-hidden="true" tabindex="-1"></a>  <span class="at">forecast =</span> RNN_forecast  <span class="co"># Forecasted values</span></span>
<span id="cb11-597"><a href="#cb11-597" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-598"><a href="#cb11-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-599"><a href="#cb11-599" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 8: Plot using Highcharts</span></span>
<span id="cb11-600"><a href="#cb11-600" aria-hidden="true" tabindex="-1"></a><span class="fu">highchart</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-601"><a href="#cb11-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Time Series Forecasting with Highcharts"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-602"><a href="#cb11-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_xAxis</span>(</span>
<span id="cb11-603"><a href="#cb11-603" aria-hidden="true" tabindex="-1"></a>    <span class="at">categories =</span> plot_data<span class="sc">$</span>time,</span>
<span id="cb11-604"><a href="#cb11-604" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Time"</span>)</span>
<span id="cb11-605"><a href="#cb11-605" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-606"><a href="#cb11-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(</span>
<span id="cb11-607"><a href="#cb11-607" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Value"</span>),</span>
<span id="cb11-608"><a href="#cb11-608" aria-hidden="true" tabindex="-1"></a>    <span class="at">plotLines =</span> <span class="fu">list</span>(<span class="fu">list</span>(</span>
<span id="cb11-609"><a href="#cb11-609" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="dv">0</span>,</span>
<span id="cb11-610"><a href="#cb11-610" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">1</span>,</span>
<span id="cb11-611"><a href="#cb11-611" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"gray"</span></span>
<span id="cb11-612"><a href="#cb11-612" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb11-613"><a href="#cb11-613" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-614"><a href="#cb11-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_add_series</span>(</span>
<span id="cb11-615"><a href="#cb11-615" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Actual Data"</span>,</span>
<span id="cb11-616"><a href="#cb11-616" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> plot_data<span class="sc">$</span>actual,</span>
<span id="cb11-617"><a href="#cb11-617" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"line"</span>,</span>
<span id="cb11-618"><a href="#cb11-618" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#1f77b4"</span>  <span class="co"># Blue color for actual data</span></span>
<span id="cb11-619"><a href="#cb11-619" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-620"><a href="#cb11-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_add_series</span>(</span>
<span id="cb11-621"><a href="#cb11-621" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Forecast"</span>,</span>
<span id="cb11-622"><a href="#cb11-622" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> plot_data<span class="sc">$</span>forecast,</span>
<span id="cb11-623"><a href="#cb11-623" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"line"</span>,</span>
<span id="cb11-624"><a href="#cb11-624" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#ff7f0e"</span>  <span class="co"># Orange color for forecast data</span></span>
<span id="cb11-625"><a href="#cb11-625" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-626"><a href="#cb11-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_tooltip</span>(</span>
<span id="cb11-627"><a href="#cb11-627" aria-hidden="true" tabindex="-1"></a>    <span class="at">shared =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-628"><a href="#cb11-628" aria-hidden="true" tabindex="-1"></a>    <span class="at">crosshairs =</span> <span class="cn">TRUE</span></span>
<span id="cb11-629"><a href="#cb11-629" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-630"><a href="#cb11-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_legend</span>(</span>
<span id="cb11-631"><a href="#cb11-631" aria-hidden="true" tabindex="-1"></a>    <span class="at">enabled =</span> <span class="cn">TRUE</span></span>
<span id="cb11-632"><a href="#cb11-632" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-633"><a href="#cb11-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-634"><a href="#cb11-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-635"><a href="#cb11-635" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mô hình LSTM:</span></span>
<span id="cb11-636"><a href="#cb11-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-637"><a href="#cb11-637" aria-hidden="true" tabindex="-1"></a>Tiếp theo, ta sẽ xây dựng thử mô hình *LSTM*. Mô hình LSTM thường bao gồm các lớp sau:</span>
<span id="cb11-638"><a href="#cb11-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-639"><a href="#cb11-639" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Lớp LSTM: Đây là lớp chính, có thể có một hoặc nhiều lớp LSTM chồng lên nhau. Mỗi lớp LSTM có thể trả về toàn bộ chuỗi bằng <span class="in">`return_sequences = TRUE`</span> hoặc chỉ trả về giá trị cuối cùng bằng <span class="in">`return_sequences = FALSE`</span>.</span>
<span id="cb11-640"><a href="#cb11-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-641"><a href="#cb11-641" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Lớp Dense: Sau khi thông tin được xử lý qua các lớp LSTM, nó sẽ được đưa qua các lớp Dense (lớp fully connected) để đưa ra dự đoán cuối cùng.</span>
<span id="cb11-642"><a href="#cb11-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-643"><a href="#cb11-643" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Lớp Dropout (tùy chọn): Để tránh overfitting, có thể thêm lớp dropout để tắt ngẫu nhiên một số nơ-ron trong quá trình huấn luyện.</span>
<span id="cb11-644"><a href="#cb11-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-647"><a href="#cb11-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-648"><a href="#cb11-648" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-649"><a href="#cb11-649" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb11-650"><a href="#cb11-650" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb11-651"><a href="#cb11-651" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb11-652"><a href="#cb11-652" aria-hidden="true" tabindex="-1"></a>LSTM_model <span class="ot">&lt;-</span> <span class="fu">keras_model_sequential</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-653"><a href="#cb11-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_lstm</span>(<span class="at">units =</span> <span class="dv">64</span>, </span>
<span id="cb11-654"><a href="#cb11-654" aria-hidden="true" tabindex="-1"></a>             <span class="at">input_shape =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">1</span>), </span>
<span id="cb11-655"><a href="#cb11-655" aria-hidden="true" tabindex="-1"></a>             <span class="at">return_sequences =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-656"><a href="#cb11-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dropout</span>(<span class="at">rate =</span> <span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-657"><a href="#cb11-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_lstm</span>(<span class="at">units =</span> <span class="dv">32</span>, <span class="at">return_sequences =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-658"><a href="#cb11-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dropout</span>(<span class="at">rate =</span> <span class="fl">0.3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-659"><a href="#cb11-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">32</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-660"><a href="#cb11-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dropout</span>(<span class="at">rate =</span> <span class="fl">0.2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-661"><a href="#cb11-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">1</span>)</span>
<span id="cb11-662"><a href="#cb11-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-663"><a href="#cb11-663" aria-hidden="true" tabindex="-1"></a>early_stop <span class="ot">&lt;-</span> <span class="fu">callback_early_stopping</span>(<span class="at">monitor =</span> <span class="st">"val_loss"</span>, <span class="at">patience =</span> <span class="dv">10</span>, <span class="at">restore_best_weights =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-664"><a href="#cb11-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-665"><a href="#cb11-665" aria-hidden="true" tabindex="-1"></a>model_checkpoint <span class="ot">&lt;-</span> <span class="fu">callback_model_checkpoint</span>(<span class="st">"best_model.keras"</span>, <span class="at">save_best_only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-666"><a href="#cb11-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-667"><a href="#cb11-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-668"><a href="#cb11-668" aria-hidden="true" tabindex="-1"></a>lr_scheduler <span class="ot">&lt;-</span> <span class="fu">callback_learning_rate_scheduler</span>(<span class="cf">function</span>(epoch, lr) {</span>
<span id="cb11-669"><a href="#cb11-669" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (epoch <span class="sc">&gt;</span> <span class="dv">10</span>) {</span>
<span id="cb11-670"><a href="#cb11-670" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(lr <span class="sc">*</span> <span class="fl">0.5</span>)  <span class="co"># Reduce learning rate after epoch 10</span></span>
<span id="cb11-671"><a href="#cb11-671" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-672"><a href="#cb11-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lr)</span>
<span id="cb11-673"><a href="#cb11-673" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-674"><a href="#cb11-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-675"><a href="#cb11-675" aria-hidden="true" tabindex="-1"></a>LSTM_model <span class="sc">|&gt;</span> <span class="fu">compile</span>(</span>
<span id="cb11-676"><a href="#cb11-676" aria-hidden="true" tabindex="-1"></a>  <span class="at">loss =</span> <span class="st">'mse'</span>,</span>
<span id="cb11-677"><a href="#cb11-677" aria-hidden="true" tabindex="-1"></a>  <span class="at">optimizer =</span> <span class="fu">optimizer_adam</span>(<span class="at">learning_rate =</span> <span class="fl">0.001</span>),</span>
<span id="cb11-678"><a href="#cb11-678" aria-hidden="true" tabindex="-1"></a>  <span class="at">metrics =</span> <span class="fu">c</span>(<span class="st">'mae'</span>)</span>
<span id="cb11-679"><a href="#cb11-679" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-680"><a href="#cb11-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-681"><a href="#cb11-681" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the input data for LSTM (add a feature dimension)</span></span>
<span id="cb11-682"><a href="#cb11-682" aria-hidden="true" tabindex="-1"></a>x_train <span class="ot">&lt;-</span> <span class="fu">array_reshape</span>(x_train, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">nrow</span>(x_train), <span class="dv">50</span>, <span class="dv">1</span>))</span>
<span id="cb11-683"><a href="#cb11-683" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> <span class="fu">array_reshape</span>(x_test, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">nrow</span>(x_test), <span class="dv">50</span>, <span class="dv">1</span>))</span>
<span id="cb11-684"><a href="#cb11-684" aria-hidden="true" tabindex="-1"></a>x_val <span class="ot">&lt;-</span> <span class="fu">array_reshape</span>(x_val, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">nrow</span>(x_val), <span class="dv">50</span>, <span class="dv">1</span>))</span>
<span id="cb11-685"><a href="#cb11-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-686"><a href="#cb11-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-687"><a href="#cb11-687" aria-hidden="true" tabindex="-1"></a>LSTM_model <span class="sc">%&gt;%</span></span>
<span id="cb11-688"><a href="#cb11-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(x_train, </span>
<span id="cb11-689"><a href="#cb11-689" aria-hidden="true" tabindex="-1"></a>      y_train, </span>
<span id="cb11-690"><a href="#cb11-690" aria-hidden="true" tabindex="-1"></a>      <span class="at">epochs =</span> <span class="dv">100</span>, </span>
<span id="cb11-691"><a href="#cb11-691" aria-hidden="true" tabindex="-1"></a>      <span class="at">batch_size =</span> <span class="dv">32</span>, </span>
<span id="cb11-692"><a href="#cb11-692" aria-hidden="true" tabindex="-1"></a>      <span class="at">validation_data =</span> <span class="fu">list</span>(x_val, y_val),</span>
<span id="cb11-693"><a href="#cb11-693" aria-hidden="true" tabindex="-1"></a>      <span class="at">callbacks =</span> <span class="fu">list</span>(early_stop, model_checkpoint, lr_scheduler))</span>
<span id="cb11-694"><a href="#cb11-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-695"><a href="#cb11-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-696"><a href="#cb11-696" aria-hidden="true" tabindex="-1"></a>LSTM_result <span class="ot">&lt;-</span> LSTM_model <span class="sc">|&gt;</span> </span>
<span id="cb11-697"><a href="#cb11-697" aria-hidden="true" tabindex="-1"></a>    <span class="fu">evaluate</span>(x_test, y_test)</span>
<span id="cb11-698"><a href="#cb11-698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-699"><a href="#cb11-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-700"><a href="#cb11-700" aria-hidden="true" tabindex="-1"></a>Vậy giờ ta sẽ so sánh với mô hình *RNN* trước với mô hình *LSTM* qua 2 thông số đã chọn *mse* và *mae*.</span>
<span id="cb11-701"><a href="#cb11-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-704"><a href="#cb11-704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-705"><a href="#cb11-705" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb11-706"><a href="#cb11-706" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb11-707"><a href="#cb11-707" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract metrics into a data frame</span></span>
<span id="cb11-708"><a href="#cb11-708" aria-hidden="true" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-709"><a href="#cb11-709" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"RNN"</span>, <span class="st">"LSTM"</span>),</span>
<span id="cb11-710"><a href="#cb11-710" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE =</span> <span class="fu">c</span>(RNN_result[[<span class="dv">1</span>]],RNN_result[[<span class="dv">2</span>]]),</span>
<span id="cb11-711"><a href="#cb11-711" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE =</span> <span class="fu">c</span>(LSTM_result[[<span class="dv">1</span>]], LSTM_result[[<span class="dv">2</span>]])</span>
<span id="cb11-712"><a href="#cb11-712" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-713"><a href="#cb11-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-714"><a href="#cb11-714" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb11-715"><a href="#cb11-715" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a gt table</span></span>
<span id="cb11-716"><a href="#cb11-716" aria-hidden="true" tabindex="-1"></a>results_df <span class="sc">|&gt;</span></span>
<span id="cb11-717"><a href="#cb11-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-718"><a href="#cb11-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb11-719"><a href="#cb11-719" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Performance Metrics"</span>,</span>
<span id="cb11-720"><a href="#cb11-720" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Comparison of MSE and MAE for RNN and LSTM"</span></span>
<span id="cb11-721"><a href="#cb11-721" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-722"><a href="#cb11-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb11-723"><a href="#cb11-723" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">vars</span>(MSE, MAE),</span>
<span id="cb11-724"><a href="#cb11-724" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">6</span></span>
<span id="cb11-725"><a href="#cb11-725" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-726"><a href="#cb11-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb11-727"><a href="#cb11-727" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model =</span> <span class="st">"Model Type"</span>,</span>
<span id="cb11-728"><a href="#cb11-728" aria-hidden="true" tabindex="-1"></a>    <span class="at">MSE =</span> <span class="st">"Mean Squared Error"</span>,</span>
<span id="cb11-729"><a href="#cb11-729" aria-hidden="true" tabindex="-1"></a>    <span class="at">MAE =</span> <span class="st">"Mean Absolute Error"</span></span>
<span id="cb11-730"><a href="#cb11-730" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-731"><a href="#cb11-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb11-732"><a href="#cb11-732" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="dv">14</span>,</span>
<span id="cb11-733"><a href="#cb11-733" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.title.font.size =</span> <span class="dv">16</span>,</span>
<span id="cb11-734"><a href="#cb11-734" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.subtitle.font.size =</span> <span class="dv">14</span></span>
<span id="cb11-735"><a href="#cb11-735" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-736"><a href="#cb11-736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-737"><a href="#cb11-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-738"><a href="#cb11-738" aria-hidden="true" tabindex="-1"></a>Kết quả cho thấy mô hình *LSTM* đưa ra kết quả tốt hơn *RNN* với độ sai số thấp hơn nhưng nếu bạn để ý thì thấy trong biểu đồ mình vẫn để % âm để dễ phân biệt giữa việc *outstock* và *high inventory* (bởi vì bạn đang dự báo cho nhu cầu của khách hàng). Bạn có thể so sánh thêm 1 bước nữa về tổng chi phí giữa 2 mô hình về *outstock* và *holding cost* để có cái nhìn tổng quan nhất.</span>
<span id="cb11-739"><a href="#cb11-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-742"><a href="#cb11-742" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-743"><a href="#cb11-743" aria-hidden="true" tabindex="-1"></a>LSTM_forecast <span class="ot">&lt;-</span> LSTM_model <span class="sc">|&gt;</span> </span>
<span id="cb11-744"><a href="#cb11-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(x_test)</span>
<span id="cb11-745"><a href="#cb11-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-746"><a href="#cb11-746" aria-hidden="true" tabindex="-1"></a>compare<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Date =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y_test),</span>
<span id="cb11-747"><a href="#cb11-747" aria-hidden="true" tabindex="-1"></a>                    <span class="at">LSTM =</span> <span class="fu">round</span>((LSTM_forecast <span class="sc">-</span> y_test)<span class="sc">/</span>y_test,<span class="dv">3</span>),</span>
<span id="cb11-748"><a href="#cb11-748" aria-hidden="true" tabindex="-1"></a>                    <span class="at">RNN =</span> <span class="fu">round</span>((RNN_forecast <span class="sc">-</span> y_test)<span class="sc">/</span>y_test,<span class="dv">3</span>)</span>
<span id="cb11-749"><a href="#cb11-749" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-750"><a href="#cb11-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-751"><a href="#cb11-751" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the highchart plot with percentage formatting for y-axis</span></span>
<span id="cb11-752"><a href="#cb11-752" aria-hidden="true" tabindex="-1"></a><span class="fu">highchart</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-753"><a href="#cb11-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_chart</span>(<span class="at">type =</span> <span class="st">"line"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-754"><a href="#cb11-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Residual Comparison: LSTM vs RNN"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-755"><a href="#cb11-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_xAxis</span>(</span>
<span id="cb11-756"><a href="#cb11-756" aria-hidden="true" tabindex="-1"></a>    <span class="at">categories =</span> compare<span class="sc">$</span>Date,</span>
<span id="cb11-757"><a href="#cb11-757" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Date"</span>)</span>
<span id="cb11-758"><a href="#cb11-758" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-759"><a href="#cb11-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(</span>
<span id="cb11-760"><a href="#cb11-760" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Residuals"</span>),</span>
<span id="cb11-761"><a href="#cb11-761" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">list</span>(</span>
<span id="cb11-762"><a href="#cb11-762" aria-hidden="true" tabindex="-1"></a>      <span class="at">formatter =</span> <span class="fu">JS</span>(<span class="st">"function() { return (this.value).toFixed(0) + '%'; }"</span>)  <span class="co"># Format labels as percentages</span></span>
<span id="cb11-763"><a href="#cb11-763" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-764"><a href="#cb11-764" aria-hidden="true" tabindex="-1"></a>    <span class="at">plotLines =</span> <span class="fu">list</span>(</span>
<span id="cb11-765"><a href="#cb11-765" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">value =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">dashStyle =</span> <span class="st">"Dash"</span>)</span>
<span id="cb11-766"><a href="#cb11-766" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-767"><a href="#cb11-767" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-768"><a href="#cb11-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_add_series</span>(</span>
<span id="cb11-769"><a href="#cb11-769" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"LSTM Residuals"</span>,</span>
<span id="cb11-770"><a href="#cb11-770" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> compare<span class="sc">$</span>LSTM,</span>
<span id="cb11-771"><a href="#cb11-771" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#1f77b4"</span></span>
<span id="cb11-772"><a href="#cb11-772" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-773"><a href="#cb11-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_add_series</span>(</span>
<span id="cb11-774"><a href="#cb11-774" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"RNN Residuals"</span>,</span>
<span id="cb11-775"><a href="#cb11-775" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> compare<span class="sc">$</span>RNN,</span>
<span id="cb11-776"><a href="#cb11-776" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#ff7f0e"</span></span>
<span id="cb11-777"><a href="#cb11-777" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-778"><a href="#cb11-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_tooltip</span>(<span class="at">shared =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-779"><a href="#cb11-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_legend</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-780"><a href="#cb11-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-781"><a href="#cb11-781" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-782"><a href="#cb11-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-783"><a href="#cb11-783" aria-hidden="true" tabindex="-1"></a><span class="fu">### Xác định cấu trúc mô hình:</span></span>
<span id="cb11-784"><a href="#cb11-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-785"><a href="#cb11-785" aria-hidden="true" tabindex="-1"></a>Nếu bạn để ý, thực chất code cho mô hình cho như mình đã trình bày thì khá đơn giản và điều khó nhất trong mô hình là xác định số lớp *layer* trong mô hình. Như bài toán *time series forecasting* thì mình chỉ cần 2,3 lớp layer đơn giản là đã đạt kết quả tốt với sai số rất thấp (\&lt; 0.03), còn với các bài toán phức tạp hơn thì số *layer* sẽ nhiều hơn.</span>
<span id="cb11-786"><a href="#cb11-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-787"><a href="#cb11-787" aria-hidden="true" tabindex="-1"></a>Vậy quy tắc xác định mô hình là như thế nào ? Câu trả lời là **không có quy tắc nào cả** và chỉ có các tips mà mình lụm nhặt trên mạng như sau:</span>
<span id="cb11-788"><a href="#cb11-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-789"><a href="#cb11-789" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Number of layer:</span></span>
<span id="cb11-790"><a href="#cb11-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-791"><a href="#cb11-791" aria-hidden="true" tabindex="-1"></a>Số *layer* nên nằm giữa số input và số output. Như bài thực hành trên thì số *layer* nên nằm trong khoảng (1,12). Hoặc bạn có thể sử dụng hàm dưới đây để xác định.</span>
<span id="cb11-792"><a href="#cb11-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-793"><a href="#cb11-793" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-794"><a href="#cb11-794" aria-hidden="true" tabindex="-1"></a>N_h = \frac{N_s}{\alpha \cdot (N_i + N_o)}</span>
<span id="cb11-795"><a href="#cb11-795" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-796"><a href="#cb11-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-797"><a href="#cb11-797" aria-hidden="true" tabindex="-1"></a>Với các tham số gồm:</span>
<span id="cb11-798"><a href="#cb11-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-799"><a href="#cb11-799" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>$N_h$ là số lượng *hidden neurons*.</span>
<span id="cb11-800"><a href="#cb11-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-801"><a href="#cb11-801" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>$N_s$ là số lượng mẫu trong *training data*.</span>
<span id="cb11-802"><a href="#cb11-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-803"><a href="#cb11-803" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>$\alpha$ là yếu tố tỷ lệ tùy ý (thường từ 2-10).</span>
<span id="cb11-804"><a href="#cb11-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-805"><a href="#cb11-805" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>$N_i$ là số lượng nơ-ron input</span>
<span id="cb11-806"><a href="#cb11-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-807"><a href="#cb11-807" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>$N_o$ là số lượng nơ-ron output.</span>
<span id="cb11-808"><a href="#cb11-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-809"><a href="#cb11-809" aria-hidden="true" tabindex="-1"></a>Ví dụ như ở mô hình trên thì số *hidden layer* sẽ khoảng 1-4 layer là ổn (Như trên thì mình dùng 1 layer cho mô hình RNN, 2 layer cho mô hình LSTM)</span>
<span id="cb11-810"><a href="#cb11-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-811"><a href="#cb11-811" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Choose acvtivation function:</span></span>
<span id="cb11-812"><a href="#cb11-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-813"><a href="#cb11-813" aria-hidden="true" tabindex="-1"></a>Các hàm *activation* dùng để tính *weighted sum* và mỗi *layer* sẽ cần có 1 hoặc nhiều hàm để tính. Việc lựa chọn hàm ảnh hưởng lớn đến *performance* của mô hình, thường sẽ được chia thành 3 phần là:</span>
<span id="cb11-814"><a href="#cb11-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-815"><a href="#cb11-815" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>*Activation for input layer*: thường ko dùng hàm gì cả. Bạn chỉ thực hiện *processing* dữ liệu để training.</span>
<span id="cb11-816"><a href="#cb11-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-817"><a href="#cb11-817" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>*Activation for Hidden Layers*:</span>
<span id="cb11-818"><a href="#cb11-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-819"><a href="#cb11-819" aria-hidden="true" tabindex="-1"></a>Thông thường, hàm **Tanh** thì phù hợp cho dự báo giá trị liên tục từ dữ liệu chuỗi, **ReLU** giúp cho quá trình training nhanh hơn và không gây ra *vanishing problem* do không bị chặn, **Softmax** thường dùng ở *output layer* cho bài toán classification, **Sigmoid** thường dùng cho hồi quy logic. Ngoài ra, cách đơn giản hơn là tùy vào loại mô hình bạn đang xây dựng để lựa chọn, ví dụ như tips dưới đây mình tìm hiểu được:</span>
<span id="cb11-820"><a href="#cb11-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-821"><a href="#cb11-821" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb11-822"><a href="#cb11-822" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;div style="text-align: center; margin-bottom: 20px;"&gt;</span></span>
<span id="cb11-823"><a href="#cb11-823" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;img src="img/choose.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;"&gt;</span></span>
<span id="cb11-824"><a href="#cb11-824" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-825"><a href="#cb11-825" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Picture Name --&gt;</span></span>
<span id="cb11-826"><a href="#cb11-826" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: left; margin-top: 10px;"&gt;</span></span>
<span id="cb11-827"><a href="#cb11-827" aria-hidden="true" tabindex="-1"></a><span class="in">    Hình 4: Tips chọn hàm activation cho hidden layer </span></span>
<span id="cb11-828"><a href="#cb11-828" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb11-829"><a href="#cb11-829" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb11-830"><a href="#cb11-830" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Source Link --&gt;</span></span>
<span id="cb11-831"><a href="#cb11-831" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: right; font-style: italic; margin-top: 5px;"&gt;</span></span>
<span id="cb11-832"><a href="#cb11-832" aria-hidden="true" tabindex="-1"></a><span class="in">    Source: &lt;a href="https://machinelearningmastery.com/choose-an-activation-function-for-deep-learning/" target="_blank"&gt;Link to Image&lt;/a&gt;</span></span>
<span id="cb11-833"><a href="#cb11-833" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb11-834"><a href="#cb11-834" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/div&gt;</span></span>
<span id="cb11-835"><a href="#cb11-835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-836"><a href="#cb11-836" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>*Activation for Output Layers*:</span>
<span id="cb11-837"><a href="#cb11-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-838"><a href="#cb11-838" aria-hidden="true" tabindex="-1"></a>Đối với *output layer*, bạn sẽ lựa chọn hàm dựa trên *class* của output mà bạn đang hướng đến. Các hàm thông thường sẽ gồm:</span>
<span id="cb11-839"><a href="#cb11-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-840"><a href="#cb11-840" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Linear**: hay còn gọi là “identity” (nhân với 1.0) hoặc “no activation” bởi vì hàm *linear* tuyến tính không thay đổi *weighted sum* của input theo bất kỳ cách nào và thay vào đó trả về giá trị trực tiếp. Hàm này thường dùng cho output dạng liên tục.</span>
<span id="cb11-841"><a href="#cb11-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-842"><a href="#cb11-842" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Logistic (Sigmoid)**: áp dụng cho output dạng <span class="sc">\[</span>0,1<span class="sc">\]</span> hay còn gọi là *binary classification* (ví dụ mô hình nhằm đưa ra quyết định có/không trong việc đầu tư vào cổ phiểu này chẳng hạn).</span>
<span id="cb11-843"><a href="#cb11-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-844"><a href="#cb11-844" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Softmax**: Hàm này sẽ chuyển đổi một vector thành các giá trị xác suất có tổng bằng 1 (Nó giống như tìm hàm mật độ (PDF) cho một biến). Ứng dụng để dán nhãn cho *multiclass* thay vì 2 class như hàm *sigmoid* bên trên. Mỗi nhãn sẽ có 1 giá trị xác suất và dựa vào đó dự đoán khả năng xảy ra của từng class.</span>
<span id="cb11-845"><a href="#cb11-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-846"><a href="#cb11-846" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Number of neurons:</span></span>
<span id="cb11-847"><a href="#cb11-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-848"><a href="#cb11-848" aria-hidden="true" tabindex="-1"></a>Số lượng nơ-ron trong một lớp quyết định lượng thông tin mà mạng có thể lưu trữ. Nhiều nơ-ron giúp mạng học được các mẫu phức tạp hơn, nhưng cũng làm tăng nguy cơ overfitting (quá khớp) và yêu cầu nhiều tài nguyên tính toán hơn. Bạn có thể bắt đầu với một số lượng nơ-ron tương đối nhỏ, như 128 hoặc 256...</span>
<span id="cb11-849"><a href="#cb11-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-850"><a href="#cb11-850" aria-hidden="true" tabindex="-1"></a><span class="fu">## Kết luận:</span></span>
<span id="cb11-851"><a href="#cb11-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-852"><a href="#cb11-852" aria-hidden="true" tabindex="-1"></a>Như vậy, chúng ta đã được học về mô hình *RNN* và *LSTM* và cách xây dựng chúng trong R. Tiếp theo, ta sẽ học tiếp về mô hình *Transformer*</span>
<span id="cb11-853"><a href="#cb11-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-854"><a href="#cb11-854" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb11-855"><a href="#cb11-855" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;!DOCTYPE html&gt;</span></span>
<span id="cb11-856"><a href="#cb11-856" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;html lang="en"&gt;</span></span>
<span id="cb11-857"><a href="#cb11-857" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;head&gt;</span></span>
<span id="cb11-858"><a href="#cb11-858" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;meta charset="UTF-8"&gt;</span></span>
<span id="cb11-859"><a href="#cb11-859" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></span>
<span id="cb11-860"><a href="#cb11-860" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;title&gt;Go to Next Page&lt;/title&gt;</span></span>
<span id="cb11-861"><a href="#cb11-861" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;style&gt;</span></span>
<span id="cb11-862"><a href="#cb11-862" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Global Styles */</span></span>
<span id="cb11-863"><a href="#cb11-863" aria-hidden="true" tabindex="-1"></a><span class="in">        body {</span></span>
<span id="cb11-864"><a href="#cb11-864" aria-hidden="true" tabindex="-1"></a><span class="in">            font-family: 'Tahoma', sans-serif;</span></span>
<span id="cb11-865"><a href="#cb11-865" aria-hidden="true" tabindex="-1"></a><span class="in">            display: flex;</span></span>
<span id="cb11-866"><a href="#cb11-866" aria-hidden="true" tabindex="-1"></a><span class="in">            flex-direction: column;  /* Stack content and footnote vertically */</span></span>
<span id="cb11-867"><a href="#cb11-867" aria-hidden="true" tabindex="-1"></a><span class="in">            justify-content: center;  /* Center content vertically */</span></span>
<span id="cb11-868"><a href="#cb11-868" aria-hidden="true" tabindex="-1"></a><span class="in">            align-items: center;      /* Center content horizontally */</span></span>
<span id="cb11-869"><a href="#cb11-869" aria-hidden="true" tabindex="-1"></a><span class="in">            margin: 0;</span></span>
<span id="cb11-870"><a href="#cb11-870" aria-hidden="true" tabindex="-1"></a><span class="in">            background-color: $secondary-color;</span></span>
<span id="cb11-871"><a href="#cb11-871" aria-hidden="true" tabindex="-1"></a><span class="in">            box-sizing: border-box;</span></span>
<span id="cb11-872"><a href="#cb11-872" aria-hidden="true" tabindex="-1"></a><span class="in">            min-height: 80vh; /* Adjusted to 80vh to ensure it's not too high */</span></span>
<span id="cb11-873"><a href="#cb11-873" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb11-874"><a href="#cb11-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-875"><a href="#cb11-875" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Container Styling (Main Content) */</span></span>
<span id="cb11-876"><a href="#cb11-876" aria-hidden="true" tabindex="-1"></a><span class="in">        .container {</span></span>
<span id="cb11-877"><a href="#cb11-877" aria-hidden="true" tabindex="-1"></a><span class="in">            text-align: center;</span></span>
<span id="cb11-878"><a href="#cb11-878" aria-hidden="true" tabindex="-1"></a><span class="in">            padding: 20px 40px; /* Adjust padding for more compactness */</span></span>
<span id="cb11-879"><a href="#cb11-879" aria-hidden="true" tabindex="-1"></a><span class="in">            background-color: white;</span></span>
<span id="cb11-880"><a href="#cb11-880" aria-hidden="true" tabindex="-1"></a><span class="in">            border-radius: 12px;</span></span>
<span id="cb11-881"><a href="#cb11-881" aria-hidden="true" tabindex="-1"></a><span class="in">            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);</span></span>
<span id="cb11-882"><a href="#cb11-882" aria-hidden="true" tabindex="-1"></a><span class="in">            width: auto;  /* Auto width to fit content */</span></span>
<span id="cb11-883"><a href="#cb11-883" aria-hidden="true" tabindex="-1"></a><span class="in">            max-width: 380px;  /* Adjusted max-width for a smaller container */</span></span>
<span id="cb11-884"><a href="#cb11-884" aria-hidden="true" tabindex="-1"></a><span class="in">            box-sizing: border-box;</span></span>
<span id="cb11-885"><a href="#cb11-885" aria-hidden="true" tabindex="-1"></a><span class="in">            display: flex;</span></span>
<span id="cb11-886"><a href="#cb11-886" aria-hidden="true" tabindex="-1"></a><span class="in">            justify-content: center;</span></span>
<span id="cb11-887"><a href="#cb11-887" aria-hidden="true" tabindex="-1"></a><span class="in">            align-items: center;</span></span>
<span id="cb11-888"><a href="#cb11-888" aria-hidden="true" tabindex="-1"></a><span class="in">            flex-direction: column;</span></span>
<span id="cb11-889"><a href="#cb11-889" aria-hidden="true" tabindex="-1"></a><span class="in">            margin-top: 20px;  /* Space from the top of the page */</span></span>
<span id="cb11-890"><a href="#cb11-890" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb11-891"><a href="#cb11-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-892"><a href="#cb11-892" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Link Styling */</span></span>
<span id="cb11-893"><a href="#cb11-893" aria-hidden="true" tabindex="-1"></a><span class="in">        .link {</span></span>
<span id="cb11-894"><a href="#cb11-894" aria-hidden="true" tabindex="-1"></a><span class="in">            font-size: 20px;  /* Adjusted font size for readability */</span></span>
<span id="cb11-895"><a href="#cb11-895" aria-hidden="true" tabindex="-1"></a><span class="in">            color: #007bff;</span></span>
<span id="cb11-896"><a href="#cb11-896" aria-hidden="true" tabindex="-1"></a><span class="in">            text-decoration: none;</span></span>
<span id="cb11-897"><a href="#cb11-897" aria-hidden="true" tabindex="-1"></a><span class="in">            font-weight: 700;</span></span>
<span id="cb11-898"><a href="#cb11-898" aria-hidden="true" tabindex="-1"></a><span class="in">            display: inline-flex;</span></span>
<span id="cb11-899"><a href="#cb11-899" aria-hidden="true" tabindex="-1"></a><span class="in">            align-items: center;</span></span>
<span id="cb11-900"><a href="#cb11-900" aria-hidden="true" tabindex="-1"></a><span class="in">            cursor: pointer;</span></span>
<span id="cb11-901"><a href="#cb11-901" aria-hidden="true" tabindex="-1"></a><span class="in">            padding: 12px 30px;</span></span>
<span id="cb11-902"><a href="#cb11-902" aria-hidden="true" tabindex="-1"></a><span class="in">            border-radius: 6px;</span></span>
<span id="cb11-903"><a href="#cb11-903" aria-hidden="true" tabindex="-1"></a><span class="in">            transition: all 0.3s ease;</span></span>
<span id="cb11-904"><a href="#cb11-904" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb11-905"><a href="#cb11-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-906"><a href="#cb11-906" aria-hidden="true" tabindex="-1"></a><span class="in">        .link:hover {</span></span>
<span id="cb11-907"><a href="#cb11-907" aria-hidden="true" tabindex="-1"></a><span class="in">            color: #0056b3;</span></span>
<span id="cb11-908"><a href="#cb11-908" aria-hidden="true" tabindex="-1"></a><span class="in">            text-decoration: none;</span></span>
<span id="cb11-909"><a href="#cb11-909" aria-hidden="true" tabindex="-1"></a><span class="in">            background-color: #e6f0ff;</span></span>
<span id="cb11-910"><a href="#cb11-910" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb11-911"><a href="#cb11-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-912"><a href="#cb11-912" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Arrow Styling */</span></span>
<span id="cb11-913"><a href="#cb11-913" aria-hidden="true" tabindex="-1"></a><span class="in">        .arrow {</span></span>
<span id="cb11-914"><a href="#cb11-914" aria-hidden="true" tabindex="-1"></a><span class="in">            margin-left: 12px;</span></span>
<span id="cb11-915"><a href="#cb11-915" aria-hidden="true" tabindex="-1"></a><span class="in">            font-size: 24px;</span></span>
<span id="cb11-916"><a href="#cb11-916" aria-hidden="true" tabindex="-1"></a><span class="in">            transition: transform 0.3s ease, font-size 0.3s ease;</span></span>
<span id="cb11-917"><a href="#cb11-917" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb11-918"><a href="#cb11-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-919"><a href="#cb11-919" aria-hidden="true" tabindex="-1"></a><span class="in">        .link:hover .arrow {</span></span>
<span id="cb11-920"><a href="#cb11-920" aria-hidden="true" tabindex="-1"></a><span class="in">            transform: translateX(8px);</span></span>
<span id="cb11-921"><a href="#cb11-921" aria-hidden="true" tabindex="-1"></a><span class="in">            font-size: 26px;</span></span>
<span id="cb11-922"><a href="#cb11-922" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb11-923"><a href="#cb11-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-924"><a href="#cb11-924" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Focus State for Accessibility */</span></span>
<span id="cb11-925"><a href="#cb11-925" aria-hidden="true" tabindex="-1"></a><span class="in">        .link:focus {</span></span>
<span id="cb11-926"><a href="#cb11-926" aria-hidden="true" tabindex="-1"></a><span class="in">            outline: 2px solid #0056b3;</span></span>
<span id="cb11-927"><a href="#cb11-927" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb11-928"><a href="#cb11-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-929"><a href="#cb11-929" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Footer Styling (Footnote) */</span></span>
<span id="cb11-930"><a href="#cb11-930" aria-hidden="true" tabindex="-1"></a><span class="in">        .footer {</span></span>
<span id="cb11-931"><a href="#cb11-931" aria-hidden="true" tabindex="-1"></a><span class="in">            font-size: 14px;</span></span>
<span id="cb11-932"><a href="#cb11-932" aria-hidden="true" tabindex="-1"></a><span class="in">            color: #777;</span></span>
<span id="cb11-933"><a href="#cb11-933" aria-hidden="true" tabindex="-1"></a><span class="in">            margin-top: 20px;  /* Space between content and footnote */</span></span>
<span id="cb11-934"><a href="#cb11-934" aria-hidden="true" tabindex="-1"></a><span class="in">            text-align: center;</span></span>
<span id="cb11-935"><a href="#cb11-935" aria-hidden="true" tabindex="-1"></a><span class="in">            width: 100%;</span></span>
<span id="cb11-936"><a href="#cb11-936" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb11-937"><a href="#cb11-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-938"><a href="#cb11-938" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Mobile-Friendly Adjustments */</span></span>
<span id="cb11-939"><a href="#cb11-939" aria-hidden="true" tabindex="-1"></a><span class="in">        @media (max-width: 600px) {</span></span>
<span id="cb11-940"><a href="#cb11-940" aria-hidden="true" tabindex="-1"></a><span class="in">            .link {</span></span>
<span id="cb11-941"><a href="#cb11-941" aria-hidden="true" tabindex="-1"></a><span class="in">                font-size: 18px;</span></span>
<span id="cb11-942"><a href="#cb11-942" aria-hidden="true" tabindex="-1"></a><span class="in">                padding: 8px 15px;  /* Smaller padding for mobile devices */</span></span>
<span id="cb11-943"><a href="#cb11-943" aria-hidden="true" tabindex="-1"></a><span class="in">            }</span></span>
<span id="cb11-944"><a href="#cb11-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-945"><a href="#cb11-945" aria-hidden="true" tabindex="-1"></a><span class="in">            .arrow {</span></span>
<span id="cb11-946"><a href="#cb11-946" aria-hidden="true" tabindex="-1"></a><span class="in">                font-size: 18px;</span></span>
<span id="cb11-947"><a href="#cb11-947" aria-hidden="true" tabindex="-1"></a><span class="in">                margin-left: 8px;</span></span>
<span id="cb11-948"><a href="#cb11-948" aria-hidden="true" tabindex="-1"></a><span class="in">            }</span></span>
<span id="cb11-949"><a href="#cb11-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-950"><a href="#cb11-950" aria-hidden="true" tabindex="-1"></a><span class="in">            .container {</span></span>
<span id="cb11-951"><a href="#cb11-951" aria-hidden="true" tabindex="-1"></a><span class="in">                padding: 15px 30px;  /* Smaller padding on mobile */</span></span>
<span id="cb11-952"><a href="#cb11-952" aria-hidden="true" tabindex="-1"></a><span class="in">                max-width: 90%;  /* Ensure container fits better on small screens */</span></span>
<span id="cb11-953"><a href="#cb11-953" aria-hidden="true" tabindex="-1"></a><span class="in">            }</span></span>
<span id="cb11-954"><a href="#cb11-954" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb11-955"><a href="#cb11-955" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;/style&gt;</span></span>
<span id="cb11-956"><a href="#cb11-956" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/head&gt;</span></span>
<span id="cb11-957"><a href="#cb11-957" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;body&gt;</span></span>
<span id="cb11-958"><a href="#cb11-958" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;div class="container"&gt;</span></span>
<span id="cb11-959"><a href="#cb11-959" aria-hidden="true" tabindex="-1"></a><span class="in">        &lt;a href="https://loccx78vn.github.io/RNN_model/transfer.html" class="link" tabindex="0"&gt;</span></span>
<span id="cb11-960"><a href="#cb11-960" aria-hidden="true" tabindex="-1"></a><span class="in">            Go to Next Page</span></span>
<span id="cb11-961"><a href="#cb11-961" aria-hidden="true" tabindex="-1"></a><span class="in">            &lt;span class="arrow"&gt;➔&lt;/span&gt;</span></span>
<span id="cb11-962"><a href="#cb11-962" aria-hidden="true" tabindex="-1"></a><span class="in">        &lt;/a&gt;</span></span>
<span id="cb11-963"><a href="#cb11-963" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;/div&gt;</span></span>
<span id="cb11-964"><a href="#cb11-964" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/body&gt;</span></span>
<span id="cb11-965"><a href="#cb11-965" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/html&gt;</span></span>
<span id="cb11-966"><a href="#cb11-966" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024, Loc cao</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>